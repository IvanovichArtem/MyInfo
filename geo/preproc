{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "40eeb085",
   "metadata": {},
   "source": [
    "1. дополнить дата сет сделками августа\n",
    "2. привязать курс доллара ко всем датам сделок\n",
    "3. при наличии пустых ячеек со стоимостью рассчитать стоимость каждого объекта во всех валютах (Есть небольшое кол-во сделок, где не указана «цена в долларах США». Надо провести следующие действия, если есть стоимость в белорусских рублях, то ее необходимо по курсу на дату сделки перевести в доллары. Курсы валют ранее направляла) Где нет стоимости есть информация в поле \"Описание цены\", можно оттуда взять стоимость.\n",
    "4. Выделить дата сет (грязный) со следующим признакам:\n",
    "\n",
    "- столбец AU (маркеры) - доля;\n",
    "- столбец AC (переходящая доля), все доли за исключением 1/1; 1/1, 1/1; 1/1, 1/1,1/1 и пустых ячеек.\n",
    "- столбец R (Количество объектов в сделке) более 1, то есть начиная с 2,3,4.....и т.д.\n",
    "- столбец AU (маркеры) - комплекс\n",
    "- столбец U (описание цены включает слова \"долей, доля,доли и т.д.\")\n",
    "- столбец U (описание цены включает слова \"Цена указана за ......... объектов\")\n",
    "\n",
    "5.  В грязном датасете распределить доли:\n",
    "    Правило:\n",
    "    столбец D (Инвентарный номер) должны совпадать, столбец АС (Переходящая доля) не равна 1/1; 1/1, 1/1; 1/1, 1/1, 1/1 и не пустая, то применяются следующие правила.\n",
    "\n",
    "    5.1 Стоимость не приводится к доле 1, если в описании цены написано \"стоимость за весь объект, за все помещение, здание и т.д.\"\n",
    "    Например,столбец АС Переходящая доля 3/4, 1/4, 3/4, 1/4, столбец D (Инвентарный номер) совпадает и в описании цены указано общая стоимость, значит стоимость не подлежит распределению.\n",
    "    Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например, 1.\n",
    "\n",
    "    5.2 Стоимость приводится к 1, если в описании цены указано стоимость X/X доли.\n",
    "    Например, столбец АС Переходящая доля 3/5, 3/5, столбец D (Инвентарный номер) совпадает и в столбец U (Описание цены) указано \"стоимость X/X долей........\" проводим увеличение стоимости до полной доли.\n",
    "    Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,2.\n",
    "\n",
    "    5.3 Стоимость долей объединяется, если описание цены пустое, столбец D (Инвентарный номер) совпадает, столбец S (Цена в бел. руб.) разные, Переходящая доля равна в сумме 1. После объединения стоимости в бел руб, стоимость необходимо перевести в 3 валюты.\n",
    "    Например, столбец АС Переходящая доля 1/4, 3/4, столбец D (Инвентарный номер) 500/D-7110374.\n",
    "    Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,3.\n",
    "\n",
    "    5.4 Стоимость долей не приводится, если столбец D (Инвентарный номер) совпадает, в столбец U (Описание цены) ничего не написано, столбец S (Цена в бел. руб.) одинаковые.\n",
    "    Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,4.\n",
    "\n",
    "    Эти правила должны закрыть большую часть.\n",
    "    После разбора по этим правилам, то что останется я изучу и смогу сказать есть ли еще правила.\n",
    "\n",
    "6.  В грязном датасете распределить стоимость комплексов (AU (маркеры) - комплекс), столбец АС (Переходящая доля) равна 1/1; 1/1, 1/1; 1/1, 1/1, 1/1 и пустая.\n",
    "    Удаляем строки с полным совпадением.\n",
    "\n",
    "    6.1. Столбец Q Идентификатор сделки совпадает, столбец S (Цена в бел. руб.) одинаковый, в столбец U (Описание цены) написано, что это стоимость общая за все объекты или стоимость и перечислены капитальные строения и т.д., то проводится распределение стоимости пропорционально площади объектов в сделке.\n",
    "    Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,5.\n",
    "\n",
    "    6.2. Столбец Q Идентификатор сделки совпадает, столбец S (Цена в бел. руб.) стоимость разная и в столбце столбец U (Описание цены) ничего не указано, стоимость не распределяется.\n",
    "    Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,6.\n",
    "\n",
    "Чистый дата сет столбец AU (Цена содержит НДС, с НДС), необходимо уменьшить стоимость на 20%.\n",
    "Чистый дата сет столбец U (Описание цены) если написано, что включен НДС, то его надо исключить из стоимости. (например, с НДС, в т.ч. НДС, в том числе с НДС и пр.)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e3f66924-dce8-4952-8061-462cdd495982",
   "metadata": {},
   "source": [
    "# Imports\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "d343b6c0-a362-4b56-9d75-e4cbc362d046",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import os\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import regex as re\n",
    "\n",
    "pd.set_option(\"display.max_columns\", None)\n",
    "pd.set_option(\"display.max_rows\", 100)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ebce4aec",
   "metadata": {},
   "source": [
    "# Utils\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "7ae2658c",
   "metadata": {},
   "outputs": [],
   "source": [
    "def parse_excel_df_2(\n",
    "    path,\n",
    "    sheet_name,\n",
    "    usecols=None,\n",
    "    skiprows=None,\n",
    "    additional_parse=False,\n",
    "    can_be_empty=False,\n",
    "):\n",
    "\n",
    "    df = pd.read_excel(\n",
    "        path, sheet_name=sheet_name, usecols=usecols, skiprows=skiprows\n",
    "    )\n",
    "\n",
    "    break_row = None\n",
    "    for i in range(10, len(df)):\n",
    "        if pd.isna(df.iloc[i, 0]) and pd.notna(df.iloc[i + 1, 0]):\n",
    "            break_row = i\n",
    "            break\n",
    "    if break_row is None or break_row + 1 >= len(df):\n",
    "        if can_be_empty is False:\n",
    "            raise ValueError(\"Table not found\")\n",
    "        else:\n",
    "            print(f\"Таблица для sheet={sheet_name} по пути {path} пустая\")\n",
    "\n",
    "    if additional_parse:\n",
    "        search_cond = \"not def\"\n",
    "        for i in range(0, 20):\n",
    "            full_str = df.iloc[i, 0]\n",
    "            if isinstance(full_str, str) and (\"Назначение: \" in full_str):\n",
    "                search_cond = full_str.partition(\"Назначение: \")[2]\n",
    "\n",
    "    # Заголовки — строка после пустой\n",
    "    # костыль для новых данных\n",
    "    if sheet_name in [\"Стоимость КС_РХ\", \"Выгрузка по ЗУ\"]:\n",
    "        header_row = 4\n",
    "        # print(df.iloc[header_row].values)\n",
    "    else:\n",
    "        header_row = break_row + 1\n",
    "\n",
    "    headers = df.iloc[header_row].values\n",
    "\n",
    "    # # Данные — начиная со следующей строки\n",
    "    table_data = df.iloc[header_row + 1 :].copy()\n",
    "    table_data.columns = headers\n",
    "    table_data.reset_index(drop=True, inplace=True)\n",
    "\n",
    "    # Костыль\n",
    "    if sheet_name == \"РБ азартные\":\n",
    "        table_data = table_data.iloc[:-1, pd.notna(table_data.columns)]\n",
    "\n",
    "    if additional_parse:\n",
    "        return table_data, search_cond\n",
    "    else:\n",
    "        return table_data\n",
    "\n",
    "\n",
    "def collect_all_df(path, sheet_name=None):\n",
    "\n",
    "    excel_file = pd.ExcelFile(path)\n",
    "    sheet_names = excel_file.sheet_names if sheet_name is None else [sheet_name]\n",
    "    print(f\"Number of sheets: {len(sheet_names)}\\n\", sheet_names)\n",
    "\n",
    "    all_df = []\n",
    "\n",
    "    for sheet in sheet_names:\n",
    "        df, search_param = parse_excel_df_2(path, sheet, additional_parse=True)\n",
    "        df.rename(\n",
    "            columns={\n",
    "                \"Площадь, кв.м\": \"Общая площадь, кв.м\",\n",
    "                \"Площадь КС\": \"Общая площадь КС, кв.м\",\n",
    "                \"Этажность КС\": \"Количество надземных этажей, шт.\",\n",
    "                \"Подземная этажность КС\": \"Количество подземных этажей, шт.\",\n",
    "                \"Доп. Объекты\": \"Составные элементы и принадлежности\",\n",
    "            },\n",
    "            inplace=True,\n",
    "        )\n",
    "        if \"objectnumber\" in df.columns:\n",
    "            df.drop(columns=[\"objectnumber\"], inplace=True)\n",
    "        df[\"sheet_source\"] = sheet\n",
    "        df[\"search_param\"] = search_param\n",
    "        all_df.append(df)\n",
    "    all_df = pd.concat(all_df)\n",
    "    print(f\"df output shape: {all_df.shape}\")\n",
    "    print(f\"Num of undefined columns: {sum(pd.isna(all_df.columns))}\")\n",
    "    return all_df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0fa0786b",
   "metadata": {},
   "source": [
    "# Working\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c579d52d",
   "metadata": {},
   "source": [
    "## Загружаем датасет\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "f8ba9549-6471-47de-acce-e23fc0fcfbed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(50232, 69)"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df = pd.read_excel(\"./data/total_df.xlsx\").drop(\n",
    "    columns=[\"Unnamed: 0\", \"п/п\"]\n",
    ")\n",
    "total_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "a705e0f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                                                      NaN\n",
       "1                                                      NaN\n",
       "2                                                      NaN\n",
       "3                                                      NaN\n",
       "4                                                      NaN\n",
       "                               ...                        \n",
       "50227    Комплекс; Нет валюты; Нет мат. стен; Нет площа...\n",
       "50228    Комплекс; Нет валюты; Нет мат. стен; Нет площа...\n",
       "50229                                             Комплекс\n",
       "50230                                             Комплекс\n",
       "50231                                 Продавец Государство\n",
       "Name: Маркеры, Length: 50232, dtype: object"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[\"Маркеры\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "e6c03708-5395-4499-ad6a-560d1a31b98c",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Тип недвижимого имущества', 'Инвентарный номер', 'Адрес', 'Назначение',\n",
       "       'Описание назначения', 'Наименование', 'Общая площадь, кв.м',\n",
       "       'Жилая площадь, кв.м', 'Материал стен', 'Дата ввода',\n",
       "       'Дата консервации',\n",
       "       'Дата реконструкции (реставрации, капитального ремонта)', 'Дата сделки',\n",
       "       'Дата регистрации договора', 'Идентификатор сделки',\n",
       "       'Количество объектов в сделке', 'Цена в бел. руб.',\n",
       "       'Цена в бел. руб. за кв.м', 'Описание цены', 'Цена в долларах США',\n",
       "       'Цена в долларах США за кв.м', 'Цена в евро', 'Цена в евро за кв.м',\n",
       "       'Тип цены', 'Цена по договору', 'Валюта по договору',\n",
       "       'Переходящая доля', 'Количество комнат ИП', 'Этаж расположения ИП',\n",
       "       'Инвентарный номер КС', 'Общая площадь КС, кв.м',\n",
       "       'Жилая площадь КС, кв.м', 'Назначение КС', 'Описание назначения КС',\n",
       "       'Наименование КС', 'Процент готовности КС',\n",
       "       'Количество надземных этажей, шт.', 'Количество подземных этажей, шт.',\n",
       "       'Составные элементы и принадлежности', 'Кадастровый номер ЗУ',\n",
       "       'Назначение ЗУ', 'Описание назначения ЗУ', 'Площадь ЗУ, кв.м',\n",
       "       'Уникальный номер АТЕ', 'Маркеры',\n",
       "       'Дата проведения обследования КС / РХ', 'Объем КС, куб.м / РХ',\n",
       "       'Общая площадь жилых помещений КС, кв.м / РХ',\n",
       "       'Общая площадь нежилых помещений КС, кв.м / РХ',\n",
       "       'Количество изолированных помещений (квартир) КС / РХ',\n",
       "       'Физический износ на дату обследования КС, % / РХ',\n",
       "       'Наличие холодного водоснабжения КС / РХ',\n",
       "       'Наличие горячего водоснабжения КС / РХ', 'Наличие канализации КС / РХ',\n",
       "       'Наличие отопления КС / РХ', 'Наличие газоснабжения КС / РХ',\n",
       "       'Наличие электроснабжения КС / РХ', 'Наличие ванн (душей) КС / РХ',\n",
       "       'Наличие напольных электроплит КС / РХ',\n",
       "       'Материал  крыши (кровли) КС / РХ', 'Материал фундамента КС / РХ',\n",
       "       'Материал перекрытий КС / РХ', 'Стоимости КС / РХ', 'sheet_source',\n",
       "       'search_param', 'Распределение долей до сделки',\n",
       "       'Распределение долей после сделки', 'Исходная цена', 'Исходная валюта'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "8352287e-0458-4215-a9fd-9354dc09f368",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Тип недвижимого имущества                                 0.000000\n",
       "Инвентарный номер                                         0.000000\n",
       "Адрес                                                     0.000000\n",
       "Назначение                                                0.000000\n",
       "Описание назначения                                       0.077580\n",
       "Наименование                                              0.000338\n",
       "Общая площадь, кв.м                                       0.009058\n",
       "Жилая площадь, кв.м                                       0.959229\n",
       "Материал стен                                             0.036272\n",
       "Дата ввода                                                0.156195\n",
       "Дата консервации                                          0.993849\n",
       "Дата реконструкции (реставрации, капитального ремонта)    0.977166\n",
       "Дата сделки                                               0.000000\n",
       "Дата регистрации договора                                 0.331283\n",
       "Идентификатор сделки                                      0.000000\n",
       "Количество объектов в сделке                              0.000000\n",
       "Цена в бел. руб.                                          0.005932\n",
       "Цена в бел. руб. за кв.м                                  0.048575\n",
       "Описание цены                                             0.598384\n",
       "Цена в долларах США                                       0.006132\n",
       "Цена в долларах США за кв.м                               0.048774\n",
       "Цена в евро                                               0.006132\n",
       "Цена в евро за кв.м                                       0.048774\n",
       "Тип цены                                                  0.331283\n",
       "Цена по договору                                          0.030001\n",
       "Валюта по договору                                        0.034719\n",
       "Переходящая доля                                          0.331283\n",
       "Количество комнат ИП                                      0.967750\n",
       "Этаж расположения ИП                                      0.593845\n",
       "Инвентарный номер КС                                      0.000756\n",
       "Общая площадь КС, кв.м                                    0.009834\n",
       "Жилая площадь КС, кв.м                                    1.000000\n",
       "Назначение КС                                             0.010670\n",
       "Описание назначения КС                                    0.066352\n",
       "Наименование КС                                           0.011845\n",
       "Процент готовности КС                                     0.664895\n",
       "Количество надземных этажей, шт.                          0.104077\n",
       "Количество подземных этажей, шт.                          0.784122\n",
       "Составные элементы и принадлежности                       0.396560\n",
       "Кадастровый номер ЗУ                                      0.002031\n",
       "Назначение ЗУ                                             0.024108\n",
       "Описание назначения ЗУ                                    0.356147\n",
       "Площадь ЗУ, кв.м                                          0.007983\n",
       "Уникальный номер АТЕ                                      0.030399\n",
       "Маркеры                                                   0.275621\n",
       "Дата проведения обследования КС / РХ                      0.871337\n",
       "Объем КС, куб.м / РХ                                      0.871576\n",
       "Общая площадь жилых помещений КС, кв.м / РХ               0.873487\n",
       "Общая площадь нежилых помещений КС, кв.м / РХ             0.910794\n",
       "Количество изолированных помещений (квартир) КС / РХ      0.918339\n",
       "Физический износ на дату обследования КС, % / РХ          0.867913\n",
       "Наличие холодного водоснабжения КС / РХ                   0.873806\n",
       "Наличие горячего водоснабжения КС / РХ                    0.878006\n",
       "Наличие канализации КС / РХ                               0.874741\n",
       "Наличие отопления КС / РХ                                 0.873786\n",
       "Наличие газоснабжения КС / РХ                             0.880017\n",
       "Наличие электроснабжения КС / РХ                          0.870123\n",
       "Наличие ванн (душей) КС / РХ                              0.883182\n",
       "Наличие напольных электроплит КС / РХ                     0.888955\n",
       "Материал  крыши (кровли) КС / РХ                          0.869326\n",
       "Материал фундамента КС / РХ                               0.868849\n",
       "Материал перекрытий КС / РХ                               0.873149\n",
       "Стоимости КС / РХ                                         0.971373\n",
       "sheet_source                                              0.000000\n",
       "search_param                                              0.000000\n",
       "Распределение долей до сделки                             0.668717\n",
       "Распределение долей после сделки                          0.668717\n",
       "Исходная цена                                             0.970497\n",
       "Исходная валюта                                           0.971094\n",
       "dtype: float64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df.isna().mean()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0978bbd0",
   "metadata": {},
   "source": [
    "## 1. Дополняем датасет сделками августа\n",
    "\n",
    "В файлах есть 3 листа:\n",
    "\n",
    "- `Выгрузка по КСиИП` - основной лист, оттуда будем загружать все (_header_ таблицы на 27ой строке)\n",
    "- `Стоимость КС_РХ` - лист, где по **Инвентарный номер** и **Дата сделки**\n",
    "  заберем инфу по фиче **Стоимость КС_РХ**, остальные фичи с этого листа уже присутствуют в `Выгрузка по КСиИП` (_header_ таблицы на 5ой строке)\n",
    "- `Выгрузка по ЗУ` - вся инфа с этого листа уже присутствует в `Выгрузка по КСиИП` и в основном листы пустые (_header_ таблицы на 5ой строке)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "1d32abc1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['./data/Выгрузка/Выгрузка (1).xlsx',\n",
       " './data/Выгрузка/Выгрузка (2).xlsx',\n",
       " './data/Выгрузка/Выгрузка (3).xlsx',\n",
       " './data/Выгрузка/Выгрузка (4).xlsx',\n",
       " './data/Выгрузка/Выгрузка (5).xlsx',\n",
       " './data/Выгрузка/Выгрузка (6).xlsx',\n",
       " './data/Выгрузка/Выгрузка (7).xlsx',\n",
       " './data/Выгрузка/Выгрузка.xlsx']"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "path_to_aug_data = \"./data/Выгрузка/\"\n",
    "new_aug_files = [\n",
    "    f\"{path_to_aug_data}{file}\" for file in os.listdir(path_to_aug_data)\n",
    "]\n",
    "new_aug_files"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d6b6c541",
   "metadata": {},
   "source": [
    "В файлах выгрузки могут быть пустые таблицы\n",
    "Лист **Выгрузка по КСиИП** основной\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "a2b7b143",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <th>Адрес</th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Описание назначения</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <th>Материал стен</th>\n",
       "      <th>Дата ввода</th>\n",
       "      <th>Дата консервации</th>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <th>Тип цены</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Валюта по договору</th>\n",
       "      <th>Переходящая доля</th>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <th>Назначение КС</th>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <th>Наименование КС</th>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <th>Маркеры</th>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>search_param</th>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <th>Исходная цена</th>\n",
       "      <th>Исходная валюта</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>451/C-15944</td>\n",
       "      <td>Гродненская обл., Дятловский р-н, Дятловский с...</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Административное здание</td>\n",
       "      <td>365.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1972-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>06.04.2022</td>\n",
       "      <td>14.04.2022</td>\n",
       "      <td>57504113-комплекс</td>\n",
       "      <td>4</td>\n",
       "      <td>36927.45</td>\n",
       "      <td>100.98</td>\n",
       "      <td>цена указана в отношении капитальных строений ...</td>\n",
       "      <td>12547.98</td>\n",
       "      <td>34.31</td>\n",
       "      <td>11408.98</td>\n",
       "      <td>31.20</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>36927.45</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>451/C-15944</td>\n",
       "      <td>365.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Административное здание</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ограждение, покрытие, дымовая труба</td>\n",
       "      <td>422382308102000033</td>\n",
       "      <td>Земельный участок для размещения объектов иног...</td>\n",
       "      <td>Земельный участок для строительства и обслужив...</td>\n",
       "      <td>21793.0</td>\n",
       "      <td>13604.0</td>\n",
       "      <td>Комплекс; Продавец Государство</td>\n",
       "      <td>16.12.2020</td>\n",
       "      <td>1555.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Котел на твердом топливе,Центральное</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Асбестоцементный волнистый лист</td>\n",
       "      <td>Бутобетон</td>\n",
       "      <td>Железобетон</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>632/C-30119</td>\n",
       "      <td>Минская обл., Воложинский р-н, Раковский с/с, ...</td>\n",
       "      <td>Здание специализированное иного назначения</td>\n",
       "      <td>здание специализированное иного назначения</td>\n",
       "      <td>жилой корпус</td>\n",
       "      <td>2753.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1987-09-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>04.04.2022</td>\n",
       "      <td>06.04.2022</td>\n",
       "      <td>57392418-комплекс</td>\n",
       "      <td>5</td>\n",
       "      <td>980077.33</td>\n",
       "      <td>355.95</td>\n",
       "      <td>указана общая сумма сделки</td>\n",
       "      <td>332951.94</td>\n",
       "      <td>120.92</td>\n",
       "      <td>300351.61</td>\n",
       "      <td>109.08</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>980077.33</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>632/C-30119</td>\n",
       "      <td>2753.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное иного назначения</td>\n",
       "      <td>здание специализированное иного назначения</td>\n",
       "      <td>жилой корпус</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>подвал (литер 3А2-3/к), дорожки (литер а), огр...</td>\n",
       "      <td>622085700062000026</td>\n",
       "      <td>Земельный участок рекреационного назначения</td>\n",
       "      <td>земельный участок для содержания и обслуживани...</td>\n",
       "      <td>72787.0</td>\n",
       "      <td>18337.0</td>\n",
       "      <td>Комплекс</td>\n",
       "      <td>27.04.2021</td>\n",
       "      <td>9938.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Центральное</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Душ</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Рулонные кровельные материалы</td>\n",
       "      <td>Бетон</td>\n",
       "      <td>Железобетон</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>140</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>610/C-48064</td>\n",
       "      <td>Минская обл., Борисовский р-н, г. Борисов, ул....</td>\n",
       "      <td>Здание специализированное иного назначения</td>\n",
       "      <td>Здание вспомогательного цеха</td>\n",
       "      <td>Вспомогательный цех</td>\n",
       "      <td>1238.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1970-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27.09.2021</td>\n",
       "      <td>01.04.2022</td>\n",
       "      <td>21.04.2022</td>\n",
       "      <td>57618490-комплекс</td>\n",
       "      <td>8</td>\n",
       "      <td>2378902.10</td>\n",
       "      <td>1920.95</td>\n",
       "      <td>цена капитальных строений с инв. номерами 610/...</td>\n",
       "      <td>808270.62</td>\n",
       "      <td>652.67</td>\n",
       "      <td>725053.98</td>\n",
       "      <td>585.48</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>2378902.10</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>610/C-48064</td>\n",
       "      <td>1238.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное иного назначения</td>\n",
       "      <td>Здание вспомогательного цеха</td>\n",
       "      <td>Вспомогательный цех</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>А1/ск-Вспомогательный цех,1-Склад,а4-Подпорная...</td>\n",
       "      <td>620850100007000652</td>\n",
       "      <td>Земельный участок для размещения объектов розн...</td>\n",
       "      <td>Земельный участок для обслуживания здания вчпо...</td>\n",
       "      <td>4360.0</td>\n",
       "      <td>22666.0</td>\n",
       "      <td>Комплекс</td>\n",
       "      <td>28.06.2021</td>\n",
       "      <td>8619.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Центральное</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Душ</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Рулонные кровельные материалы на битуме</td>\n",
       "      <td>Железобетон</td>\n",
       "      <td>Плита перекрытия железобетонная монолитная</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>141</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>610/C-48064</td>\n",
       "      <td>Минская обл., Борисовский р-н, г. Борисов, ул....</td>\n",
       "      <td>Здание специализированное иного назначения</td>\n",
       "      <td>Здание вспомогательного цеха</td>\n",
       "      <td>Вспомогательный цех</td>\n",
       "      <td>1238.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1970-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27.09.2021</td>\n",
       "      <td>01.04.2022</td>\n",
       "      <td>21.04.2022</td>\n",
       "      <td>57618490-комплекс</td>\n",
       "      <td>8</td>\n",
       "      <td>2378902.10</td>\n",
       "      <td>1920.95</td>\n",
       "      <td>цена капитальных строений с инв. номерами 610/...</td>\n",
       "      <td>808270.62</td>\n",
       "      <td>652.67</td>\n",
       "      <td>725053.98</td>\n",
       "      <td>585.48</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>2378902.10</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>610/C-48064</td>\n",
       "      <td>1238.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное иного назначения</td>\n",
       "      <td>Здание вспомогательного цеха</td>\n",
       "      <td>Вспомогательный цех</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>А1/ск-Вспомогательный цех,1-Склад,а4-Подпорная...</td>\n",
       "      <td>640400000007000127</td>\n",
       "      <td>Земельный участок неустановленного назначения</td>\n",
       "      <td>Для обслуж. и эксплуат. зданий и сооруж. произ...</td>\n",
       "      <td>21107.0</td>\n",
       "      <td>22666.0</td>\n",
       "      <td>Комплекс</td>\n",
       "      <td>28.06.2021</td>\n",
       "      <td>8619.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Центральное</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Душ</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Рулонные кровельные материалы на битуме</td>\n",
       "      <td>Железобетон</td>\n",
       "      <td>Плита перекрытия железобетонная монолитная</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>179</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>151/C-12752</td>\n",
       "      <td>Брестская обл., Ганцевичский р-н, г. Ганцевичи...</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Административное здание</td>\n",
       "      <td>390.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2022-02-21 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26.03.2022</td>\n",
       "      <td>26.03.2022</td>\n",
       "      <td>57228983</td>\n",
       "      <td>1</td>\n",
       "      <td>149760.00</td>\n",
       "      <td>383.80</td>\n",
       "      <td>NaN</td>\n",
       "      <td>46870.31</td>\n",
       "      <td>120.12</td>\n",
       "      <td>42607.19</td>\n",
       "      <td>109.19</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>149760.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>151/C-12752</td>\n",
       "      <td>390.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Административное здание</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>121650100001003231</td>\n",
       "      <td>Земельный участок для размещения объектов иног...</td>\n",
       "      <td>Для строительства и обслуживания теплицы по пр...</td>\n",
       "      <td>28369.0</td>\n",
       "      <td>563.0</td>\n",
       "      <td>Первичный рынок</td>\n",
       "      <td>12.02.2019</td>\n",
       "      <td>1631.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Автономное,Котел на твердом топливе</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Умывальник (раковина)</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Рулонные кровельные материалы</td>\n",
       "      <td>Бетон</td>\n",
       "      <td>Плита железобетонная</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49963</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>311/C-50231</td>\n",
       "      <td>Гомельская обл., Ветковский р-н, Светиловичски...</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Жилой гостевой дом усадебного типа</td>\n",
       "      <td>80.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2018-08-02 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>07.08.2021</td>\n",
       "      <td>17.08.2021</td>\n",
       "      <td>39412068</td>\n",
       "      <td>1</td>\n",
       "      <td>19682.00</td>\n",
       "      <td>245.72</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7828.96</td>\n",
       "      <td>97.74</td>\n",
       "      <td>6619.14</td>\n",
       "      <td>82.64</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>19682.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>311/C-50231</td>\n",
       "      <td>80.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Жилой гостевой дом усадебного типа</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажный кирпичный жилой гостевой дом усаде...</td>\n",
       "      <td>320885202601000015</td>\n",
       "      <td>Земельный участок для размещения объектов усад...</td>\n",
       "      <td>Земельный участок для строительства и обслужив...</td>\n",
       "      <td>2652.0</td>\n",
       "      <td>9903.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.07.2018</td>\n",
       "      <td>246.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Печь</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Ондувилла</td>\n",
       "      <td>Кирпичи</td>\n",
       "      <td>Дерево</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>гостиница</td>\n",
       "      <td>Здание гостиниц, мотелей</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50043</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>614/C-23933</td>\n",
       "      <td>Республика Беларусь, Минская обл., Смолевичски...</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание КПП</td>\n",
       "      <td>40.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1990-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.04.2020</td>\n",
       "      <td>03.06.2020</td>\n",
       "      <td>15997114-комплекс</td>\n",
       "      <td>22</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Сведения о цена указаны в регистрационной книг...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>614/C-23933</td>\n",
       "      <td>40.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание КПП</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>624800000001000405</td>\n",
       "      <td>Земельный участок рекреационного назначения</td>\n",
       "      <td>Земельный участок для обслуживания зданий и со...</td>\n",
       "      <td>60528.0</td>\n",
       "      <td>21527.0</td>\n",
       "      <td>Комплекс; Нет валюты; Нет цены</td>\n",
       "      <td>04.07.2016</td>\n",
       "      <td>149.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Рулонные кровельные материалы на битуме</td>\n",
       "      <td>Бетон</td>\n",
       "      <td>Плита железобетонная</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>гостиница</td>\n",
       "      <td>Здание гостиниц, мотелей</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50049</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>614/C-23469</td>\n",
       "      <td>Республика Беларусь, Минская обл., Смолевичски...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>698.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1972-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.04.2020</td>\n",
       "      <td>03.06.2020</td>\n",
       "      <td>15997114-комплекс</td>\n",
       "      <td>22</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Сведения о цена указаны в регистрационной книг...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>614/C-23469</td>\n",
       "      <td>698.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Ограждение (лит. а1), площадки и дорожки (лит....</td>\n",
       "      <td>624800000001000405</td>\n",
       "      <td>Земельный участок рекреационного назначения</td>\n",
       "      <td>Земельный участок для обслуживания зданий и со...</td>\n",
       "      <td>60528.0</td>\n",
       "      <td>21527.0</td>\n",
       "      <td>Комплекс; Нет валюты; Нет цены</td>\n",
       "      <td>09.10.2018</td>\n",
       "      <td>4024.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Автономная система</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Автономная система</td>\n",
       "      <td>Котлы отопления</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Рулонные кровельные материалы на битуме</td>\n",
       "      <td>Блоки железобетонные</td>\n",
       "      <td>Железобетон</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>гостиница</td>\n",
       "      <td>Здание гостиниц, мотелей</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50079</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>250/C-31676</td>\n",
       "      <td>Витебская обл., Полоцкий р-н, Гомельский с/с, ...</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>домик летнего типа №5</td>\n",
       "      <td>23.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Доски</td>\n",
       "      <td>1971-08-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>06.12.2019</td>\n",
       "      <td>28.01.2020</td>\n",
       "      <td>4008784-комплекс</td>\n",
       "      <td>24</td>\n",
       "      <td>34739.59</td>\n",
       "      <td>1459.65</td>\n",
       "      <td>Цена по договору купли-продажи в отношении кап...</td>\n",
       "      <td>16406.72</td>\n",
       "      <td>689.36</td>\n",
       "      <td>14800.44</td>\n",
       "      <td>621.87</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>34739.59</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>250/C-31676</td>\n",
       "      <td>23.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>домик летнего типа №5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>нет</td>\n",
       "      <td>223800000001000310</td>\n",
       "      <td>Земельный участок рекреационного назначения</td>\n",
       "      <td>для содержания и обслуживания базы отдыха</td>\n",
       "      <td>38191.0</td>\n",
       "      <td>6722.0</td>\n",
       "      <td>Комплекс; Продавец Государство</td>\n",
       "      <td>11.10.2018</td>\n",
       "      <td>74.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>37.0</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Асбестоцементный волнистый лист</td>\n",
       "      <td>Кирпичи</td>\n",
       "      <td>Дерево</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>гостиница</td>\n",
       "      <td>Здание гостиниц, мотелей</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50202</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>100/C-46855</td>\n",
       "      <td>Брестская обл., Брестский р-н, Томашовский с/с...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>855.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1964-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>09.10.2018</td>\n",
       "      <td>30.11.2018</td>\n",
       "      <td>54602742-комплекс</td>\n",
       "      <td>25</td>\n",
       "      <td>1600.00</td>\n",
       "      <td>1.87</td>\n",
       "      <td>цена указана за капитальные строения 100/С-468...</td>\n",
       "      <td>741.43</td>\n",
       "      <td>0.87</td>\n",
       "      <td>645.21</td>\n",
       "      <td>0.75</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>1600.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>100/C-46855</td>\n",
       "      <td>855.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Погреб, колодец, умывальник, три забора, трое ...</td>\n",
       "      <td>121284307101000289</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>Содержание и обслуживание учебно-спортивной ба...</td>\n",
       "      <td>63829.0</td>\n",
       "      <td>516.0</td>\n",
       "      <td>Комплекс; Продавец Государство</td>\n",
       "      <td>18.02.2012</td>\n",
       "      <td>3354.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Локальная система</td>\n",
       "      <td>Локальная система</td>\n",
       "      <td>Локальная система</td>\n",
       "      <td>Локальное</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Есть</td>\n",
       "      <td>Рулонные кровельные материалы</td>\n",
       "      <td>Бетон</td>\n",
       "      <td>Плита железобетонная</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>гостиница</td>\n",
       "      <td>Здание гостиниц, мотелей</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1438 rows × 69 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Тип недвижимого имущества Инвентарный номер  \\\n",
       "113        Капитальное строение       451/C-15944   \n",
       "122        Капитальное строение       632/C-30119   \n",
       "140        Капитальное строение       610/C-48064   \n",
       "141        Капитальное строение       610/C-48064   \n",
       "179        Капитальное строение       151/C-12752   \n",
       "...                         ...               ...   \n",
       "49963      Капитальное строение       311/C-50231   \n",
       "50043      Капитальное строение       614/C-23933   \n",
       "50049      Капитальное строение       614/C-23469   \n",
       "50079      Капитальное строение       250/C-31676   \n",
       "50202      Капитальное строение       100/C-46855   \n",
       "\n",
       "                                                   Адрес  \\\n",
       "113    Гродненская обл., Дятловский р-н, Дятловский с...   \n",
       "122    Минская обл., Воложинский р-н, Раковский с/с, ...   \n",
       "140    Минская обл., Борисовский р-н, г. Борисов, ул....   \n",
       "141    Минская обл., Борисовский р-н, г. Борисов, ул....   \n",
       "179    Брестская обл., Ганцевичский р-н, г. Ганцевичи...   \n",
       "...                                                  ...   \n",
       "49963  Гомельская обл., Ветковский р-н, Светиловичски...   \n",
       "50043  Республика Беларусь, Минская обл., Смолевичски...   \n",
       "50049  Республика Беларусь, Минская обл., Смолевичски...   \n",
       "50079  Витебская обл., Полоцкий р-н, Гомельский с/с, ...   \n",
       "50202  Брестская обл., Брестский р-н, Томашовский с/с...   \n",
       "\n",
       "                                              Назначение  \\\n",
       "113                 Здание административно-хозяйственное   \n",
       "122           Здание специализированное иного назначения   \n",
       "140           Здание специализированное иного назначения   \n",
       "141           Здание специализированное иного назначения   \n",
       "179                 Здание административно-хозяйственное   \n",
       "...                                                  ...   \n",
       "49963                Здание гостиниц, мотелей, кемпингов   \n",
       "50043                                     Здание нежилое   \n",
       "50049  Здание специализированное для общественного пи...   \n",
       "50079                Здание гостиниц, мотелей, кемпингов   \n",
       "50202  Здание специализированное для общественного пи...   \n",
       "\n",
       "                                     Описание назначения  \\\n",
       "113                 Здание административно-хозяйственное   \n",
       "122           здание специализированное иного назначения   \n",
       "140                         Здание вспомогательного цеха   \n",
       "141                         Здание вспомогательного цеха   \n",
       "179                                                  NaN   \n",
       "...                                                  ...   \n",
       "49963                Здание гостиниц, мотелей, кемпингов   \n",
       "50043                                     Здание нежилое   \n",
       "50049  Здание специализированное для общественного пи...   \n",
       "50079                Здание гостиниц, мотелей, кемпингов   \n",
       "50202  Здание специализированное для общественного пи...   \n",
       "\n",
       "                             Наименование  Общая площадь, кв.м  \\\n",
       "113               Административное здание                365.7   \n",
       "122                          жилой корпус               2753.4   \n",
       "140                   Вспомогательный цех               1238.4   \n",
       "141                   Вспомогательный цех               1238.4   \n",
       "179               Административное здание                390.2   \n",
       "...                                   ...                  ...   \n",
       "49963  Жилой гостевой дом усадебного типа                 80.1   \n",
       "50043                          Здание КПП                 40.7   \n",
       "50049                            Столовая                698.0   \n",
       "50079               домик летнего типа №5                 23.8   \n",
       "50202                            Столовая                855.7   \n",
       "\n",
       "       Жилая площадь, кв.м Материал стен           Дата ввода  \\\n",
       "113                    NaN        Кирпич  1972-01-01 00:00:00   \n",
       "122                    NaN        Кирпич  1987-09-01 00:00:00   \n",
       "140                    NaN        Кирпич  1970-01-01 00:00:00   \n",
       "141                    NaN        Кирпич  1970-01-01 00:00:00   \n",
       "179                    NaN        Кирпич  2022-02-21 00:00:00   \n",
       "...                    ...           ...                  ...   \n",
       "49963                  NaN        Кирпич  2018-08-02 00:00:00   \n",
       "50043                  NaN        Кирпич  1990-01-01 00:00:00   \n",
       "50049                  NaN        Кирпич  1972-01-01 00:00:00   \n",
       "50079                  NaN         Доски  1971-08-01 00:00:00   \n",
       "50202                  NaN        Кирпич  1964-01-01 00:00:00   \n",
       "\n",
       "      Дата консервации Дата реконструкции (реставрации, капитального ремонта)  \\\n",
       "113                NaN                                                NaN       \n",
       "122                NaN                                                NaN       \n",
       "140                NaN                                         27.09.2021       \n",
       "141                NaN                                         27.09.2021       \n",
       "179                NaN                                                NaN       \n",
       "...                ...                                                ...       \n",
       "49963              NaN                                                NaN       \n",
       "50043              NaN                                                NaN       \n",
       "50049              NaN                                                NaN       \n",
       "50079              NaN                                                NaN       \n",
       "50202              NaN                                                NaN       \n",
       "\n",
       "      Дата сделки Дата регистрации договора Идентификатор сделки  \\\n",
       "113    06.04.2022                14.04.2022    57504113-комплекс   \n",
       "122    04.04.2022                06.04.2022    57392418-комплекс   \n",
       "140    01.04.2022                21.04.2022    57618490-комплекс   \n",
       "141    01.04.2022                21.04.2022    57618490-комплекс   \n",
       "179    26.03.2022                26.03.2022             57228983   \n",
       "...           ...                       ...                  ...   \n",
       "49963  07.08.2021                17.08.2021             39412068   \n",
       "50043  17.04.2020                03.06.2020    15997114-комплекс   \n",
       "50049  17.04.2020                03.06.2020    15997114-комплекс   \n",
       "50079  06.12.2019                28.01.2020     4008784-комплекс   \n",
       "50202  09.10.2018                30.11.2018    54602742-комплекс   \n",
       "\n",
       "       Количество объектов в сделке  Цена в бел. руб.  \\\n",
       "113                               4          36927.45   \n",
       "122                               5         980077.33   \n",
       "140                               8        2378902.10   \n",
       "141                               8        2378902.10   \n",
       "179                               1         149760.00   \n",
       "...                             ...               ...   \n",
       "49963                             1          19682.00   \n",
       "50043                            22               NaN   \n",
       "50049                            22               NaN   \n",
       "50079                            24          34739.59   \n",
       "50202                            25           1600.00   \n",
       "\n",
       "       Цена в бел. руб. за кв.м  \\\n",
       "113                      100.98   \n",
       "122                      355.95   \n",
       "140                     1920.95   \n",
       "141                     1920.95   \n",
       "179                      383.80   \n",
       "...                         ...   \n",
       "49963                    245.72   \n",
       "50043                       NaN   \n",
       "50049                       NaN   \n",
       "50079                   1459.65   \n",
       "50202                      1.87   \n",
       "\n",
       "                                           Описание цены  Цена в долларах США  \\\n",
       "113    цена указана в отношении капитальных строений ...             12547.98   \n",
       "122                          указана общая сумма сделки             332951.94   \n",
       "140    цена капитальных строений с инв. номерами 610/...            808270.62   \n",
       "141    цена капитальных строений с инв. номерами 610/...            808270.62   \n",
       "179                                                  NaN             46870.31   \n",
       "...                                                  ...                  ...   \n",
       "49963                                                NaN              7828.96   \n",
       "50043  Сведения о цена указаны в регистрационной книг...                  NaN   \n",
       "50049  Сведения о цена указаны в регистрационной книг...                  NaN   \n",
       "50079  Цена по договору купли-продажи в отношении кап...             16406.72   \n",
       "50202  цена указана за капитальные строения 100/С-468...               741.43   \n",
       "\n",
       "       Цена в долларах США за кв.м  Цена в евро  Цена в евро за кв.м  \\\n",
       "113                          34.31     11408.98                31.20   \n",
       "122                         120.92    300351.61               109.08   \n",
       "140                         652.67    725053.98               585.48   \n",
       "141                         652.67    725053.98               585.48   \n",
       "179                         120.12     42607.19               109.19   \n",
       "...                            ...          ...                  ...   \n",
       "49963                        97.74      6619.14                82.64   \n",
       "50043                          NaN          NaN                  NaN   \n",
       "50049                          NaN          NaN                  NaN   \n",
       "50079                       689.36     14800.44               621.87   \n",
       "50202                         0.87       645.21                 0.75   \n",
       "\n",
       "           Тип цены  Цена по договору Валюта по договору Переходящая доля  \\\n",
       "113    Цена объекта          36927.45                BYN         1/1, 1/1   \n",
       "122    Цена объекта         980077.33                BYN              1/1   \n",
       "140    Цена объекта        2378902.10                BYN              1/1   \n",
       "141    Цена объекта        2378902.10                BYN              1/1   \n",
       "179    Цена объекта         149760.00                BYN         1/1, 1/1   \n",
       "...             ...               ...                ...              ...   \n",
       "49963  Цена объекта          19682.00                BYN         1/1, 1/1   \n",
       "50043  Цена объекта              0.00                NaN         1/1, 1/1   \n",
       "50049  Цена объекта              0.00                NaN         1/1, 1/1   \n",
       "50079  Цена объекта          34739.59                BYN         1/1, 1/1   \n",
       "50202  Цена объекта           1600.00                BYN         1/1, 1/1   \n",
       "\n",
       "       Количество комнат ИП Этаж расположения ИП Инвентарный номер КС  \\\n",
       "113                     NaN                  NaN          451/C-15944   \n",
       "122                     NaN                  NaN          632/C-30119   \n",
       "140                     NaN                  NaN          610/C-48064   \n",
       "141                     NaN                  NaN          610/C-48064   \n",
       "179                     NaN                  NaN          151/C-12752   \n",
       "...                     ...                  ...                  ...   \n",
       "49963                   NaN                  NaN          311/C-50231   \n",
       "50043                   NaN                  NaN          614/C-23933   \n",
       "50049                   NaN                  NaN          614/C-23469   \n",
       "50079                   NaN                  NaN          250/C-31676   \n",
       "50202                   NaN                  NaN          100/C-46855   \n",
       "\n",
       "       Общая площадь КС, кв.м  Жилая площадь КС, кв.м  \\\n",
       "113                     365.7                     NaN   \n",
       "122                    2753.4                     NaN   \n",
       "140                    1238.4                     NaN   \n",
       "141                    1238.4                     NaN   \n",
       "179                     390.2                     NaN   \n",
       "...                       ...                     ...   \n",
       "49963                    80.1                     NaN   \n",
       "50043                    40.7                     NaN   \n",
       "50049                   698.0                     NaN   \n",
       "50079                    23.8                     NaN   \n",
       "50202                   855.7                     NaN   \n",
       "\n",
       "                                           Назначение КС  \\\n",
       "113                 Здание административно-хозяйственное   \n",
       "122           Здание специализированное иного назначения   \n",
       "140           Здание специализированное иного назначения   \n",
       "141           Здание специализированное иного назначения   \n",
       "179                 Здание административно-хозяйственное   \n",
       "...                                                  ...   \n",
       "49963                Здание гостиниц, мотелей, кемпингов   \n",
       "50043                                     Здание нежилое   \n",
       "50049  Здание специализированное для общественного пи...   \n",
       "50079                Здание гостиниц, мотелей, кемпингов   \n",
       "50202  Здание специализированное для общественного пи...   \n",
       "\n",
       "                                  Описание назначения КС  \\\n",
       "113                 Здание административно-хозяйственное   \n",
       "122           здание специализированное иного назначения   \n",
       "140                         Здание вспомогательного цеха   \n",
       "141                         Здание вспомогательного цеха   \n",
       "179                                                  NaN   \n",
       "...                                                  ...   \n",
       "49963                Здание гостиниц, мотелей, кемпингов   \n",
       "50043                                     Здание нежилое   \n",
       "50049  Здание специализированное для общественного пи...   \n",
       "50079                Здание гостиниц, мотелей, кемпингов   \n",
       "50202  Здание специализированное для общественного пи...   \n",
       "\n",
       "                          Наименование КС Процент готовности КС  \\\n",
       "113               Административное здание                   NaN   \n",
       "122                          жилой корпус                   NaN   \n",
       "140                   Вспомогательный цех                   NaN   \n",
       "141                   Вспомогательный цех                   NaN   \n",
       "179               Административное здание                   NaN   \n",
       "...                                   ...                   ...   \n",
       "49963  Жилой гостевой дом усадебного типа                   NaN   \n",
       "50043                          Здание КПП                   NaN   \n",
       "50049                            Столовая                   NaN   \n",
       "50079               домик летнего типа №5                   NaN   \n",
       "50202                            Столовая                   NaN   \n",
       "\n",
       "       Количество надземных этажей, шт.  Количество подземных этажей, шт.  \\\n",
       "113                                 2.0                               NaN   \n",
       "122                                 3.0                               1.0   \n",
       "140                                 1.0                               NaN   \n",
       "141                                 1.0                               NaN   \n",
       "179                                 1.0                               NaN   \n",
       "...                                 ...                               ...   \n",
       "49963                               1.0                               NaN   \n",
       "50043                               1.0                               NaN   \n",
       "50049                               2.0                               NaN   \n",
       "50079                               1.0                               NaN   \n",
       "50202                               2.0                               NaN   \n",
       "\n",
       "                     Составные элементы и принадлежности Кадастровый номер ЗУ  \\\n",
       "113                  ограждение, покрытие, дымовая труба  422382308102000033    \n",
       "122    подвал (литер 3А2-3/к), дорожки (литер а), огр...  622085700062000026    \n",
       "140    А1/ск-Вспомогательный цех,1-Склад,а4-Подпорная...  620850100007000652    \n",
       "141    А1/ск-Вспомогательный цех,1-Склад,а4-Подпорная...  640400000007000127    \n",
       "179                                                  NaN  121650100001003231    \n",
       "...                                                  ...                  ...   \n",
       "49963  Одноэтажный кирпичный жилой гостевой дом усаде...  320885202601000015    \n",
       "50043                                                NaN  624800000001000405    \n",
       "50049  Ограждение (лит. а1), площадки и дорожки (лит....  624800000001000405    \n",
       "50079                                                нет  223800000001000310    \n",
       "50202  Погреб, колодец, умывальник, три забора, трое ...  121284307101000289    \n",
       "\n",
       "                                           Назначение ЗУ  \\\n",
       "113    Земельный участок для размещения объектов иног...   \n",
       "122          Земельный участок рекреационного назначения   \n",
       "140    Земельный участок для размещения объектов розн...   \n",
       "141        Земельный участок неустановленного назначения   \n",
       "179    Земельный участок для размещения объектов иног...   \n",
       "...                                                  ...   \n",
       "49963  Земельный участок для размещения объектов усад...   \n",
       "50043        Земельный участок рекреационного назначения   \n",
       "50049        Земельный участок рекреационного назначения   \n",
       "50079        Земельный участок рекреационного назначения   \n",
       "50202  Земельный участок для размещения объектов физк...   \n",
       "\n",
       "                                  Описание назначения ЗУ  Площадь ЗУ, кв.м  \\\n",
       "113    Земельный участок для строительства и обслужив...           21793.0   \n",
       "122    земельный участок для содержания и обслуживани...           72787.0   \n",
       "140    Земельный участок для обслуживания здания вчпо...            4360.0   \n",
       "141    Для обслуж. и эксплуат. зданий и сооруж. произ...           21107.0   \n",
       "179    Для строительства и обслуживания теплицы по пр...           28369.0   \n",
       "...                                                  ...               ...   \n",
       "49963  Земельный участок для строительства и обслужив...            2652.0   \n",
       "50043  Земельный участок для обслуживания зданий и со...           60528.0   \n",
       "50049  Земельный участок для обслуживания зданий и со...           60528.0   \n",
       "50079          для содержания и обслуживания базы отдыха           38191.0   \n",
       "50202  Содержание и обслуживание учебно-спортивной ба...           63829.0   \n",
       "\n",
       "       Уникальный номер АТЕ                         Маркеры  \\\n",
       "113                 13604.0  Комплекс; Продавец Государство   \n",
       "122                 18337.0                        Комплекс   \n",
       "140                 22666.0                        Комплекс   \n",
       "141                 22666.0                        Комплекс   \n",
       "179                   563.0                 Первичный рынок   \n",
       "...                     ...                             ...   \n",
       "49963                9903.0                             NaN   \n",
       "50043               21527.0  Комплекс; Нет валюты; Нет цены   \n",
       "50049               21527.0  Комплекс; Нет валюты; Нет цены   \n",
       "50079                6722.0  Комплекс; Продавец Государство   \n",
       "50202                 516.0  Комплекс; Продавец Государство   \n",
       "\n",
       "      Дата проведения обследования КС / РХ  Объем КС, куб.м / РХ  \\\n",
       "113                             16.12.2020                1555.0   \n",
       "122                             27.04.2021                9938.0   \n",
       "140                             28.06.2021                8619.0   \n",
       "141                             28.06.2021                8619.0   \n",
       "179                             12.02.2019                1631.0   \n",
       "...                                    ...                   ...   \n",
       "49963                           18.07.2018                 246.0   \n",
       "50043                           04.07.2016                 149.0   \n",
       "50049                           09.10.2018                4024.0   \n",
       "50079                           11.10.2018                  74.0   \n",
       "50202                           18.02.2012                3354.0   \n",
       "\n",
       "       Общая площадь жилых помещений КС, кв.м / РХ  \\\n",
       "113                                            0.0   \n",
       "122                                            0.0   \n",
       "140                                            0.0   \n",
       "141                                            0.0   \n",
       "179                                            0.0   \n",
       "...                                            ...   \n",
       "49963                                          0.0   \n",
       "50043                                          NaN   \n",
       "50049                                          0.0   \n",
       "50079                                          0.0   \n",
       "50202                                          NaN   \n",
       "\n",
       "       Общая площадь нежилых помещений КС, кв.м / РХ  \\\n",
       "113                                              0.0   \n",
       "122                                              0.0   \n",
       "140                                              NaN   \n",
       "141                                              NaN   \n",
       "179                                              NaN   \n",
       "...                                              ...   \n",
       "49963                                            0.0   \n",
       "50043                                            0.0   \n",
       "50049                                            0.0   \n",
       "50079                                            NaN   \n",
       "50202                                            0.0   \n",
       "\n",
       "       Количество изолированных помещений (квартир) КС / РХ  \\\n",
       "113                                                  0.0      \n",
       "122                                                  0.0      \n",
       "140                                                  NaN      \n",
       "141                                                  NaN      \n",
       "179                                                  NaN      \n",
       "...                                                  ...      \n",
       "49963                                                0.0      \n",
       "50043                                                0.0      \n",
       "50049                                                0.0      \n",
       "50079                                                NaN      \n",
       "50202                                                0.0      \n",
       "\n",
       "       Физический износ на дату обследования КС, % / РХ  \\\n",
       "113                                                46.0   \n",
       "122                                                36.0   \n",
       "140                                                38.0   \n",
       "141                                                38.0   \n",
       "179                                                28.0   \n",
       "...                                                 ...   \n",
       "49963                                              19.0   \n",
       "50043                                              14.0   \n",
       "50049                                              45.0   \n",
       "50079                                              37.0   \n",
       "50202                                              34.0   \n",
       "\n",
       "      Наличие холодного водоснабжения КС / РХ  \\\n",
       "113                                      Нет    \n",
       "122                  Централизованная система   \n",
       "140                  Централизованная система   \n",
       "141                  Централизованная система   \n",
       "179                  Централизованная система   \n",
       "...                                       ...   \n",
       "49963                                    Нет    \n",
       "50043                Централизованная система   \n",
       "50049                      Автономная система   \n",
       "50079                                    Нет    \n",
       "50202                       Локальная система   \n",
       "\n",
       "      Наличие горячего водоснабжения КС / РХ Наличие канализации КС / РХ  \\\n",
       "113                                     Нет                         Нет    \n",
       "122                 Централизованная система    Централизованная система   \n",
       "140                 Централизованная система    Централизованная система   \n",
       "141                 Централизованная система    Централизованная система   \n",
       "179                                     Нет     Централизованная система   \n",
       "...                                      ...                         ...   \n",
       "49963                                   Нет                         Нет    \n",
       "50043                                   Нет     Централизованная система   \n",
       "50049                                    NaN          Автономная система   \n",
       "50079                                   Нет                         Нет    \n",
       "50202                      Локальная система           Локальная система   \n",
       "\n",
       "                  Наличие отопления КС / РХ Наличие газоснабжения КС / РХ  \\\n",
       "113    Котел на твердом топливе,Центральное                          Нет    \n",
       "122                             Центральное                          Нет    \n",
       "140                             Центральное                          Нет    \n",
       "141                             Центральное                          Нет    \n",
       "179     Автономное,Котел на твердом топливе                          Нет    \n",
       "...                                     ...                           ...   \n",
       "49963                                  Печь                          Нет    \n",
       "50043                                   Нет                          Нет    \n",
       "50049                       Котлы отопления                           NaN   \n",
       "50079                                   Нет                          Нет    \n",
       "50202                             Локальное                          Нет    \n",
       "\n",
       "      Наличие электроснабжения КС / РХ Наличие ванн (душей) КС / РХ  \\\n",
       "113           Централизованная система                          Нет   \n",
       "122           Централизованная система                          Душ   \n",
       "140           Централизованная система                          Душ   \n",
       "141           Централизованная система                          Душ   \n",
       "179           Централизованная система        Умывальник (раковина)   \n",
       "...                                ...                          ...   \n",
       "49963                             Нет                           Нет   \n",
       "50043         Централизованная система                          Нет   \n",
       "50049         Централизованная система                          NaN   \n",
       "50079         Централизованная система                          Нет   \n",
       "50202         Централизованная система                          Нет   \n",
       "\n",
       "      Наличие напольных электроплит КС / РХ  \\\n",
       "113                                     Нет   \n",
       "122                                     Нет   \n",
       "140                                     Нет   \n",
       "141                                     Нет   \n",
       "179                                     Нет   \n",
       "...                                     ...   \n",
       "49963                                   Нет   \n",
       "50043                                   Нет   \n",
       "50049                                   NaN   \n",
       "50079                                   Нет   \n",
       "50202                                  Есть   \n",
       "\n",
       "              Материал  крыши (кровли) КС / РХ Материал фундамента КС / РХ  \\\n",
       "113            Асбестоцементный волнистый лист                   Бутобетон   \n",
       "122              Рулонные кровельные материалы                       Бетон   \n",
       "140    Рулонные кровельные материалы на битуме                 Железобетон   \n",
       "141    Рулонные кровельные материалы на битуме                 Железобетон   \n",
       "179              Рулонные кровельные материалы                       Бетон   \n",
       "...                                        ...                         ...   \n",
       "49963                                Ондувилла                     Кирпичи   \n",
       "50043  Рулонные кровельные материалы на битуме                       Бетон   \n",
       "50049  Рулонные кровельные материалы на битуме        Блоки железобетонные   \n",
       "50079          Асбестоцементный волнистый лист                     Кирпичи   \n",
       "50202            Рулонные кровельные материалы                       Бетон   \n",
       "\n",
       "                      Материал перекрытий КС / РХ  \\\n",
       "113                                   Железобетон   \n",
       "122                                   Железобетон   \n",
       "140    Плита перекрытия железобетонная монолитная   \n",
       "141    Плита перекрытия железобетонная монолитная   \n",
       "179                          Плита железобетонная   \n",
       "...                                           ...   \n",
       "49963                                      Дерево   \n",
       "50043                        Плита железобетонная   \n",
       "50049                                 Железобетон   \n",
       "50079                                      Дерево   \n",
       "50202                        Плита железобетонная   \n",
       "\n",
       "                       Стоимости КС / РХ  sheet_source  \\\n",
       "113    Данные на листе \"Стоимости КС_РХ\"  РБ админ NEW   \n",
       "122    Данные на листе \"Стоимости КС_РХ\"  РБ админ NEW   \n",
       "140    Данные на листе \"Стоимости КС_РХ\"  РБ админ NEW   \n",
       "141    Данные на листе \"Стоимости КС_РХ\"  РБ админ NEW   \n",
       "179    Данные на листе \"Стоимости КС_РХ\"  РБ админ NEW   \n",
       "...                                  ...           ...   \n",
       "49963  Данные на листе \"Стоимости КС_РХ\"     гостиница   \n",
       "50043  Данные на листе \"Стоимости КС_РХ\"     гостиница   \n",
       "50049  Данные на листе \"Стоимости КС_РХ\"     гостиница   \n",
       "50079  Данные на листе \"Стоимости КС_РХ\"     гостиница   \n",
       "50202  Данные на листе \"Стоимости КС_РХ\"     гостиница   \n",
       "\n",
       "                                            search_param  \\\n",
       "113    Здание административно-хозяйственное; \\nАдмини...   \n",
       "122    Здание административно-хозяйственное; \\nАдмини...   \n",
       "140    Здание административно-хозяйственное; \\nАдмини...   \n",
       "141    Здание административно-хозяйственное; \\nАдмини...   \n",
       "179    Здание административно-хозяйственное; \\nАдмини...   \n",
       "...                                                  ...   \n",
       "49963                           Здание гостиниц, мотелей   \n",
       "50043                           Здание гостиниц, мотелей   \n",
       "50049                           Здание гостиниц, мотелей   \n",
       "50079                           Здание гостиниц, мотелей   \n",
       "50202                           Здание гостиниц, мотелей   \n",
       "\n",
       "      Распределение долей до сделки Распределение долей после сделки  \\\n",
       "113                             NaN                              NaN   \n",
       "122                             NaN                              NaN   \n",
       "140                             NaN                              NaN   \n",
       "141                             NaN                              NaN   \n",
       "179                             NaN                              NaN   \n",
       "...                             ...                              ...   \n",
       "49963                           NaN                              NaN   \n",
       "50043                           NaN                              NaN   \n",
       "50049                           NaN                              NaN   \n",
       "50079                           NaN                              NaN   \n",
       "50202                           NaN                              NaN   \n",
       "\n",
       "       Исходная цена Исходная валюта  \n",
       "113              NaN             NaN  \n",
       "122              NaN             NaN  \n",
       "140              NaN             NaN  \n",
       "141              NaN             NaN  \n",
       "179              NaN             NaN  \n",
       "...              ...             ...  \n",
       "49963            NaN             NaN  \n",
       "50043            NaN             NaN  \n",
       "50049            NaN             NaN  \n",
       "50079            NaN             NaN  \n",
       "50202            NaN             NaN  \n",
       "\n",
       "[1438 rows x 69 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[total_df[\"Стоимости КС / РХ\"].notna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "ca8d5954",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (210, 66)\n",
      "Num of undefined columns: 0\n",
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (112, 66)\n",
      "Num of undefined columns: 0\n",
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (30, 66)\n",
      "Num of undefined columns: 0\n",
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (14, 66)\n",
      "Num of undefined columns: 0\n",
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (43, 66)\n",
      "Num of undefined columns: 0\n",
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (1, 66)\n",
      "Num of undefined columns: 0\n",
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (257, 66)\n",
      "Num of undefined columns: 0\n",
      "Number of sheets: 1\n",
      " ['Выгрузка по КСиИП']\n",
      "df output shape: (215, 66)\n",
      "Num of undefined columns: 0\n"
     ]
    }
   ],
   "source": [
    "tmp_df = pd.DataFrame()\n",
    "\n",
    "for file in new_aug_files:\n",
    "    new_df = collect_all_df(file, sheet_name=\"Выгрузка по КСиИП\")\n",
    "    cost_df = pd.read_excel(file, sheet_name=\"Стоимость КС_РХ\", header=5)\n",
    "\n",
    "    # берём колонку стоимости с листа Стоимость КС_РХ (имя может отличаться)\n",
    "    src_cost_col = (\n",
    "        \"Стоимости КС / РХ\"\n",
    "        if \"Стоимости КС / РХ\" in cost_df.columns\n",
    "        else \"Стоимость, руб. КС / РХ\"\n",
    "    )\n",
    "\n",
    "    # мерж по Инв+Дата сделки, подтягиваем новую стоимость\n",
    "    new_df = new_df.merge(\n",
    "        cost_df[[\"Инвентарный номер\", \"Дата сделки\", src_cost_col]].rename(\n",
    "            columns={src_cost_col: \"_new_cost\"}\n",
    "        ),\n",
    "        on=[\"Инвентарный номер\", \"Дата сделки\"],\n",
    "        how=\"left\",\n",
    "    )\n",
    "\n",
    "    # перезаписываем только там, где в cost_df есть значение\n",
    "    new_df[\"Стоимости КС / РХ\"] = new_df[\"_new_cost\"].where(\n",
    "        new_df[\"_new_cost\"].notna(), new_df[\"Стоимости КС / РХ\"]\n",
    "    )\n",
    "    new_df = new_df.drop(columns=[\"_new_cost\"])\n",
    "    tmp_df = pd.concat([tmp_df, new_df], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "ffeea972",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "п/п                                                       0.000000\n",
       "Тип недвижимого имущества                                 0.000000\n",
       "Инвентарный номер                                         0.000000\n",
       "Адрес                                                     0.000000\n",
       "Назначение                                                0.000000\n",
       "Описание назначения                                       0.194131\n",
       "Наименование                                              0.001129\n",
       "Общая площадь, кв.м                                       0.031603\n",
       "Жилая площадь, кв.м                                       0.916479\n",
       "Материал стен                                             0.030474\n",
       "Дата ввода                                                0.231377\n",
       "Дата консервации                                          0.857788\n",
       "Дата реконструкции (реставрации, капитального ремонта)    0.986456\n",
       "Дата сделки                                               0.000000\n",
       "Дата регистрации договора                                 0.000000\n",
       "Идентификатор сделки                                      0.000000\n",
       "Количество объектов в сделке                              0.000000\n",
       "Цена в бел. руб.                                          0.000000\n",
       "Цена в бел. руб. за кв.м                                  0.119639\n",
       "Описание цены                                             0.792325\n",
       "Цена в долларах США                                       0.000000\n",
       "Цена в долларах США за кв.м                               0.119639\n",
       "Цена в евро                                               0.000000\n",
       "Цена в евро за кв.м                                       0.119639\n",
       "Тип цены                                                  0.000000\n",
       "Цена по договору                                          0.000000\n",
       "Валюта по договору                                        0.000000\n",
       "Переходящая доля                                          0.000000\n",
       "Количество комнат ИП                                      0.994357\n",
       "Этаж расположения ИП                                      0.658014\n",
       "Инвентарный номер КС                                      0.000000\n",
       "Общая площадь КС, кв.м                                    0.031603\n",
       "Жилая площадь КС, кв.м                                    1.000000\n",
       "Назначение КС                                             0.000000\n",
       "Описание назначения КС                                    0.160271\n",
       "Наименование КС                                           0.000000\n",
       "Процент готовности КС                                     0.898420\n",
       "Количество надземных этажей, шт.                          0.141084\n",
       "Количество подземных этажей, шт.                          0.758465\n",
       "Составные элементы и принадлежности                       0.316027\n",
       "Кадастровый номер ЗУ                                      0.000000\n",
       "Назначение ЗУ                                             0.000000\n",
       "Описание назначения ЗУ                                    0.014673\n",
       "Площадь ЗУ, кв.м                                          0.000000\n",
       "Уникальный номер АТЕ                                      0.000000\n",
       "Маркеры                                                   0.213318\n",
       "Дата проведения обследования КС / РХ                      0.803612\n",
       "Объем КС, куб.м / РХ                                      0.820542\n",
       "Общая площадь жилых помещений КС, кв.м / РХ               0.830700\n",
       "Общая площадь нежилых помещений КС, кв.м / РХ             0.920993\n",
       "Количество изолированных помещений (квартир) КС / РХ      0.923251\n",
       "Физический износ на дату обследования КС, % / РХ          0.887133\n",
       "Наличие холодного водоснабжения КС / РХ                   0.839729\n",
       "Наличие горячего водоснабжения КС / РХ                    0.841986\n",
       "Наличие канализации КС / РХ                               0.839729\n",
       "Наличие отопления КС / РХ                                 0.838600\n",
       "Наличие газоснабжения КС / РХ                             0.839729\n",
       "Наличие электроснабжения КС / РХ                          0.838600\n",
       "Наличие ванн (душей) КС / РХ                              0.847630\n",
       "Наличие напольных электроплит КС / РХ                     0.849887\n",
       "Материал  крыши (кровли) КС / РХ                          0.841986\n",
       "Материал фундамента КС / РХ                               0.830700\n",
       "Материал перекрытий КС / РХ                               0.846501\n",
       "Стоимости КС / РХ                                         0.946953\n",
       "sheet_source                                              0.000000\n",
       "search_param                                              0.000000\n",
       "dtype: float64"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmp_df.isna().mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "a4146ee8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'Исходная валюта',\n",
       " 'Исходная цена',\n",
       " 'Распределение долей до сделки',\n",
       " 'Распределение долей после сделки'}"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "set(total_df.columns) - set(tmp_df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "e1ffb3f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df = pd.concat([total_df, tmp_df], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "faa82117",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df.drop(columns=[\"п/п\"], inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "456965be-089f-4327-b6f1-a13ce725d4e3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1636\n"
     ]
    }
   ],
   "source": [
    "print(total_df.duplicated().sum())\n",
    "total_df.drop_duplicates(inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b56988c8",
   "metadata": {},
   "source": [
    "# Убираем дубликаты\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "c3636d33",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total df size:  (49482, 69)\n",
      "Total count of duplicate rows with ['Инвентарный номер', 'Идентификатор сделки', 'Цена в бел. руб.', 'Цена в долларах США', 'Цена в евро', 'Цена по договору'] 25664\n",
      "Total count of duplicate rows with ['Инвентарный номер', 'Идентификатор сделки'] 25807\n"
     ]
    }
   ],
   "source": [
    "dupl_transact_price = total_df.duplicated(\n",
    "    subset=[\n",
    "        \"Инвентарный номер\",\n",
    "        \"Идентификатор сделки\",\n",
    "        \"Цена в бел. руб.\",\n",
    "        \"Цена в долларах США\",\n",
    "        \"Цена в евро\",\n",
    "        \"Цена по договору\",\n",
    "    ],\n",
    "    keep=False,\n",
    ").sum()\n",
    "dupl_transact = total_df.duplicated(\n",
    "    subset=[\"Инвентарный номер\", \"Идентификатор сделки\"], keep=False\n",
    ")\n",
    "\n",
    "print(\"Total df size: \", total_df.shape)\n",
    "print(\n",
    "    \"Total count of duplicate rows with ['Инвентарный номер', 'Идентификатор сделки', 'Цена в бел. руб.', 'Цена в долларах США', 'Цена в евро', 'Цена по договору']\",\n",
    "    dupl_transact_price.sum(),\n",
    ")\n",
    "print(\n",
    "    \"Total count of duplicate rows with ['Инвентарный номер', 'Идентификатор сделки']\",\n",
    "    dupl_transact.sum(),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "839b2e07",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Дубликаты по Инвентарный номер', 'Идентификатор сделки', по с разной ценой\n",
    "dupl_diff_price = (\n",
    "    total_df[\n",
    "        total_df[\"Идентификатор сделки\"].isin(\n",
    "            total_df[(dupl_transact != dupl_transact_price)][\n",
    "                \"Идентификатор сделки\"\n",
    "            ]\n",
    "        )\n",
    "    ]\n",
    "    .drop_duplicates(\n",
    "        subset=[\n",
    "            \"Инвентарный номер\",\n",
    "            \"Идентификатор сделки\",\n",
    "            \"Цена в бел. руб.\",\n",
    "            \"Цена в долларах США\",\n",
    "            \"Цена в евро\",\n",
    "            \"Цена по договору\",\n",
    "        ],\n",
    "        keep=\"first\",\n",
    "    )\n",
    "    .sort_values(by=\"Инвентарный номер\")\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "2727b83a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <th>Адрес</th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Описание назначения</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <th>Материал стен</th>\n",
       "      <th>Дата ввода</th>\n",
       "      <th>Дата консервации</th>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <th>Тип цены</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Валюта по договору</th>\n",
       "      <th>Переходящая доля</th>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <th>Назначение КС</th>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <th>Наименование КС</th>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <th>Маркеры</th>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>search_param</th>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <th>Исходная цена</th>\n",
       "      <th>Исходная валюта</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>50194</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>132/C-324</td>\n",
       "      <td>Брестская обл., Ивановский р-н, Лясковичский с...</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Гостинница</td>\n",
       "      <td>773.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.10.2018</td>\n",
       "      <td>20.11.2018</td>\n",
       "      <td>1740618</td>\n",
       "      <td>1</td>\n",
       "      <td>84294.0</td>\n",
       "      <td>109.05</td>\n",
       "      <td>договорная</td>\n",
       "      <td>39345.59</td>\n",
       "      <td>50.9</td>\n",
       "      <td>34074.7</td>\n",
       "      <td>44.08</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>84294.0</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>132/C-324</td>\n",
       "      <td>773.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Здание гостиниц, мотелей, кемпингов</td>\n",
       "      <td>Гостинница</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>отсутствуют</td>\n",
       "      <td>123083702101000020</td>\n",
       "      <td>Земельный участок для размещения объектов гост...</td>\n",
       "      <td>Для обслуживания гостинницы и платной автостоянки</td>\n",
       "      <td>5046.0</td>\n",
       "      <td>921.0</td>\n",
       "      <td>Нет даты ввода</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>гостиница</td>\n",
       "      <td>Здание гостиниц, мотелей</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46836</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>132/C-12246</td>\n",
       "      <td>Брестская обл., Ивановский р-н, Мотольский с/с...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>здание детской библиотеки</td>\n",
       "      <td>101.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Древесина</td>\n",
       "      <td>1966-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.05.2020</td>\n",
       "      <td>22.05.2020</td>\n",
       "      <td>1798756</td>\n",
       "      <td>1</td>\n",
       "      <td>7154.0</td>\n",
       "      <td>70.48</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2924.42</td>\n",
       "      <td>28.81</td>\n",
       "      <td>2697.28</td>\n",
       "      <td>26.57</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>7154.0</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>132/C-12246</td>\n",
       "      <td>101.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>здание детской библиотеки</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>пристройка -1, уборная -2, покрытие -а, забор ...</td>\n",
       "      <td>123084505601001279</td>\n",
       "      <td>Земельный участок для размещения объектов куль...</td>\n",
       "      <td>Земельный участок для обслуживания здания детс...</td>\n",
       "      <td>696.0</td>\n",
       "      <td>932.0</td>\n",
       "      <td>Продавец Государство</td>\n",
       "      <td>12.09.2019</td>\n",
       "      <td>376.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Печь,Центральное</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Асбестоцементный волнистый лист</td>\n",
       "      <td>Бетон</td>\n",
       "      <td>Дерево</td>\n",
       "      <td>Данные на листе \"Стоимости КС_РХ\"</td>\n",
       "      <td>РБ культуры (new)</td>\n",
       "      <td>Помещение культурно-просветительного и зрелищн...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46180</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>254/C-11730</td>\n",
       "      <td>Витебская обл., Миорский р-н, Узменский с/с, д...</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>здание школы</td>\n",
       "      <td>991.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Железобетонные изделия</td>\n",
       "      <td>1986-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.05.2020</td>\n",
       "      <td>17.06.2020</td>\n",
       "      <td>2074125</td>\n",
       "      <td>1</td>\n",
       "      <td>28.35</td>\n",
       "      <td>0.03</td>\n",
       "      <td>NaN</td>\n",
       "      <td>11.57</td>\n",
       "      <td>0.01</td>\n",
       "      <td>10.7</td>\n",
       "      <td>0.01</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>28.35</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>254/C-11730</td>\n",
       "      <td>991.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>здание школы</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>подвал, уборная, покрытие</td>\n",
       "      <td>223381302601000054</td>\n",
       "      <td>Земельный участок для размещения объектов обра...</td>\n",
       "      <td>Земельный участок для обслуживания здания школ...</td>\n",
       "      <td>2593.0</td>\n",
       "      <td>5803.0</td>\n",
       "      <td>Продавец Государство</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ образование (new)</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46839</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>254/C-11698</td>\n",
       "      <td>Витебская обл., Миорский р-н, Заутьевский с/с,...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>здание специализированное культурно-просветите...</td>\n",
       "      <td>здание клуба</td>\n",
       "      <td>177.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Древесина</td>\n",
       "      <td>1983-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>05.05.2020</td>\n",
       "      <td>18.06.2020</td>\n",
       "      <td>2074334</td>\n",
       "      <td>1</td>\n",
       "      <td>28.35</td>\n",
       "      <td>0.16</td>\n",
       "      <td>цена по договору купли-продажи</td>\n",
       "      <td>11.55</td>\n",
       "      <td>0.07</td>\n",
       "      <td>10.56</td>\n",
       "      <td>0.06</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>28.35</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>254/C-11698</td>\n",
       "      <td>177.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>здание специализированное культурно-просветите...</td>\n",
       "      <td>здание клуба</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>котельная, две пристройки</td>\n",
       "      <td>223381705601000150</td>\n",
       "      <td>Земельный участок для размещения объектов куль...</td>\n",
       "      <td>Земельный участок для обслуживания здания клуб...</td>\n",
       "      <td>1164.0</td>\n",
       "      <td>5829.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ культуры (new)</td>\n",
       "      <td>Помещение культурно-просветительного и зрелищн...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46834</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>130/C-47521</td>\n",
       "      <td>Брестская обл., Пинский р-н, Ставокский с/с, д...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание сельского клуба</td>\n",
       "      <td>256.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1961-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>05.06.2020</td>\n",
       "      <td>26.06.2020</td>\n",
       "      <td>2914222</td>\n",
       "      <td>1</td>\n",
       "      <td>2800.0</td>\n",
       "      <td>10.93</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1167.79</td>\n",
       "      <td>4.56</td>\n",
       "      <td>1042.17</td>\n",
       "      <td>4.07</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>2800.0</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>130/C-47521</td>\n",
       "      <td>256.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание сельского клуба</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>кирпичная пристройка, навес из столбов, дощаты...</td>\n",
       "      <td>125489105101000138</td>\n",
       "      <td>Земельный участок для размещения объектов куль...</td>\n",
       "      <td>для обслуживания здания сельского дома культуры</td>\n",
       "      <td>1595.0</td>\n",
       "      <td>2059.0</td>\n",
       "      <td>Транзит, Δ цены: 0.00%</td>\n",
       "      <td>20.06.2008</td>\n",
       "      <td>1152.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>52.0</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Печь</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Асбестоцементный волнистый лист</td>\n",
       "      <td>Бетон</td>\n",
       "      <td>Дерево</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ культуры (new)</td>\n",
       "      <td>Помещение культурно-просветительного и зрелищн...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46147</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>255/C-14167</td>\n",
       "      <td>Витебская обл., Браславский р-н, Плюсский с/с,...</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>школа</td>\n",
       "      <td>275.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Древесина</td>\n",
       "      <td>1935-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10.07.2020</td>\n",
       "      <td>11.07.2020</td>\n",
       "      <td>3269852</td>\n",
       "      <td>1</td>\n",
       "      <td>7400.0</td>\n",
       "      <td>26.91</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3041.26</td>\n",
       "      <td>11.06</td>\n",
       "      <td>2686.9</td>\n",
       "      <td>9.77</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>7400.0</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>255/C-14167</td>\n",
       "      <td>275.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>школа</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>две дощатые веранды, бревенчатый сарай</td>\n",
       "      <td>220887005601000069</td>\n",
       "      <td>Земельный участок для размещения объектов обра...</td>\n",
       "      <td>Земельный участок для размещения объектов обра...</td>\n",
       "      <td>2494.0</td>\n",
       "      <td>3194.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ образование (new)</td>\n",
       "      <td>Здание специализированное для образования и во...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Тип недвижимого имущества Инвентарный номер  \\\n",
       "50194      Капитальное строение         132/C-324   \n",
       "46836      Капитальное строение       132/C-12246   \n",
       "46180      Капитальное строение       254/C-11730   \n",
       "46839      Капитальное строение       254/C-11698   \n",
       "46834      Капитальное строение       130/C-47521   \n",
       "46147      Капитальное строение       255/C-14167   \n",
       "\n",
       "                                                   Адрес  \\\n",
       "50194  Брестская обл., Ивановский р-н, Лясковичский с...   \n",
       "46836  Брестская обл., Ивановский р-н, Мотольский с/с...   \n",
       "46180  Витебская обл., Миорский р-н, Узменский с/с, д...   \n",
       "46839  Витебская обл., Миорский р-н, Заутьевский с/с,...   \n",
       "46834  Брестская обл., Пинский р-н, Ставокский с/с, д...   \n",
       "46147  Витебская обл., Браславский р-н, Плюсский с/с,...   \n",
       "\n",
       "                                              Назначение  \\\n",
       "50194                Здание гостиниц, мотелей, кемпингов   \n",
       "46836  Здание специализированное культурно-просветите...   \n",
       "46180  Здание специализированное для образования и во...   \n",
       "46839  Здание специализированное культурно-просветите...   \n",
       "46834  Здание специализированное культурно-просветите...   \n",
       "46147  Здание специализированное для образования и во...   \n",
       "\n",
       "                                     Описание назначения  \\\n",
       "50194                Здание гостиниц, мотелей, кемпингов   \n",
       "46836  Здание специализированное культурно-просветите...   \n",
       "46180  Здание специализированное для образования и во...   \n",
       "46839  здание специализированное культурно-просветите...   \n",
       "46834  Здание специализированное культурно-просветите...   \n",
       "46147  Здание специализированное для образования и во...   \n",
       "\n",
       "                    Наименование Общая площадь, кв.м Жилая площадь, кв.м  \\\n",
       "50194                 Гостинница               773.0                 NaN   \n",
       "46836  здание детской библиотеки               101.5                 NaN   \n",
       "46180               здание школы               991.1                 NaN   \n",
       "46839               здание клуба               177.3                 NaN   \n",
       "46834     Здание сельского клуба               256.1                 NaN   \n",
       "46147                      школа               275.0                 NaN   \n",
       "\n",
       "                Материал стен           Дата ввода Дата консервации  \\\n",
       "50194                  Кирпич                  NaN              NaN   \n",
       "46836               Древесина  1966-01-01 00:00:00              NaN   \n",
       "46180  Железобетонные изделия  1986-01-01 00:00:00              NaN   \n",
       "46839               Древесина  1983-01-01 00:00:00              NaN   \n",
       "46834                  Кирпич  1961-01-01 00:00:00              NaN   \n",
       "46147               Древесина  1935-01-01 00:00:00              NaN   \n",
       "\n",
       "      Дата реконструкции (реставрации, капитального ремонта) Дата сделки  \\\n",
       "50194                                                NaN      12.10.2018   \n",
       "46836                                                NaN      14.05.2020   \n",
       "46180                                                NaN      15.05.2020   \n",
       "46839                                                NaN      05.05.2020   \n",
       "46834                                                NaN      05.06.2020   \n",
       "46147                                                NaN      10.07.2020   \n",
       "\n",
       "      Дата регистрации договора Идентификатор сделки  \\\n",
       "50194                20.11.2018              1740618   \n",
       "46836                22.05.2020              1798756   \n",
       "46180                17.06.2020              2074125   \n",
       "46839                18.06.2020              2074334   \n",
       "46834                26.06.2020              2914222   \n",
       "46147                11.07.2020              3269852   \n",
       "\n",
       "      Количество объектов в сделке Цена в бел. руб. Цена в бел. руб. за кв.м  \\\n",
       "50194                            1          84294.0                   109.05   \n",
       "46836                            1           7154.0                    70.48   \n",
       "46180                            1            28.35                     0.03   \n",
       "46839                            1            28.35                     0.16   \n",
       "46834                            1           2800.0                    10.93   \n",
       "46147                            1           7400.0                    26.91   \n",
       "\n",
       "                        Описание цены Цена в долларах США  \\\n",
       "50194                      договорная            39345.59   \n",
       "46836                             NaN             2924.42   \n",
       "46180                             NaN               11.57   \n",
       "46839  цена по договору купли-продажи               11.55   \n",
       "46834                             NaN             1167.79   \n",
       "46147                             NaN             3041.26   \n",
       "\n",
       "      Цена в долларах США за кв.м Цена в евро Цена в евро за кв.м  \\\n",
       "50194                        50.9     34074.7               44.08   \n",
       "46836                       28.81     2697.28               26.57   \n",
       "46180                        0.01        10.7                0.01   \n",
       "46839                        0.07       10.56                0.06   \n",
       "46834                        4.56     1042.17                4.07   \n",
       "46147                       11.06      2686.9                9.77   \n",
       "\n",
       "           Тип цены Цена по договору Валюта по договору Переходящая доля  \\\n",
       "50194  Цена объекта          84294.0                BYN         1/1, 1/1   \n",
       "46836  Цена объекта           7154.0                BYN         1/1, 1/1   \n",
       "46180  Цена объекта            28.35                BYN         1/1, 1/1   \n",
       "46839  Цена объекта            28.35                BYN              1/1   \n",
       "46834  Цена объекта           2800.0                BYN         1/1, 1/1   \n",
       "46147  Цена объекта           7400.0                BYN         1/1, 1/1   \n",
       "\n",
       "      Количество комнат ИП Этаж расположения ИП Инвентарный номер КС  \\\n",
       "50194                  NaN                  NaN            132/C-324   \n",
       "46836                  NaN                  NaN          132/C-12246   \n",
       "46180                  NaN                  NaN          254/C-11730   \n",
       "46839                  NaN                  NaN          254/C-11698   \n",
       "46834                  NaN                  NaN          130/C-47521   \n",
       "46147                  NaN                  NaN          255/C-14167   \n",
       "\n",
       "      Общая площадь КС, кв.м Жилая площадь КС, кв.м  \\\n",
       "50194                  773.0                    NaN   \n",
       "46836                  101.5                    NaN   \n",
       "46180                  991.1                    NaN   \n",
       "46839                  177.3                    NaN   \n",
       "46834                  256.1                    NaN   \n",
       "46147                  275.0                    NaN   \n",
       "\n",
       "                                           Назначение КС  \\\n",
       "50194                Здание гостиниц, мотелей, кемпингов   \n",
       "46836  Здание специализированное культурно-просветите...   \n",
       "46180  Здание специализированное для образования и во...   \n",
       "46839  Здание специализированное культурно-просветите...   \n",
       "46834  Здание специализированное культурно-просветите...   \n",
       "46147  Здание специализированное для образования и во...   \n",
       "\n",
       "                                  Описание назначения КС  \\\n",
       "50194                Здание гостиниц, мотелей, кемпингов   \n",
       "46836  Здание специализированное культурно-просветите...   \n",
       "46180  Здание специализированное для образования и во...   \n",
       "46839  здание специализированное культурно-просветите...   \n",
       "46834  Здание специализированное культурно-просветите...   \n",
       "46147  Здание специализированное для образования и во...   \n",
       "\n",
       "                 Наименование КС Процент готовности КС  \\\n",
       "50194                 Гостинница                   NaN   \n",
       "46836  здание детской библиотеки                   NaN   \n",
       "46180               здание школы                   NaN   \n",
       "46839               здание клуба                   NaN   \n",
       "46834     Здание сельского клуба                   NaN   \n",
       "46147                      школа                   NaN   \n",
       "\n",
       "      Количество надземных этажей, шт. Количество подземных этажей, шт.  \\\n",
       "50194                              2.0                              NaN   \n",
       "46836                              1.0                              NaN   \n",
       "46180                              2.0                              1.0   \n",
       "46839                              1.0                              NaN   \n",
       "46834                              1.0                              NaN   \n",
       "46147                              1.0                              NaN   \n",
       "\n",
       "                     Составные элементы и принадлежности Кадастровый номер ЗУ  \\\n",
       "50194                                        отсутствуют  123083702101000020    \n",
       "46836  пристройка -1, уборная -2, покрытие -а, забор ...  123084505601001279    \n",
       "46180                          подвал, уборная, покрытие  223381302601000054    \n",
       "46839                          котельная, две пристройки  223381705601000150    \n",
       "46834  кирпичная пристройка, навес из столбов, дощаты...  125489105101000138    \n",
       "46147             две дощатые веранды, бревенчатый сарай  220887005601000069    \n",
       "\n",
       "                                           Назначение ЗУ  \\\n",
       "50194  Земельный участок для размещения объектов гост...   \n",
       "46836  Земельный участок для размещения объектов куль...   \n",
       "46180  Земельный участок для размещения объектов обра...   \n",
       "46839  Земельный участок для размещения объектов куль...   \n",
       "46834  Земельный участок для размещения объектов куль...   \n",
       "46147  Земельный участок для размещения объектов обра...   \n",
       "\n",
       "                                  Описание назначения ЗУ Площадь ЗУ, кв.м  \\\n",
       "50194  Для обслуживания гостинницы и платной автостоянки           5046.0   \n",
       "46836  Земельный участок для обслуживания здания детс...            696.0   \n",
       "46180  Земельный участок для обслуживания здания школ...           2593.0   \n",
       "46839  Земельный участок для обслуживания здания клуб...           1164.0   \n",
       "46834    для обслуживания здания сельского дома культуры           1595.0   \n",
       "46147  Земельный участок для размещения объектов обра...           2494.0   \n",
       "\n",
       "      Уникальный номер АТЕ                 Маркеры  \\\n",
       "50194                921.0          Нет даты ввода   \n",
       "46836                932.0    Продавец Государство   \n",
       "46180               5803.0    Продавец Государство   \n",
       "46839               5829.0                     NaN   \n",
       "46834               2059.0  Транзит, Δ цены: 0.00%   \n",
       "46147               3194.0                     NaN   \n",
       "\n",
       "      Дата проведения обследования КС / РХ Объем КС, куб.м / РХ  \\\n",
       "50194                                  NaN                  NaN   \n",
       "46836                           12.09.2019                376.0   \n",
       "46180                                  NaN                  NaN   \n",
       "46839                                  NaN                  NaN   \n",
       "46834                           20.06.2008               1152.0   \n",
       "46147                                  NaN                  NaN   \n",
       "\n",
       "      Общая площадь жилых помещений КС, кв.м / РХ  \\\n",
       "50194                                         NaN   \n",
       "46836                                         0.0   \n",
       "46180                                         NaN   \n",
       "46839                                         NaN   \n",
       "46834                                         0.0   \n",
       "46147                                         NaN   \n",
       "\n",
       "      Общая площадь нежилых помещений КС, кв.м / РХ  \\\n",
       "50194                                           NaN   \n",
       "46836                                           0.0   \n",
       "46180                                           NaN   \n",
       "46839                                           NaN   \n",
       "46834                                           NaN   \n",
       "46147                                           NaN   \n",
       "\n",
       "      Количество изолированных помещений (квартир) КС / РХ  \\\n",
       "50194                                                NaN     \n",
       "46836                                                0.0     \n",
       "46180                                                NaN     \n",
       "46839                                                NaN     \n",
       "46834                                                NaN     \n",
       "46147                                                NaN     \n",
       "\n",
       "      Физический износ на дату обследования КС, % / РХ  \\\n",
       "50194                                              NaN   \n",
       "46836                                             37.0   \n",
       "46180                                              NaN   \n",
       "46839                                              NaN   \n",
       "46834                                             52.0   \n",
       "46147                                              NaN   \n",
       "\n",
       "      Наличие холодного водоснабжения КС / РХ  \\\n",
       "50194                                     NaN   \n",
       "46836                                    Нет    \n",
       "46180                                     NaN   \n",
       "46839                                     NaN   \n",
       "46834                                    Нет    \n",
       "46147                                     NaN   \n",
       "\n",
       "      Наличие горячего водоснабжения КС / РХ Наличие канализации КС / РХ  \\\n",
       "50194                                    NaN                         NaN   \n",
       "46836                                   Нет                         Нет    \n",
       "46180                                    NaN                         NaN   \n",
       "46839                                    NaN                         NaN   \n",
       "46834                                   Нет                         Нет    \n",
       "46147                                    NaN                         NaN   \n",
       "\n",
       "      Наличие отопления КС / РХ Наличие газоснабжения КС / РХ  \\\n",
       "50194                       NaN                           NaN   \n",
       "46836          Печь,Центральное                          Нет    \n",
       "46180                       NaN                           NaN   \n",
       "46839                       NaN                           NaN   \n",
       "46834                      Печь                          Нет    \n",
       "46147                       NaN                           NaN   \n",
       "\n",
       "      Наличие электроснабжения КС / РХ Наличие ванн (душей) КС / РХ  \\\n",
       "50194                              NaN                          NaN   \n",
       "46836         Централизованная система                          Нет   \n",
       "46180                              NaN                          NaN   \n",
       "46839                              NaN                          NaN   \n",
       "46834         Централизованная система                          Нет   \n",
       "46147                              NaN                          NaN   \n",
       "\n",
       "      Наличие напольных электроплит КС / РХ Материал  крыши (кровли) КС / РХ  \\\n",
       "50194                                   NaN                              NaN   \n",
       "46836                                   Нет  Асбестоцементный волнистый лист   \n",
       "46180                                   NaN                              NaN   \n",
       "46839                                   NaN                              NaN   \n",
       "46834                                   Нет  Асбестоцементный волнистый лист   \n",
       "46147                                   NaN                              NaN   \n",
       "\n",
       "      Материал фундамента КС / РХ Материал перекрытий КС / РХ  \\\n",
       "50194                         NaN                         NaN   \n",
       "46836                       Бетон                      Дерево   \n",
       "46180                         NaN                         NaN   \n",
       "46839                         NaN                         NaN   \n",
       "46834                       Бетон                      Дерево   \n",
       "46147                         NaN                         NaN   \n",
       "\n",
       "                       Стоимости КС / РХ          sheet_source  \\\n",
       "50194                                NaN             гостиница   \n",
       "46836  Данные на листе \"Стоимости КС_РХ\"     РБ культуры (new)   \n",
       "46180                                NaN  РБ образование (new)   \n",
       "46839                                NaN     РБ культуры (new)   \n",
       "46834                                NaN     РБ культуры (new)   \n",
       "46147                                NaN  РБ образование (new)   \n",
       "\n",
       "                                            search_param  \\\n",
       "50194                           Здание гостиниц, мотелей   \n",
       "46836  Помещение культурно-просветительного и зрелищн...   \n",
       "46180  Здание специализированное для образования и во...   \n",
       "46839  Помещение культурно-просветительного и зрелищн...   \n",
       "46834  Помещение культурно-просветительного и зрелищн...   \n",
       "46147  Здание специализированное для образования и во...   \n",
       "\n",
       "      Распределение долей до сделки Распределение долей после сделки  \\\n",
       "50194                           NaN                              NaN   \n",
       "46836                           NaN                              NaN   \n",
       "46180                           NaN                              NaN   \n",
       "46839                           NaN                              NaN   \n",
       "46834                           NaN                              NaN   \n",
       "46147                           NaN                              NaN   \n",
       "\n",
       "       Исходная цена Исходная валюта  \n",
       "50194            NaN             NaN  \n",
       "46836            NaN             NaN  \n",
       "46180            NaN             NaN  \n",
       "46839            NaN             NaN  \n",
       "46834            NaN             NaN  \n",
       "46147            NaN             NaN  "
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dupl_diff_price.sort_values(\n",
    "    by=[\"Идентификатор сделки\", \"Инвентарный номер\"]\n",
    ").head(6)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "258d8aa3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Удаляем дубликаты, изн кол-во (49482, 69)\n",
      "Кол-во после удаления дублей с разными ценами (49482, 69)\n",
      "Кол-во после удаления дубликатов (32688, 69)\n"
     ]
    }
   ],
   "source": [
    "# удалим дубли + уберем варианты с одинаковыми ун идентификаторами, но разными ценами\n",
    "print(f\"Удаляем дубликаты, изн кол-во {total_df.shape}\")\n",
    "ids_with_diff_price = dupl_diff_price[\"Идентификатор сделки\"].values\n",
    "total_df_tmp = total_df[\n",
    "    total_df[\"Идентификатор сделки\"].isin(ids_with_diff_price)\n",
    "].copy()\n",
    "print(\"Кол-во после удаления дублей с разными ценами\", total_df_tmp.shape)\n",
    "total_df_tmp = total_df_tmp.drop_duplicates(\n",
    "    subset=[\"Идентификатор сделки\", \"Инвентарный номер\"], keep=\"first\"\n",
    ")\n",
    "print(\"Кол-во после удаления дубликатов\", total_df_tmp.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f438b1a",
   "metadata": {},
   "source": [
    "второй кейс, удаляем инфу где одинаковые ун ид, но разная цена. Была проблема, что продажа была долей. Бизнес подготовил выгрузку с пересчитанными ценами\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "e132a5a7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 40 entries, 0 to 39\n",
      "Data columns (total 69 columns):\n",
      " #   Column                                                  Non-Null Count  Dtype  \n",
      "---  ------                                                  --------------  -----  \n",
      " 0   п/п                                                     40 non-null     int64  \n",
      " 1   Тип недвижимого имущества                               40 non-null     object \n",
      " 2   Инвентарный номер                                       40 non-null     object \n",
      " 3   Идентификатор сделки                                    40 non-null     object \n",
      " 4   Адрес                                                   40 non-null     object \n",
      " 5   Назначение                                              40 non-null     object \n",
      " 6   Описание назначения                                     38 non-null     object \n",
      " 7   Наименование                                            40 non-null     object \n",
      " 8   Общая площадь, кв.м                                     40 non-null     float64\n",
      " 9   Жилая площадь, кв.м                                     3 non-null      float64\n",
      " 10  Материал стен                                           40 non-null     object \n",
      " 11  Дата ввода                                              40 non-null     object \n",
      " 12  Дата консервации                                        0 non-null      float64\n",
      " 13  Дата реконструкции (реставрации, капитального ремонта)  0 non-null      float64\n",
      " 14  Дата сделки                                             40 non-null     object \n",
      " 15  Дата регистрации договора                               24 non-null     object \n",
      " 16  Количество объектов в сделке                            40 non-null     int64  \n",
      " 17  Цена в бел. руб.                                        40 non-null     float64\n",
      " 18  Цена в бел. руб. за кв.м                                40 non-null     float64\n",
      " 19  Описание цены                                           6 non-null      object \n",
      " 20  Цена в долларах США                                     40 non-null     float64\n",
      " 21  Цена в долларах США за кв.м                             40 non-null     float64\n",
      " 22  Цена в евро                                             40 non-null     float64\n",
      " 23  Цена в евро за кв.м                                     40 non-null     float64\n",
      " 24  Тип цены                                                24 non-null     object \n",
      " 25  Цена по договору                                        32 non-null     float64\n",
      " 26  Валюта по договору                                      32 non-null     object \n",
      " 27  Переходящая доля                                        24 non-null     object \n",
      " 28  Количество комнат ИП                                    0 non-null      float64\n",
      " 29  Этаж расположения ИП                                    16 non-null     object \n",
      " 30  Инвентарный номер КС                                    40 non-null     object \n",
      " 31  Общая площадь КС, кв.м                                  40 non-null     float64\n",
      " 32  Жилая площадь КС, кв.м                                  0 non-null      float64\n",
      " 33  Назначение КС                                           40 non-null     object \n",
      " 34  Описание назначения КС                                  40 non-null     object \n",
      " 35  Наименование КС                                         40 non-null     object \n",
      " 36  Процент готовности КС                                   16 non-null     float64\n",
      " 37  Количество надземных этажей, шт.                        40 non-null     int64  \n",
      " 38  Количество подземных этажей, шт.                        11 non-null     float64\n",
      " 39  Составные элементы и принадлежности                     23 non-null     object \n",
      " 40  Кадастровый номер ЗУ                                    39 non-null     float64\n",
      " 41  Назначение ЗУ                                           39 non-null     object \n",
      " 42  Описание назначения ЗУ                                  21 non-null     object \n",
      " 43  Площадь ЗУ, кв.м                                        39 non-null     float64\n",
      " 44  Уникальный номер АТЕ                                    32 non-null     float64\n",
      " 45  Маркеры                                                 34 non-null     object \n",
      " 46  Дата проведения обследования КС / РХ                    3 non-null      object \n",
      " 47  Объем КС, куб.м / РХ                                    4 non-null      float64\n",
      " 48  Общая площадь жилых помещений КС, кв.м / РХ             4 non-null      float64\n",
      " 49  Общая площадь нежилых помещений КС, кв.м / РХ           2 non-null      float64\n",
      " 50  Количество изолированных помещений (квартир) КС / РХ    2 non-null      float64\n",
      " 51  Физический износ на дату обследования КС, % / РХ        2 non-null      float64\n",
      " 52  Наличие холодного водоснабжения КС / РХ                 4 non-null      object \n",
      " 53  Наличие горячего водоснабжения КС / РХ                  4 non-null      object \n",
      " 54  Наличие канализации КС / РХ                             4 non-null      object \n",
      " 55  Наличие отопления КС / РХ                               4 non-null      object \n",
      " 56  Наличие газоснабжения КС / РХ                           3 non-null      object \n",
      " 57  Наличие электроснабжения КС / РХ                        4 non-null      object \n",
      " 58  Наличие ванн (душей) КС / РХ                            4 non-null      object \n",
      " 59  Наличие напольных электроплит КС / РХ                   3 non-null      object \n",
      " 60  Материал  крыши (кровли) КС / РХ                        4 non-null      object \n",
      " 61  Материал фундамента КС / РХ                             4 non-null      object \n",
      " 62  Материал перекрытий КС / РХ                             4 non-null      object \n",
      " 63  Стоимости КС / РХ                                       1 non-null      object \n",
      " 64  sheet_source                                            40 non-null     object \n",
      " 65  Распределение долей до сделки                           16 non-null     object \n",
      " 66  Распределение долей после сделки                        16 non-null     object \n",
      " 67  Исходная цена                                           8 non-null      float64\n",
      " 68  Исходная валюта                                         8 non-null      object \n",
      "dtypes: float64(25), int64(3), object(41)\n",
      "memory usage: 21.7+ KB\n",
      "{'search_param'}\n",
      "{'п/п'}\n"
     ]
    }
   ],
   "source": [
    "path_share = \"data/dupl_diff_price_remain.xlsx\"\n",
    "df_add_share = pd.read_excel(path_share)\n",
    "df_add_share.info()\n",
    "\n",
    "print(set(total_df_tmp.columns) - set(df_add_share.columns))\n",
    "print(set(df_add_share.columns) - set(total_df_tmp.columns))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "35de3b46",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape before concat (32688, 69)\n",
      "Shape after concat (32728, 70)\n"
     ]
    }
   ],
   "source": [
    "print(\"Shape before concat\", total_df_tmp.shape)\n",
    "total_df_tmp = pd.concat([total_df_tmp, df_add_share], ignore_index=True)\n",
    "print(\"Shape after concat\", total_df_tmp.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "244844c9",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "e840459a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-Удлаяем продажи между родственниками, продажи по оценочной стоимости, аффилированные продажи\n",
      "количество удаленных:  47\n",
      "Маркеры\n",
      "Между родственниками                                                                                                          14\n",
      "Комплекс; Между родственниками                                                                                                 8\n",
      "Доля; Между родственниками                                                                                                     4\n",
      "Между родственниками; Смена назначения                                                                                         4\n",
      "Доля; Комплекс; Между родственниками                                                                                           2\n",
      "Доля; Между родственниками; Смена назначения                                                                                   2\n",
      "Между родственниками; Нет даты ввода                                                                                           2\n",
      "Комплекс; Между родственниками; Смена назначения                                                                               1\n",
      "Комплекс; Между родственниками; Смена назначения; Транзит, Δ цены: 4.88%                                                       1\n",
      "Доля; Между родственниками; Нет даты ввода; Смена назначения                                                                   1\n",
      "Комплекс; Между родственниками; Нет даты ввода                                                                                 1\n",
      "Нерепрезентативная сделка; Продажа объекта по оценочной стоимости; Продажа объекта с составными частями и принадлежностями     1\n",
      "Между родственниками; Транзит, Δ цены: 0.00%                                                                                   1\n",
      "Комплекс; Между родственниками; Смена назначения; Транзит, Δ цены: 16.84%                                                      1\n",
      "Аукцион; Между родственниками; Смена назначения                                                                                1\n",
      "Доля; Между родственниками; Нет даты ввода                                                                                     1\n",
      "Комплекс; Между родственниками; Транзит, Δ цены: 59.20%                                                                        1\n",
      "Между родственниками; Нет даты ввода; Транзит, Δ цены: 0.00%                                                                   1\n",
      "Name: count, dtype: int64 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"-Удлаяем продажи между родственниками, продажи по оценочной стоимости, аффилированные продажи\"\n",
    ")\n",
    "print(\n",
    "    \"количество удаленных: \",\n",
    "    sum(\n",
    "        total_df_tmp[\"Маркеры\"].str.contains(\n",
    "            \"оценочн|родственник|аффилированн\", na=False\n",
    "        )\n",
    "    ),\n",
    ")\n",
    "print(\n",
    "    total_df_tmp[\"Маркеры\"]\n",
    "    .value_counts()\n",
    "    .loc[lambda x: x.index.str.contains(\"оценочн|родственник|аффилированн\")],\n",
    "    \"\\n\",\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "08ea8035",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-Удлаяем продажи законсервированные\n",
      "количество удаленных:  417\n",
      "Наименование КС\n",
      "Незавершенное законсервированное капитальное строение                                                                                                                                                                                                                    342\n",
      "незавершенное законсервированное капитальное строение                                                                                                                                                                                                                     37\n",
      "Незавершённое законсервированное капитальное строение                                                                                                                                                                                                                      6\n",
      "Незавершенный законсервированный жилой дом                                                                                                                                                                                                                                 5\n",
      "Незавершенное строительством законсервированное здание колбасного цеха                                                                                                                                                                                                     2\n",
      "незавершенное законсервированное капитальное строение, двухэтажное из блоков, облицованное кирпичом, незавершенное строительством административное здание строительной готовностью 84% с гаражом и частично разукомплектованным гаражом строительной готовностью 50%.      2\n",
      "незавершённое законсервированное капитальное строение                                                                                                                                                                                                                      2\n",
      "незавершенный законсервированный жилой дом                                                                                                                                                                                                                                 1\n",
      "незавершенное законсервированное капитальное строение.                                                                                                                                                                                                                     1\n",
      "Жилой дом (незавершенное законсервированное капитальное строение) 19                                                                                                                                                                                                       1\n",
      "незавершенное законсервированное капитальное строение садовый дом                                                                                                                                                                                                          1\n",
      "Незавершенное законсервированное капитальное строение - 10% готовностью                                                                                                                                                                                                    1\n",
      "Незавершённый законсервированный жилой дом                                                                                                                                                                                                                                 1\n",
      "незавершенное законсервированное капитальное строение, двухэтажное кирпичное, незавершенное строительством, законсервированное, с готовностью 56% здание Центра творчества детей и юношества.                                                                              1\n",
      "Незавершенное законсервированное капитальное строение ( кафе), процент готовности 46%                                                                                                                                                                                      1\n",
      "незавершенное законсервированное капитальное строение, одноэтажное кирпичное начатое строительством, законсервированное здание учебно-производственных мастерских, строительной готовностью 4,99%.                                                                         1\n",
      "незавершенное законсервированное капитальное строение (объект: здание АБК в пос.Билево)                                                                                                                                                                                    1\n",
      "Незавершенный законсервированный офисно-торговый центр в осях 1*-12*                                                                                                                                                                                                       1\n",
      "не завершенное законсервированное капитальное строение                                                                                                                                                                                                                     1\n",
      "Незавершенное законсервированное капитальное строение строительной готовностью 12%                                                                                                                                                                                         1\n",
      "Незавершенное строительством законсервированное капитальное строение                                                                                                                                                                                                       1\n",
      "Незаршенное законсервированное капитальное строение                                                                                                                                                                                                                        1\n",
      "незавершенное законсервированное капитальное строение готовностью 78%                                                                                                                                                                                                      1\n",
      "незавершенное законсервированное капитальное строение процентом готовности-50%                                                                                                                                                                                             1\n",
      "НЗКС- незаершенное законсервированное капитальное строение                                                                                                                                                                                                                 1\n",
      "незавершенное строительством законсервированное капитальное строение                                                                                                                                                                                                       1\n",
      "Незавершенное строительством, законсервированное, двухэтажное кирпичное здание, со строительной готовностью 68 %, незавершенное законсервированное капитальное строение                                                                                                    1\n",
      "Незавершенный законсервированный цех.                                                                                                                                                                                                                                      1\n",
      "Name: count, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "print(\"-Удлаяем продажи законсервированные\")\n",
    "print(\n",
    "    \"количество удаленных: \",\n",
    "    sum(total_df_tmp[\"Наименование КС\"].str.contains(\"законсервир\", na=False)),\n",
    ")\n",
    "print(\n",
    "    total_df_tmp[\"Наименование КС\"]\n",
    "    .value_counts()\n",
    "    .loc[lambda x: x.index.str.contains(\"законсервир\")]\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "5a57fcb3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Number of filtered rows:  462 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "filter = (\n",
    "    ~total_df_tmp[\"Маркеры\"].str.contains(\n",
    "        \"оценочн|родственник|аффилированн\", na=False\n",
    "    )\n",
    ") & (~total_df_tmp[\"Наименование КС\"].str.contains(\"законсервир\", na=False))\n",
    "total_df_wd_filter = total_df_tmp[filter]\n",
    "\n",
    "print(\n",
    "    \"\\nNumber of filtered rows: \",\n",
    "    len(total_df_tmp) - len(total_df_wd_filter),\n",
    "    \"\\n\",\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "3c8da3e4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Удаляем сделки, где \"Наименование\" == \"сооружение\". Кол-во удаленных:  2184 \n",
      "\n",
      "Удаляем сделки, где здания не достроены. Кол-во удаленных:  35 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "building = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower().str.contains(\"сооружение\")\n",
    ")\n",
    "print(\n",
    "    'Удаляем сделки, где \"Наименование\" == \"сооружение\". Кол-во удаленных: ',\n",
    "    sum(building),\n",
    "    \"\\n\",\n",
    ")\n",
    "total_df_wd_filter = total_df_wd_filter.loc[~building]\n",
    "\n",
    "not_finished = (\n",
    "    total_df_wd_filter[\"Инвентарный номер\"].str.lower().str.contains(\"u\")\n",
    ")\n",
    "print(\n",
    "    \"Удаляем сделки, где здания не достроены. Кол-во удаленных: \",\n",
    "    sum(not_finished),\n",
    "    \"\\n\",\n",
    ")\n",
    "total_df_wd_filter = total_df_wd_filter.loc[~not_finished]\n",
    "\n",
    "total_df_wd_filter = total_df_wd_filter.reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "abd258c1",
   "metadata": {},
   "source": [
    "## Категоризация\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "489850dd",
   "metadata": {},
   "source": [
    "Выделяем этаж\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "efed1d3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import regex as re\n",
    "\n",
    "\n",
    "def floor_parsing(x):\n",
    "    if isinstance(x, str):\n",
    "        match = re.search(r\"(\\d+)\", x)\n",
    "        if match:\n",
    "            number = int(match.group(1))\n",
    "            if \"подземный\" in x.lower():\n",
    "                number = -number\n",
    "            return number\n",
    "        else:\n",
    "            return None\n",
    "    else:\n",
    "        return None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "0a2c817e",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\ф\\AppData\\Local\\Temp\\ipykernel_27600\\3510497115.py:4: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[4.0 16.0 5.0 6.0 12.0 3.0 3.0 2.0 3.0 3.0 3.0 4.0 1.0 3.0 3.0 3.0 12.0\n",
      " 12.0 12.0 12.0 12.0 3.0 3.0 5.0 3.0 3.0 2.0 3.0 3.0 5.0 5.0 2.0 7.0 3.0\n",
      " 6.0 6.0 6.0 1.0 5.0 7.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0 3.0\n",
      " 3.0 3.0 3.0 3.0 3.0 3.0 7.0 7.0 3.0 7.0 7.0 12.0 3.0 3.0 3.0 3.0 3.0 5.0\n",
      " 2.0 5.0 4.0 5.0 3.0 3.0 3.0 4.0 5.0 12.0 12.0 12.0 12.0 12.0 3.0 1.0 1.0\n",
      " 5.0 1.0 21.0 2.0 3.0 1.0 1.0 4.0 1.0 1.0 4.0 1.0 4.0 6.0 7.0 6.0 6.0 6.0\n",
      " 6.0 6.0 4.0 12]' has dtype incompatible with float64, please explicitly cast to a compatible dtype first.\n",
      "  total_df_wd_filter.loc[\n"
     ]
    }
   ],
   "source": [
    "total_df_wd_filter[\"floor\"] = total_df_wd_filter[\"Этаж расположения ИП\"].map(\n",
    "    floor_parsing\n",
    ")\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Этаж расположения ИП\"].isin(\n",
    "        [\"Мансардный (мансарда)\", \"Чердак\", \"Технический чердак\", \"Антресоль\"]\n",
    "    ),\n",
    "    \"floor\",\n",
    "] = total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Этаж расположения ИП\"].isin(\n",
    "        [\"Мансардный (мансарда)\", \"Чердак\", \"Технический чердак\", \"Антресоль\"]\n",
    "    ),\n",
    "    \"Количество надземных этажей, шт.\",\n",
    "]\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Этаж расположения ИП\"].isin([\"Подвальный\"]), \"floor\"\n",
    "] = -1\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Этаж расположения ИП\"].isin([\"Цокольный\"]), \"floor\"\n",
    "] = -0.5"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "61e85c3b",
   "metadata": {},
   "source": [
    "##### **Категоризируем**\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b2ee1f67",
   "metadata": {},
   "source": [
    "удаляем сделки с \"Назначениями\", определенными бизнесом для удаления\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "743044b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Подвязка логики категоризации, определенной бизнесом\n",
    "path_categories = \"data/Рапределение_назначений_281072025.xlsx\"\n",
    "df_categories_purpose = pd.read_excel(path_categories, sheet_name=\"purpose\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "6d338a5c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Назначение</th>\n",
       "      <th>count</th>\n",
       "      <th>Категория</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Помещение здравоохранения</td>\n",
       "      <td>181</td>\n",
       "      <td>офис все, кроме аптеки,аптечного киоска-торговое</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>129</td>\n",
       "      <td>производство. Исключить РБУ, компрессорная, ра...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Помещение бытового обслуживания населения</td>\n",
       "      <td>122</td>\n",
       "      <td>офис, за исключением мастерская-производство,</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Помещение, не относящееся к жилищному фонду</td>\n",
       "      <td>29</td>\n",
       "      <td>мастерская-производство, модульный павильон-то...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Здание специализированное для производства маш...</td>\n",
       "      <td>29</td>\n",
       "      <td>производство, исключить насосные станции</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>119</th>\n",
       "      <td>Здание специализированное для ритуально-похоро...</td>\n",
       "      <td>1</td>\n",
       "      <td>удалить</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>Здание специализированное для образования и (и...</td>\n",
       "      <td>1</td>\n",
       "      <td>удалить</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>121</th>\n",
       "      <td>Здание специализированное связи</td>\n",
       "      <td>1</td>\n",
       "      <td>удалить</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>122</th>\n",
       "      <td>Сооружение специализированное для органов госу...</td>\n",
       "      <td>1</td>\n",
       "      <td>удалить</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123</th>\n",
       "      <td>Здание специализированное для производства эле...</td>\n",
       "      <td>1</td>\n",
       "      <td>удалить</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>124 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                            Назначение  count  \\\n",
       "0                            Помещение здравоохранения    181   \n",
       "1    Здание специализированное для производства стр...    129   \n",
       "2            Помещение бытового обслуживания населения    122   \n",
       "3          Помещение, не относящееся к жилищному фонду     29   \n",
       "4    Здание специализированное для производства маш...     29   \n",
       "..                                                 ...    ...   \n",
       "119  Здание специализированное для ритуально-похоро...      1   \n",
       "120  Здание специализированное для образования и (и...      1   \n",
       "121                    Здание специализированное связи      1   \n",
       "122  Сооружение специализированное для органов госу...      1   \n",
       "123  Здание специализированное для производства эле...      1   \n",
       "\n",
       "                                             Категория  \n",
       "0     офис все, кроме аптеки,аптечного киоска-торговое  \n",
       "1    производство. Исключить РБУ, компрессорная, ра...  \n",
       "2        офис, за исключением мастерская-производство,  \n",
       "3    мастерская-производство, модульный павильон-то...  \n",
       "4             производство, исключить насосные станции  \n",
       "..                                                 ...  \n",
       "119                                            удалить  \n",
       "120                                            удалить  \n",
       "121                                            удалить  \n",
       "122                                            удалить  \n",
       "123                                            удалить  \n",
       "\n",
       "[124 rows x 3 columns]"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_categories_purpose"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "e5eacd9b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Удаление \"Назначений\", определенных бизнесом:  2047 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "del_purpose = df_categories_purpose.loc[\n",
    "    df_categories_purpose[\"Категория\"] == \"удалить\", \"Назначение\"\n",
    "].values\n",
    "print(\n",
    "    'Удаление \"Назначений\", определенных бизнесом: ',\n",
    "    sum(total_df_wd_filter[\"Назначение\"].isin(del_purpose)),\n",
    "    \"\\n\",\n",
    ")\n",
    "total_df_wd_filter = total_df_wd_filter[\n",
    "    ~total_df_wd_filter[\"Назначение\"].isin(del_purpose)\n",
    "]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "14a9669a",
   "metadata": {},
   "source": [
    "Маппим кейсов без доп. условий по \"Назначение\" (лист purpose)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "4bcfdb4d",
   "metadata": {},
   "outputs": [],
   "source": [
    "offices_purpose = (\n",
    "    df_categories_purpose.loc[df_categories_purpose[\"Категория\"] == \"офис\"][\n",
    "        \"Назначение\"\n",
    "    ]\n",
    "    .str.lower()\n",
    "    .values\n",
    ")\n",
    "industry_purpose = (\n",
    "    df_categories_purpose.loc[\n",
    "        df_categories_purpose[\"Категория\"] == \"производство\"\n",
    "    ][\"Назначение\"]\n",
    "    .str.lower()\n",
    "    .values\n",
    ")\n",
    "trade_purpose = (\n",
    "    df_categories_purpose.loc[df_categories_purpose[\"Категория\"] == \"торговля\"][\n",
    "        \"Назначение\"\n",
    "    ]\n",
    "    .str.lower()\n",
    "    .values\n",
    ")\n",
    "warehouse_purpose = (\n",
    "    df_categories_purpose.loc[df_categories_purpose[\"Категория\"] == \"склад\"][\n",
    "        \"Назначение\"\n",
    "    ]\n",
    "    .str.lower()\n",
    "    .values\n",
    ")\n",
    "agriculture_purpose = (\n",
    "    df_categories_purpose.loc[df_categories_purpose[\"Категория\"] == \"сельхоз\"][\n",
    "        \"Назначение\"\n",
    "    ]\n",
    "    .str.lower()\n",
    "    .values\n",
    ")\n",
    "cto_purpose = (\n",
    "    df_categories_purpose.loc[\n",
    "        df_categories_purpose[\"Категория\"].str.lower() == \"сто\"\n",
    "    ][\"Назначение\"]\n",
    "    .str.lower()\n",
    "    .values\n",
    ")\n",
    "\n",
    "\n",
    "# Основная часть по назначениюё\n",
    "total_df_wd_filter[\"category\"] = None\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower().isin(agriculture_purpose),\n",
    "    \"category\",\n",
    "] = \"сельхоз\"\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower().isin(warehouse_purpose),\n",
    "    \"category\",\n",
    "] = \"склад\"\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower().isin(trade_purpose), \"category\"\n",
    "] = \"торговля\"\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower().isin(industry_purpose),\n",
    "    \"category\",\n",
    "] = \"производство\"\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower().isin(offices_purpose),\n",
    "    \"category\",\n",
    "] = \"офис\"\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower().isin(cto_purpose), \"category\"\n",
    "] = \"сто\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "117507b7",
   "metadata": {},
   "source": [
    "Маппим кейсы, требующие условия по \"Наименование\" (определены серым цветом на вкладке 'puspose')  \n",
    "Примечание: сделано вручную. В дальнейшем требуется все это оптимизировать (как вариант вынести все такие \"Назначения\" на отдельные вкладки с указанием к чему какие \"НАименования\" относятся)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "1554fe3f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "помещение здравоохранения-------------------------------------------------------\n",
      "Total cnt:  183 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Аптека\n",
    "print(\n",
    "    \"помещение здравоохранения-------------------------------------------------------\"\n",
    ")\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower() == \"помещение здравоохранения\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"]\n",
    "    .str.lower()\n",
    "    .isin([\"аптека\", \"аптечный киоск\"])\n",
    ")\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"офис\"\n",
    "\n",
    "filter_1 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower() == \"помещение здравоохранения\"\n",
    ") & (\n",
    "    total_df_wd_filter[\"Наименование\"]\n",
    "    .str.lower()\n",
    "    .isin([\"аптека\", \"аптечный киоск\"])\n",
    ")\n",
    "total_df_wd_filter.loc[filter_1, \"category\"] = \"торговля\"\n",
    "print(\"Total cnt: \", sum(filter_0) + sum(filter_1), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "87da258d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Здание специализированное для производства строительных материалов-------------------------------------------------------\n",
      "Total cnt:  100 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"Здание специализированное для производства строительных материалов-------------------------------------------------------\"\n",
    ")\n",
    "exclude = [\n",
    "    \"узел\",\n",
    "    \"узла\",\n",
    "    \"РБУ\",\n",
    "    \"компрессорная\",\n",
    "    \"галерея\",\n",
    "    \"смесительная\",\n",
    "    \"проходная\",\n",
    "    \"кпп\",\n",
    "    \"пристройка\",\n",
    "    \"сушилка\",\n",
    "]\n",
    "pattern = \"|\".join(map(re.escape, exclude))\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание специализированное для производства строительных материалов\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"производство\"\n",
    "print(\"Total cnt: \", sum(filter_0), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "c42357cf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Помещение бытового обслуживания населения-------------------------------------------------------\n",
      "Total cnt:  111 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"Помещение бытового обслуживания населения-------------------------------------------------------\"\n",
    ")\n",
    "exclude = [\"мастерск\", \"производст\"]\n",
    "pattern = \"|\".join(map(re.escape, exclude))\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"помещение бытового обслуживания населения\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"офис\"\n",
    "print(\"Total cnt: \", sum(filter_0), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "1be7825b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "помещение, не относящееся к жилищному фонду-------------------------------------------------------\n",
      "Total cnt:  5 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"помещение, не относящееся к жилищному фонду-------------------------------------------------------\"\n",
    ")\n",
    "include_0 = [\"мастерск\"]\n",
    "include_1 = [\"павильон\"]\n",
    "include_2 = [\"склад\"]\n",
    "\n",
    "pattern_0 = \"|\".join(map(re.escape, include_0))\n",
    "pattern_1 = \"|\".join(map(re.escape, include_1))\n",
    "pattern_2 = \"|\".join(map(re.escape, include_2))\n",
    "\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"помещение, не относящееся к жилищному фонду\"\n",
    ") & (\n",
    "    total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern_0, case=False, na=False\n",
    "    )\n",
    ")\n",
    "filter_1 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"помещение, не относящееся к жилищному фонду\"\n",
    ") & (\n",
    "    total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern_1, case=False, na=False\n",
    "    )\n",
    ")\n",
    "filter_2 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"помещение, не относящееся к жилищному фонду\"\n",
    ") & (\n",
    "    total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern_2, case=False, na=False\n",
    "    )\n",
    ")\n",
    "\n",
    "\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"производство\"\n",
    "total_df_wd_filter.loc[filter_1, \"category\"] = \"торговля\"\n",
    "total_df_wd_filter.loc[filter_2, \"category\"] = \"склад\"\n",
    "\n",
    "print(\"Total cnt: \", sum(filter_0) + sum(filter_1) + sum(filter_2), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "e0ec5237",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Здание специализированное для производства машин и оборудования (машиностроения)-------------------------------------------------------\n",
      "Total cnt:  28 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"Здание специализированное для производства машин и оборудования (машиностроения)-------------------------------------------------------\"\n",
    ")\n",
    "exclude = [\"Насосн\"]  # насосная станция\n",
    "pattern = \"|\".join(map(re.escape, exclude))\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание специализированное для производства машин и оборудования (машиностроения)\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"производство\"\n",
    "print(\"Total cnt: \", sum(filter_0), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "9e3cfdc1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "здание специализированное для производства транспортных средств и оборудования-------------------------------------------------------\n",
      "Total cnt:  4 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"здание специализированное для производства транспортных средств и оборудования-------------------------------------------------------\"\n",
    ")\n",
    "exclude = [\"азс\"]  # насосная станция\n",
    "pattern = \"|\".join(map(re.escape, exclude))\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание специализированное для производства транспортных средств и оборудования\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"производство\"\n",
    "print(\"Total cnt: \", sum(filter_0), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "8cd8cfcf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "здание специализированное лесохозяйственного назначения-------------------------------------------------------\n",
      "Total cnt:  6 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"здание специализированное лесохозяйственного назначения-------------------------------------------------------\"\n",
    ")\n",
    "exclude = [\"склад\"]  # насосная станция\n",
    "pattern = \"|\".join(map(re.escape, exclude))\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание специализированное лесохозяйственного назначения\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "filter_1 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание специализированное лесохозяйственного назначения\"\n",
    ") & (\n",
    "    total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"производство\"\n",
    "total_df_wd_filter.loc[filter_1, \"category\"] = \"склад\"\n",
    "\n",
    "print(\"Total cnt: \", sum(filter_0) + sum(filter_1), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "baebe29e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "помещение специализированное для ремонта и технического обслуживания автомобилей-------------------------------------------------------\n",
      "Total cnt:  2 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"помещение специализированное для ремонта и технического обслуживания автомобилей-------------------------------------------------------\"\n",
    ")\n",
    "exclude = [\"гараж\"]  # насосная станция\n",
    "pattern = \"|\".join(map(re.escape, exclude))\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"помещение специализированное для ремонта и технического обслуживания автомобилей\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"сто\"\n",
    "print(\"Total cnt: \", sum(filter_0), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "1217f3a0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "здание административно-торговое-------------------------------------------------------\n",
      "Total cnt:  4 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\n",
    "    \"здание административно-торговое-------------------------------------------------------\"\n",
    ")\n",
    "exclude = [\"магазин\", \"торг\"]  # насосная станция\n",
    "pattern = \"|\".join(map(re.escape, exclude))\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание административно-торговое\"\n",
    ") & (\n",
    "    ~total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "filter_1 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание административно-торговое\"\n",
    ") & (\n",
    "    total_df_wd_filter[\"Наименование\"].str.contains(\n",
    "        pattern, case=False, na=False\n",
    "    )\n",
    ")\n",
    "\n",
    "\n",
    "total_df_wd_filter.loc[filter_0, \"category\"] = \"офис\"\n",
    "total_df_wd_filter.loc[filter_1, \"category\"] = \"торговля\"\n",
    "\n",
    "print(\"Total cnt: \", sum(filter_0) + sum(filter_1), \"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "033af504",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "здание специализированное для организации азартных игр-------------------------------------------------------\n",
      "Total cnt:  27 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Отдельный кейс для азартных\n",
    "print(\n",
    "    \"здание специализированное для организации азартных игр-------------------------------------------------------\"\n",
    ")\n",
    "\n",
    "filter_0 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"здание специализированное для организации азартных игр\"\n",
    ")\n",
    "total_df_wd_filter.loc[\n",
    "    filter_0 & (total_df_wd_filter[\"floor\"] > 1), \"category\"\n",
    "] = \"офис\"\n",
    "total_df_wd_filter.loc[\n",
    "    filter_0 & (total_df_wd_filter[\"floor\"] == 1), \"category\"\n",
    "] = \"торговля\"\n",
    "\n",
    "filter_1 = (\n",
    "    total_df_wd_filter[\"Назначение\"].str.lower()\n",
    "    == \"помещение для организации азартных игр\"\n",
    ")\n",
    "total_df_wd_filter.loc[\n",
    "    filter_1 & (total_df_wd_filter[\"floor\"] > 1), \"category\"\n",
    "] = \"офис\"\n",
    "total_df_wd_filter.loc[\n",
    "    filter_1 & (total_df_wd_filter[\"floor\"] == 1), \"category\"\n",
    "] = \"торговля\"\n",
    "\n",
    "print(\"Total cnt: \", sum(filter_0) + sum(filter_1), \"\\n\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d54f63f3",
   "metadata": {},
   "source": [
    "Отдельная категризация тех. \"Назначений\", где дополнительно категоризируется в соответсвтии с \"Наименование\". Те кейсы, которым в маппинге для \"Наименование\" не проставлена категория, удаляются\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "c787f082",
   "metadata": {},
   "outputs": [],
   "source": [
    "name_sheet = {\n",
    "    \"Здание специализированное иного назначения\": \"специализированное иного назнач\",\n",
    "    \"Здание неустановленного назначения\": \"неустановленного назначения\",\n",
    "    \"Помещение транспортного назначения\": \"категория помещения транспорт\",\n",
    "    \"Здание специализированное для ремонта и технического обслуживания автомобилей (в том числе автомобильные заправочные и газонаполнительные станции)\": \"ремонт авто 0\",\n",
    "    \"Здание нежилое\": \"здание нежилое\",\n",
    "    \"Помещение неустановленного назначения\": \"помещение неустановлено\",\n",
    "    \"здание многофункциональное\": \"здание многофункциональное\",\n",
    "    \"Здание специализированное для ремонта и технического обслуживания автомобилей (в т.ч. автомобильные заправочные и газонаполнительные станции)\": \"ремонт авто 1\",\n",
    "    \"Помещение многофункциональное\": \"помещение многофункциональное\",\n",
    "    \"Здание специализированное для бытового обслуживания населения\": \"бытовое обслуживание\",\n",
    "    \"Здание специализированное здравоохранения и предоставления социальных услуг\": \"спец здравоохранение\",\n",
    "    \"Здание специализированное организаций оптовой торговли, материально-технического снабжения и сбыта продукции\": \"спец оптовая торговля\",\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "13f99b92",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Chosen df:  здание специализированное иного назначения Shape:  (379, 2)\n",
      "Num of deleted nan:  -434\n",
      "Num of производство:  98\n",
      "Num of офис:  31\n",
      "Num of склад:  30\n",
      "Num of сельхоз:  16\n",
      "Num of торговля:  7\n",
      "\n",
      "Chosen df:  здание неустановленного назначения Shape:  (300, 2)\n",
      "Num of deleted nan:  -371\n",
      "Num of производство:  32\n",
      "Num of склад:  27\n",
      "Num of сельхоз:  17\n",
      "Num of офис:  15\n",
      "Num of сто:  1\n",
      "Num of торговля:  0\n",
      "\n",
      "Chosen df:  помещение транспортного назначения Shape:  (800, 2)\n",
      "Num of deleted nan:  -3592\n",
      "Num of сто:  23\n",
      "Num of производство:  10\n",
      "Num of склад:  1\n",
      "\n",
      "Chosen df:  здание специализированное для ремонта и технического обслуживания автомобилей (в том числе автомобильные заправочные и газонаполнительные станции) Shape:  (251, 2)\n",
      "Num of сто:  229\n",
      "Num of deleted nan:  -213\n",
      "Num of производство:  21\n",
      "Num of склад:  8\n",
      "Num of торговля:  1\n",
      "\n",
      "Chosen df:  здание нежилое Shape:  (217, 2)\n",
      "Num of deleted nan:  -257\n",
      "Num of производство:  53\n",
      "Num of склад:  53\n",
      "Num of офис:  24\n",
      "Num of сельхоз:  9\n",
      "Num of торговля:  4\n",
      "\n",
      "Chosen df:  помещение неустановленного назначения Shape:  (158, 2)\n",
      "Num of deleted nan:  -345\n",
      "Num of офис:  30\n",
      "Num of производство:  20\n",
      "Num of сто:  3\n",
      "Num of торговля:  4\n",
      "Num of склад:  3\n",
      "\n",
      "Chosen df:  здание многофункциональное Shape:  (237, 2)\n",
      "Num of производство:  83\n",
      "Num of deleted nan:  -125\n",
      "Num of офис:  76\n",
      "Num of торговля:  50\n",
      "Num of склад:  17\n",
      "Num of сто:  14\n",
      "\n",
      "Chosen df:  здание специализированное для ремонта и технического обслуживания автомобилей (в т.ч. автомобильные заправочные и газонаполнительные станции) Shape:  (173, 2)\n",
      "Num of deleted nan:  -183\n",
      "Num of сто:  60\n",
      "Num of производство:  88\n",
      "Num of склад:  2\n",
      "Num of офис:  1\n",
      "\n",
      "Chosen df:  помещение многофункциональное Shape:  (101, 2)\n",
      "Num of deleted nan:  -179\n",
      "Num of офис:  35\n",
      "Num of торговля:  26\n",
      "Num of прозводство:  11\n",
      "Num of склад:  4\n",
      "Num of сто:  2\n",
      "\n",
      "Chosen df:  здание специализированное для бытового обслуживания населения Shape:  (93, 2)\n",
      "Num of deleted nan:  -196\n",
      "Num of производство:  24\n",
      "Num of офис:  21\n",
      "\n",
      "Chosen df:  здание специализированное здравоохранения и предоставления социальных услуг Shape:  (109, 2)\n",
      "Num of офис:  149\n",
      "Num of торговля:  20\n",
      "Num of deleted nan:  -12\n",
      "Num of производство:  3\n",
      "Num of склад:  1\n",
      "\n",
      "Chosen df:  здание специализированное организаций оптовой торговли, материально-технического снабжения и сбыта продукции Shape:  (23, 2)\n",
      "Num of торговля:  18\n",
      "Num of склад:  8\n",
      "Num of производство:  3\n",
      "Num of офис:  3\n"
     ]
    }
   ],
   "source": [
    "del_cnt = 0\n",
    "\n",
    "for df_key, sheet_name in name_sheet.items():\n",
    "    df = pd.read_excel(path_categories, sheet_name=sheet_name, usecols=\"A:B\")\n",
    "    df_key = df_key.lower().strip()\n",
    "    print(\"\\nChosen df: \", df_key, \"Shape: \", df.shape)\n",
    "\n",
    "    for cat in (\n",
    "        df[\"Категория\"].str.lower().value_counts(dropna=False).index.to_list()\n",
    "    ):\n",
    "        if (cat is None) or (pd.isna(cat)):\n",
    "            values = (\n",
    "                df.loc[pd.isna(df[\"Категория\"]), \"Наименование\"]\n",
    "                .str.lower()\n",
    "                .values\n",
    "            )\n",
    "            filter = (\n",
    "                pd.isna(total_df_wd_filter[\"category\"])\n",
    "                & (\n",
    "                    total_df_wd_filter[\"Назначение\"].str.lower().str.strip()\n",
    "                    == df_key\n",
    "                )\n",
    "                & (total_df_wd_filter[\"Наименование\"].str.lower().isin(values))\n",
    "            )\n",
    "            before_len = len(total_df_wd_filter)\n",
    "            total_df_wd_filter = total_df_wd_filter[~filter]\n",
    "            print(\n",
    "                f\"Num of deleted {cat}: \", len(total_df_wd_filter) - before_len\n",
    "            )\n",
    "            del_cnt += sum(filter)\n",
    "        else:\n",
    "            values = (\n",
    "                df.loc[df[\"Категория\"].str.lower() == cat, \"Наименование\"]\n",
    "                .str.lower()\n",
    "                .values\n",
    "            )\n",
    "            filter = (\n",
    "                pd.isna(total_df_wd_filter[\"category\"])\n",
    "                & (\n",
    "                    total_df_wd_filter[\"Назначение\"].str.lower().str.strip()\n",
    "                    == df_key\n",
    "                )\n",
    "                & (total_df_wd_filter[\"Наименование\"].str.lower().isin(values))\n",
    "            )\n",
    "            # filter = (total_df_wd_filter['Назначение'] == cat) & (total_df_wd_filter['Наименование'].str.lower().isin(values))\n",
    "            # filter = total_df_wd_filter['Наименование'].str.lower().isin(values)\n",
    "\n",
    "            total_df_wd_filter.loc[filter, \"category\"] = cat\n",
    "            print(f\"Num of {cat}: \", sum(filter))\n",
    "\n",
    "\n",
    "total_df_wd_filter.loc[\n",
    "    total_df_wd_filter[\"category\"] == \"прозводство\", \"category\"\n",
    "] = \"производство\"\n",
    "# Маммип в категорию 'другое', все, что не прокатегоризировалось\n",
    "# total_df_wd_filter.loc[pd.isna(total_df_wd_filter['category']), 'category'] = 'другое'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "8824d2c5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Количество удаленных сделок по \"Назначение\":  5907\n"
     ]
    }
   ],
   "source": [
    "print('Количество удаленных сделок по \"Назначение\": ', del_cnt)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "4ce1ff33",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "category\n",
       "офис            6708\n",
       "торговля        6187\n",
       "склад           3870\n",
       "None            2397\n",
       "производство    1769\n",
       "сельхоз          823\n",
       "сто              339\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_wd_filter[\"category\"].value_counts(dropna=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "d07fc5f5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>size</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Здание многофункциональное</td>\n",
       "      <td>Здание фельдшерско-акушерского пункта  и зала ...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Здание многофункциональное</td>\n",
       "      <td>К 1/к Здание многофункциональное</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Здание неустановленного назначения</td>\n",
       "      <td>Здание артезианской скважины</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Здание неустановленного назначения</td>\n",
       "      <td>Здание для производства строительных материалов</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Здание неустановленного назначения</td>\n",
       "      <td>Здание пристройки под оборудование пчеловода (...</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>911</th>\n",
       "      <td>Помещение, не относящееся к жилищному фонду</td>\n",
       "      <td>Помещения блока № 1 и № 2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>912</th>\n",
       "      <td>Помещение, не относящееся к жилищному фонду</td>\n",
       "      <td>Участок №2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>913</th>\n",
       "      <td>Помещение, не относящееся к жилищному фонду</td>\n",
       "      <td>изолированное помещение №1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>915</th>\n",
       "      <td>Помещение, не относящееся к жилищному фонду</td>\n",
       "      <td>нежилое помещение</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>918</th>\n",
       "      <td>Помещение, не относящееся к жилищному фонду</td>\n",
       "      <td>туалеты</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>919 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                      Назначение  \\\n",
       "0                     Здание многофункциональное   \n",
       "1                     Здание многофункциональное   \n",
       "2             Здание неустановленного назначения   \n",
       "3             Здание неустановленного назначения   \n",
       "4             Здание неустановленного назначения   \n",
       "..                                           ...   \n",
       "911  Помещение, не относящееся к жилищному фонду   \n",
       "912  Помещение, не относящееся к жилищному фонду   \n",
       "913  Помещение, не относящееся к жилищному фонду   \n",
       "915  Помещение, не относящееся к жилищному фонду   \n",
       "918  Помещение, не относящееся к жилищному фонду   \n",
       "\n",
       "                                          Наименование  size  \n",
       "0    Здание фельдшерско-акушерского пункта  и зала ...     1  \n",
       "1                     К 1/к Здание многофункциональное     1  \n",
       "2                         Здание артезианской скважины     1  \n",
       "3      Здание для производства строительных материалов     1  \n",
       "4    Здание пристройки под оборудование пчеловода (...     1  \n",
       "..                                                 ...   ...  \n",
       "911                          Помещения блока № 1 и № 2     1  \n",
       "912                                         Участок №2     1  \n",
       "913                         изолированное помещение №1     1  \n",
       "915                                  нежилое помещение     1  \n",
       "918                                            туалеты     1  \n",
       "\n",
       "[919 rows x 3 columns]"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_wd_filter[pd.isna(total_df_wd_filter[\"category\"])].groupby(\n",
    "    by=[\"Назначение\", \"Наименование\"], as_index=False\n",
    ").size().sort_values(\n",
    "    by=[\"Назначение\", \"size\"], ascending=[True, False]\n",
    ")  # .to_excel('uncategorized_dist.xlsx')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "800b1ccb",
   "metadata": {},
   "source": [
    "## Кластеризация\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "92a75c69",
   "metadata": {},
   "outputs": [],
   "source": [
    "# При кластеризации \"сельхоз\" & \"сто\" будем относить к группе \"склад, производство\"\n",
    "total_df_wd_filter[\"for_clusters_gr\"] = total_df_wd_filter.apply(\n",
    "    lambda row: (\n",
    "        1\n",
    "        if row[\"category\"] in [\"офис\", \"торговля\"]\n",
    "        else (\n",
    "            0\n",
    "            if row[\"category\"] in [\"склад\", \"производство\", \"сельхоз\", \"сто\"]\n",
    "            else -1\n",
    "        )\n",
    "    ),\n",
    "    axis=1,\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "9982f3ab",
   "metadata": {},
   "outputs": [],
   "source": [
    "# utils\n",
    "def extract_NP(x):\n",
    "    if \" \" in x:\n",
    "        x = x[x.find(\" \") + 1 :]\n",
    "    return x.strip()\n",
    "\n",
    "\n",
    "def match_adress(x, mapping):\n",
    "    \"Поис x в mapping\"\n",
    "\n",
    "    x = x.strip().lower().replace(\"ё\", \"е\")\n",
    "    for object in mapping:\n",
    "        if (object is not None) and (object != \"-1\"):\n",
    "            object = object.strip().lower().replace(\"ё\", \"е\")\n",
    "            match = re.search(rf\"\\b{re.escape(object)}\\b\", x)\n",
    "            if match is not None:\n",
    "                return object\n",
    "    return None\n",
    "\n",
    "\n",
    "def find_geo_object(row, clustering, target_col):\n",
    "\n",
    "    cluster = row[\"for_clusters_gr\"]\n",
    "    if cluster in [1, 0]:\n",
    "        geo = clustering.loc[\n",
    "            clustering[\"for_clusters_gr\"] == cluster, target_col\n",
    "        ]\n",
    "        address = row[\"Адрес\"]\n",
    "        matching = match_adress(address, geo)\n",
    "        return matching\n",
    "    else:\n",
    "        return None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "86595fb9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>Object NP</th>\n",
       "      <th>Name NP</th>\n",
       "      <th>Name region</th>\n",
       "      <th>Name oblast</th>\n",
       "      <th>балл развития</th>\n",
       "      <th>Klaster</th>\n",
       "      <th>sheet_source</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>17030</td>\n",
       "      <td>г. Минск</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>1027</td>\n",
       "      <td>A</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>12370</td>\n",
       "      <td>г. Гомель</td>\n",
       "      <td>-</td>\n",
       "      <td>Гомельская</td>\n",
       "      <td>558</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2458</td>\n",
       "      <td>г. Брест</td>\n",
       "      <td>-</td>\n",
       "      <td>Брестская</td>\n",
       "      <td>514</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>17025</td>\n",
       "      <td>г. Гродно</td>\n",
       "      <td>-</td>\n",
       "      <td>Гродненская</td>\n",
       "      <td>511</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>22671</td>\n",
       "      <td>г. Солигорск</td>\n",
       "      <td>Солигорский</td>\n",
       "      <td>Минская</td>\n",
       "      <td>508</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>395</th>\n",
       "      <td>195</td>\n",
       "      <td>10693</td>\n",
       "      <td>гп Озаричи</td>\n",
       "      <td>Калинковичский</td>\n",
       "      <td>Гомельская</td>\n",
       "      <td>14</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>396</th>\n",
       "      <td>196</td>\n",
       "      <td>20510</td>\n",
       "      <td>гп Кривичи</td>\n",
       "      <td>Мядельский</td>\n",
       "      <td>Минская</td>\n",
       "      <td>14</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>397</th>\n",
       "      <td>197</td>\n",
       "      <td>6278</td>\n",
       "      <td>гп Копысь</td>\n",
       "      <td>Оршанский</td>\n",
       "      <td>Витебская</td>\n",
       "      <td>14</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>398</th>\n",
       "      <td>198</td>\n",
       "      <td>15910</td>\n",
       "      <td>гп Порозово</td>\n",
       "      <td>Свислочский</td>\n",
       "      <td>Гродненская</td>\n",
       "      <td>12</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>399</th>\n",
       "      <td>199</td>\n",
       "      <td>25233</td>\n",
       "      <td>рп Татарка</td>\n",
       "      <td>Осиповичский</td>\n",
       "      <td>Могилевская</td>\n",
       "      <td>11</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>400 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Unnamed: 0  Object NP       Name NP     Name region  Name oblast  \\\n",
       "0             0      17030      г. Минск               -            -   \n",
       "1             1      12370     г. Гомель               -   Гомельская   \n",
       "2             2       2458      г. Брест               -    Брестская   \n",
       "3             3      17025     г. Гродно               -  Гродненская   \n",
       "4             4      22671  г. Солигорск     Солигорский      Минская   \n",
       "..          ...        ...           ...             ...          ...   \n",
       "395         195      10693    гп Озаричи  Калинковичский   Гомельская   \n",
       "396         196      20510    гп Кривичи      Мядельский      Минская   \n",
       "397         197       6278     гп Копысь       Оршанский    Витебская   \n",
       "398         198      15910   гп Порозово     Свислочский  Гродненская   \n",
       "399         199      25233    рп Татарка    Осиповичский  Могилевская   \n",
       "\n",
       "     балл развития Klaster                    sheet_source  \n",
       "0             1027       A  Кластеры ОД_2022 офис-торговля  \n",
       "1              558       B  Кластеры ОД_2022 офис-торговля  \n",
       "2              514       B  Кластеры ОД_2022 офис-торговля  \n",
       "3              511       B  Кластеры ОД_2022 офис-торговля  \n",
       "4              508       B  Кластеры ОД_2022 офис-торговля  \n",
       "..             ...     ...                             ...  \n",
       "395             14       F   Кластеры ПС_2022 склад+произв  \n",
       "396             14       F   Кластеры ПС_2022 склад+произв  \n",
       "397             14       F   Кластеры ПС_2022 склад+произв  \n",
       "398             12       F   Кластеры ПС_2022 склад+произв  \n",
       "399             11       F   Кластеры ПС_2022 склад+произв  \n",
       "\n",
       "[400 rows x 8 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "path_clusters = \"./data/clusters_concat.xlsx\"\n",
    "\n",
    "df_cluster = pd.read_excel(path_clusters)\n",
    "display(df_cluster)\n",
    "df_cluster[\"Name NP\"] = df_cluster[\"Name NP\"].map(extract_NP).str.lower()\n",
    "df_cluster[\"Name region\"] = df_cluster[\"Name region\"].str.lower().str.strip()\n",
    "df_cluster[\"Name oblast\"] = df_cluster[\"Name oblast\"].str.lower().str.strip()\n",
    "\n",
    "\n",
    "df_cluster.loc[\n",
    "    (df_cluster[\"Name NP\"] == \"-\") | pd.isna(df_cluster[\"Name NP\"]), \"Name NP\"\n",
    "] = \"-1\"\n",
    "df_cluster.loc[\n",
    "    (df_cluster[\"Name region\"] == \"-\") | pd.isna(df_cluster[\"Name region\"]),\n",
    "    \"Name region\",\n",
    "] = \"-1\"\n",
    "df_cluster.loc[\n",
    "    (df_cluster[\"Name oblast\"] == \"-\") | pd.isna(df_cluster[\"Name oblast\"]),\n",
    "    \"Name oblast\",\n",
    "] = \"-1\"\n",
    "df_cluster[\"for_clusters_gr\"] = df_cluster.apply(\n",
    "    lambda row: (\n",
    "        1 if row[\"sheet_source\"] in [\"Кластеры ОД_2022 офис-торговля\"] else 0\n",
    "    ),\n",
    "    axis=1,\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "8d5ab78f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>Object NP</th>\n",
       "      <th>Name NP</th>\n",
       "      <th>Name region</th>\n",
       "      <th>Name oblast</th>\n",
       "      <th>балл развития</th>\n",
       "      <th>Klaster</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>for_clusters_gr</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>17030</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>1027</td>\n",
       "      <td>A</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>12370</td>\n",
       "      <td>гомель</td>\n",
       "      <td>-1</td>\n",
       "      <td>гомельская</td>\n",
       "      <td>558</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2458</td>\n",
       "      <td>брест</td>\n",
       "      <td>-1</td>\n",
       "      <td>брестская</td>\n",
       "      <td>514</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>17025</td>\n",
       "      <td>гродно</td>\n",
       "      <td>-1</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>511</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>22671</td>\n",
       "      <td>солигорск</td>\n",
       "      <td>солигорский</td>\n",
       "      <td>минская</td>\n",
       "      <td>508</td>\n",
       "      <td>B</td>\n",
       "      <td>Кластеры ОД_2022 офис-торговля</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>395</th>\n",
       "      <td>195</td>\n",
       "      <td>10693</td>\n",
       "      <td>озаричи</td>\n",
       "      <td>калинковичский</td>\n",
       "      <td>гомельская</td>\n",
       "      <td>14</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>396</th>\n",
       "      <td>196</td>\n",
       "      <td>20510</td>\n",
       "      <td>кривичи</td>\n",
       "      <td>мядельский</td>\n",
       "      <td>минская</td>\n",
       "      <td>14</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>397</th>\n",
       "      <td>197</td>\n",
       "      <td>6278</td>\n",
       "      <td>копысь</td>\n",
       "      <td>оршанский</td>\n",
       "      <td>витебская</td>\n",
       "      <td>14</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>398</th>\n",
       "      <td>198</td>\n",
       "      <td>15910</td>\n",
       "      <td>порозово</td>\n",
       "      <td>свислочский</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>12</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>399</th>\n",
       "      <td>199</td>\n",
       "      <td>25233</td>\n",
       "      <td>татарка</td>\n",
       "      <td>осиповичский</td>\n",
       "      <td>могилевская</td>\n",
       "      <td>11</td>\n",
       "      <td>F</td>\n",
       "      <td>Кластеры ПС_2022 склад+произв</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>400 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Unnamed: 0  Object NP    Name NP     Name region  Name oblast  \\\n",
       "0             0      17030      минск              -1           -1   \n",
       "1             1      12370     гомель              -1   гомельская   \n",
       "2             2       2458      брест              -1    брестская   \n",
       "3             3      17025     гродно              -1  гродненская   \n",
       "4             4      22671  солигорск     солигорский      минская   \n",
       "..          ...        ...        ...             ...          ...   \n",
       "395         195      10693    озаричи  калинковичский   гомельская   \n",
       "396         196      20510    кривичи      мядельский      минская   \n",
       "397         197       6278     копысь       оршанский    витебская   \n",
       "398         198      15910   порозово     свислочский  гродненская   \n",
       "399         199      25233    татарка    осиповичский  могилевская   \n",
       "\n",
       "     балл развития Klaster                    sheet_source  for_clusters_gr  \n",
       "0             1027       A  Кластеры ОД_2022 офис-торговля                1  \n",
       "1              558       B  Кластеры ОД_2022 офис-торговля                1  \n",
       "2              514       B  Кластеры ОД_2022 офис-торговля                1  \n",
       "3              511       B  Кластеры ОД_2022 офис-торговля                1  \n",
       "4              508       B  Кластеры ОД_2022 офис-торговля                1  \n",
       "..             ...     ...                             ...              ...  \n",
       "395             14       F   Кластеры ПС_2022 склад+произв                0  \n",
       "396             14       F   Кластеры ПС_2022 склад+произв                0  \n",
       "397             14       F   Кластеры ПС_2022 склад+произв                0  \n",
       "398             12       F   Кластеры ПС_2022 склад+произв                0  \n",
       "399             11       F   Кластеры ПС_2022 склад+произв                0  \n",
       "\n",
       "[400 rows x 9 columns]"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_cluster"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "46ebebc0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <th>Адрес</th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Описание назначения</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <th>Материал стен</th>\n",
       "      <th>Дата ввода</th>\n",
       "      <th>Дата консервации</th>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <th>Тип цены</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Валюта по договору</th>\n",
       "      <th>Переходящая доля</th>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <th>Назначение КС</th>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <th>Наименование КС</th>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <th>Маркеры</th>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>search_param</th>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <th>Исходная цена</th>\n",
       "      <th>Исходная валюта</th>\n",
       "      <th>п/п</th>\n",
       "      <th>floor</th>\n",
       "      <th>category</th>\n",
       "      <th>for_clusters_gr</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-7023057</td>\n",
       "      <td>г. Минск, ул. Почтовая, 20/5-105</td>\n",
       "      <td>Помещение транспортного назначения</td>\n",
       "      <td>Помещение транспортного назначения</td>\n",
       "      <td>Гараж 105</td>\n",
       "      <td>43.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2006-10-08 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>07.04.2022</td>\n",
       "      <td>07.04.2022</td>\n",
       "      <td>57406859-комплекс</td>\n",
       "      <td>2</td>\n",
       "      <td>12500.0</td>\n",
       "      <td>286.04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4242.18</td>\n",
       "      <td>97.08</td>\n",
       "      <td>3883.8</td>\n",
       "      <td>88.87</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>12500.0</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>500/C-45423</td>\n",
       "      <td>1960.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное автомобильного транс...</td>\n",
       "      <td>Здание специализированное автомобильного транс...</td>\n",
       "      <td>Здание специализированное автомобильного транс...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000009000886</td>\n",
       "      <td>Земельный участок для размещения автостоянок и...</td>\n",
       "      <td>Строительство и обслуживание открытой охраняем...</td>\n",
       "      <td>16520.0</td>\n",
       "      <td>17030.0</td>\n",
       "      <td>Комплекс</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>None</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Тип недвижимого имущества Инвентарный номер  \\\n",
       "61   Изолированное помещение     500/D-7023057   \n",
       "\n",
       "                               Адрес                          Назначение  \\\n",
       "61  г. Минск, ул. Почтовая, 20/5-105  Помещение транспортного назначения   \n",
       "\n",
       "                   Описание назначения Наименование Общая площадь, кв.м  \\\n",
       "61  Помещение транспортного назначения    Гараж 105                43.7   \n",
       "\n",
       "   Жилая площадь, кв.м Материал стен           Дата ввода Дата консервации  \\\n",
       "61                 NaN        Кирпич  2006-10-08 00:00:00              NaN   \n",
       "\n",
       "   Дата реконструкции (реставрации, капитального ремонта) Дата сделки  \\\n",
       "61                                                NaN      07.04.2022   \n",
       "\n",
       "   Дата регистрации договора Идентификатор сделки  \\\n",
       "61                07.04.2022    57406859-комплекс   \n",
       "\n",
       "   Количество объектов в сделке Цена в бел. руб. Цена в бел. руб. за кв.м  \\\n",
       "61                            2          12500.0                   286.04   \n",
       "\n",
       "   Описание цены Цена в долларах США Цена в долларах США за кв.м Цена в евро  \\\n",
       "61           NaN             4242.18                       97.08      3883.8   \n",
       "\n",
       "   Цена в евро за кв.м      Тип цены Цена по договору Валюта по договору  \\\n",
       "61               88.87  Цена объекта          12500.0                BYN   \n",
       "\n",
       "   Переходящая доля Количество комнат ИП Этаж расположения ИП  \\\n",
       "61              1/1                  NaN                  1-й   \n",
       "\n",
       "   Инвентарный номер КС Общая площадь КС, кв.м Жилая площадь КС, кв.м  \\\n",
       "61          500/C-45423                 1960.3                    NaN   \n",
       "\n",
       "                                        Назначение КС  \\\n",
       "61  Здание специализированное автомобильного транс...   \n",
       "\n",
       "                               Описание назначения КС  \\\n",
       "61  Здание специализированное автомобильного транс...   \n",
       "\n",
       "                                      Наименование КС Процент готовности КС  \\\n",
       "61  Здание специализированное автомобильного транс...                   NaN   \n",
       "\n",
       "   Количество надземных этажей, шт. Количество подземных этажей, шт.  \\\n",
       "61                              1.0                              1.0   \n",
       "\n",
       "   Составные элементы и принадлежности Кадастровый номер ЗУ  \\\n",
       "61                                 NaN  500000000009000886    \n",
       "\n",
       "                                        Назначение ЗУ  \\\n",
       "61  Земельный участок для размещения автостоянок и...   \n",
       "\n",
       "                               Описание назначения ЗУ Площадь ЗУ, кв.м  \\\n",
       "61  Строительство и обслуживание открытой охраняем...          16520.0   \n",
       "\n",
       "   Уникальный номер АТЕ   Маркеры Дата проведения обследования КС / РХ  \\\n",
       "61              17030.0  Комплекс                                  NaN   \n",
       "\n",
       "   Объем КС, куб.м / РХ Общая площадь жилых помещений КС, кв.м / РХ  \\\n",
       "61                  NaN                                         NaN   \n",
       "\n",
       "   Общая площадь нежилых помещений КС, кв.м / РХ  \\\n",
       "61                                           NaN   \n",
       "\n",
       "   Количество изолированных помещений (квартир) КС / РХ  \\\n",
       "61                                                NaN     \n",
       "\n",
       "   Физический износ на дату обследования КС, % / РХ  \\\n",
       "61                                              NaN   \n",
       "\n",
       "   Наличие холодного водоснабжения КС / РХ  \\\n",
       "61                                     NaN   \n",
       "\n",
       "   Наличие горячего водоснабжения КС / РХ Наличие канализации КС / РХ  \\\n",
       "61                                    NaN                         NaN   \n",
       "\n",
       "   Наличие отопления КС / РХ Наличие газоснабжения КС / РХ  \\\n",
       "61                       NaN                           NaN   \n",
       "\n",
       "   Наличие электроснабжения КС / РХ Наличие ванн (душей) КС / РХ  \\\n",
       "61                              NaN                          NaN   \n",
       "\n",
       "   Наличие напольных электроплит КС / РХ Материал  крыши (кровли) КС / РХ  \\\n",
       "61                                   NaN                              NaN   \n",
       "\n",
       "   Материал фундамента КС / РХ Материал перекрытий КС / РХ Стоимости КС / РХ  \\\n",
       "61                         NaN                         NaN               NaN   \n",
       "\n",
       "    sheet_source                                       search_param  \\\n",
       "61  РБ админ NEW  Здание административно-хозяйственное; \\nАдмини...   \n",
       "\n",
       "   Распределение долей до сделки Распределение долей после сделки  \\\n",
       "61                           NaN                              NaN   \n",
       "\n",
       "    Исходная цена Исходная валюта  п/п floor category  for_clusters_gr  \n",
       "61            NaN             NaN  NaN   1.0     None               -1  "
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_wd_filter[total_df_wd_filter[\"Инвентарный номер\"] == \"500/D-7023057\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "7fa701c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_wd_filter[\"Name NP\"] = total_df_wd_filter.apply(\n",
    "    lambda row: find_geo_object(row, df_cluster, \"Name NP\"), axis=1\n",
    ").fillna(\"-1\")\n",
    "total_df_wd_filter[\"Name region\"] = total_df_wd_filter.apply(\n",
    "    lambda row: find_geo_object(row, df_cluster, \"Name region\"), axis=1\n",
    ").fillna(\"-1\")\n",
    "total_df_wd_filter[\"Name oblast\"] = total_df_wd_filter.apply(\n",
    "    lambda row: find_geo_object(row, df_cluster, \"Name oblast\"), axis=1\n",
    ").fillna(\"-1\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "676d23b9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <th>Адрес</th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Описание назначения</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <th>Материал стен</th>\n",
       "      <th>Дата ввода</th>\n",
       "      <th>Дата консервации</th>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <th>Тип цены</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Валюта по договору</th>\n",
       "      <th>Переходящая доля</th>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <th>Назначение КС</th>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <th>Наименование КС</th>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <th>Маркеры</th>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>search_param</th>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <th>Исходная цена</th>\n",
       "      <th>Исходная валюта</th>\n",
       "      <th>п/п</th>\n",
       "      <th>floor</th>\n",
       "      <th>category</th>\n",
       "      <th>for_clusters_gr</th>\n",
       "      <th>Name NP</th>\n",
       "      <th>Name region</th>\n",
       "      <th>Name oblast</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-7023057</td>\n",
       "      <td>г. Минск, ул. Почтовая, 20/5-105</td>\n",
       "      <td>Помещение транспортного назначения</td>\n",
       "      <td>Помещение транспортного назначения</td>\n",
       "      <td>Гараж 105</td>\n",
       "      <td>43.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2006-10-08 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>07.04.2022</td>\n",
       "      <td>07.04.2022</td>\n",
       "      <td>57406859-комплекс</td>\n",
       "      <td>2</td>\n",
       "      <td>12500.0</td>\n",
       "      <td>286.04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4242.18</td>\n",
       "      <td>97.08</td>\n",
       "      <td>3883.8</td>\n",
       "      <td>88.87</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>12500.0</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>500/C-45423</td>\n",
       "      <td>1960.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное автомобильного транс...</td>\n",
       "      <td>Здание специализированное автомобильного транс...</td>\n",
       "      <td>Здание специализированное автомобильного транс...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000009000886</td>\n",
       "      <td>Земельный участок для размещения автостоянок и...</td>\n",
       "      <td>Строительство и обслуживание открытой охраняем...</td>\n",
       "      <td>16520.0</td>\n",
       "      <td>17030.0</td>\n",
       "      <td>Комплекс</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>None</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Тип недвижимого имущества Инвентарный номер  \\\n",
       "61   Изолированное помещение     500/D-7023057   \n",
       "\n",
       "                               Адрес                          Назначение  \\\n",
       "61  г. Минск, ул. Почтовая, 20/5-105  Помещение транспортного назначения   \n",
       "\n",
       "                   Описание назначения Наименование Общая площадь, кв.м  \\\n",
       "61  Помещение транспортного назначения    Гараж 105                43.7   \n",
       "\n",
       "   Жилая площадь, кв.м Материал стен           Дата ввода Дата консервации  \\\n",
       "61                 NaN        Кирпич  2006-10-08 00:00:00              NaN   \n",
       "\n",
       "   Дата реконструкции (реставрации, капитального ремонта) Дата сделки  \\\n",
       "61                                                NaN      07.04.2022   \n",
       "\n",
       "   Дата регистрации договора Идентификатор сделки  \\\n",
       "61                07.04.2022    57406859-комплекс   \n",
       "\n",
       "   Количество объектов в сделке Цена в бел. руб. Цена в бел. руб. за кв.м  \\\n",
       "61                            2          12500.0                   286.04   \n",
       "\n",
       "   Описание цены Цена в долларах США Цена в долларах США за кв.м Цена в евро  \\\n",
       "61           NaN             4242.18                       97.08      3883.8   \n",
       "\n",
       "   Цена в евро за кв.м      Тип цены Цена по договору Валюта по договору  \\\n",
       "61               88.87  Цена объекта          12500.0                BYN   \n",
       "\n",
       "   Переходящая доля Количество комнат ИП Этаж расположения ИП  \\\n",
       "61              1/1                  NaN                  1-й   \n",
       "\n",
       "   Инвентарный номер КС Общая площадь КС, кв.м Жилая площадь КС, кв.м  \\\n",
       "61          500/C-45423                 1960.3                    NaN   \n",
       "\n",
       "                                        Назначение КС  \\\n",
       "61  Здание специализированное автомобильного транс...   \n",
       "\n",
       "                               Описание назначения КС  \\\n",
       "61  Здание специализированное автомобильного транс...   \n",
       "\n",
       "                                      Наименование КС Процент готовности КС  \\\n",
       "61  Здание специализированное автомобильного транс...                   NaN   \n",
       "\n",
       "   Количество надземных этажей, шт. Количество подземных этажей, шт.  \\\n",
       "61                              1.0                              1.0   \n",
       "\n",
       "   Составные элементы и принадлежности Кадастровый номер ЗУ  \\\n",
       "61                                 NaN  500000000009000886    \n",
       "\n",
       "                                        Назначение ЗУ  \\\n",
       "61  Земельный участок для размещения автостоянок и...   \n",
       "\n",
       "                               Описание назначения ЗУ Площадь ЗУ, кв.м  \\\n",
       "61  Строительство и обслуживание открытой охраняем...          16520.0   \n",
       "\n",
       "   Уникальный номер АТЕ   Маркеры Дата проведения обследования КС / РХ  \\\n",
       "61              17030.0  Комплекс                                  NaN   \n",
       "\n",
       "   Объем КС, куб.м / РХ Общая площадь жилых помещений КС, кв.м / РХ  \\\n",
       "61                  NaN                                         NaN   \n",
       "\n",
       "   Общая площадь нежилых помещений КС, кв.м / РХ  \\\n",
       "61                                           NaN   \n",
       "\n",
       "   Количество изолированных помещений (квартир) КС / РХ  \\\n",
       "61                                                NaN     \n",
       "\n",
       "   Физический износ на дату обследования КС, % / РХ  \\\n",
       "61                                              NaN   \n",
       "\n",
       "   Наличие холодного водоснабжения КС / РХ  \\\n",
       "61                                     NaN   \n",
       "\n",
       "   Наличие горячего водоснабжения КС / РХ Наличие канализации КС / РХ  \\\n",
       "61                                    NaN                         NaN   \n",
       "\n",
       "   Наличие отопления КС / РХ Наличие газоснабжения КС / РХ  \\\n",
       "61                       NaN                           NaN   \n",
       "\n",
       "   Наличие электроснабжения КС / РХ Наличие ванн (душей) КС / РХ  \\\n",
       "61                              NaN                          NaN   \n",
       "\n",
       "   Наличие напольных электроплит КС / РХ Материал  крыши (кровли) КС / РХ  \\\n",
       "61                                   NaN                              NaN   \n",
       "\n",
       "   Материал фундамента КС / РХ Материал перекрытий КС / РХ Стоимости КС / РХ  \\\n",
       "61                         NaN                         NaN               NaN   \n",
       "\n",
       "    sheet_source                                       search_param  \\\n",
       "61  РБ админ NEW  Здание административно-хозяйственное; \\nАдмини...   \n",
       "\n",
       "   Распределение долей до сделки Распределение долей после сделки  \\\n",
       "61                           NaN                              NaN   \n",
       "\n",
       "    Исходная цена Исходная валюта  п/п floor category  for_clusters_gr  \\\n",
       "61            NaN             NaN  NaN   1.0     None               -1   \n",
       "\n",
       "   Name NP Name region Name oblast  \n",
       "61      -1          -1          -1  "
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_wd_filter[total_df_wd_filter[\"Инвентарный номер\"] == \"500/D-7023057\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "56cb6778",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Clusters borders: \n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Klaster</th>\n",
       "      <th>for_clusters_gr</th>\n",
       "      <th>min</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>F</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>E</td>\n",
       "      <td>0</td>\n",
       "      <td>23</td>\n",
       "      <td>34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>D</td>\n",
       "      <td>0</td>\n",
       "      <td>35</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>C</td>\n",
       "      <td>0</td>\n",
       "      <td>56</td>\n",
       "      <td>87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>B</td>\n",
       "      <td>0</td>\n",
       "      <td>96</td>\n",
       "      <td>116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>F</td>\n",
       "      <td>1</td>\n",
       "      <td>67</td>\n",
       "      <td>119</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>E</td>\n",
       "      <td>1</td>\n",
       "      <td>120</td>\n",
       "      <td>187</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>D</td>\n",
       "      <td>1</td>\n",
       "      <td>191</td>\n",
       "      <td>290</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>C</td>\n",
       "      <td>1</td>\n",
       "      <td>314</td>\n",
       "      <td>403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>B</td>\n",
       "      <td>1</td>\n",
       "      <td>438</td>\n",
       "      <td>558</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Klaster  for_clusters_gr  min  max\n",
       "0       F                0   11   22\n",
       "1       E                0   23   34\n",
       "2       D                0   35   49\n",
       "3       C                0   56   87\n",
       "4       B                0   96  116\n",
       "5       F                1   67  119\n",
       "6       E                1  120  187\n",
       "7       D                1  191  290\n",
       "8       C                1  314  403\n",
       "9       B                1  438  558"
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Определяем границы кластеров\n",
    "borders = (\n",
    "    df_cluster.loc[\n",
    "        ~(\n",
    "            (df_cluster[\"Name region\"] == \"-1\")\n",
    "            & (df_cluster[\"Name oblast\"] == \"-1\")\n",
    "        )\n",
    "    ]\n",
    "    .groupby(by=[\"Klaster\", \"for_clusters_gr\"], as_index=False)\n",
    "    .agg(min=(\"балл развития\", \"min\"), max=(\"балл развития\", \"max\"))\n",
    "    .sort_values(by=[\"for_clusters_gr\", \"min\"])\n",
    "    .reset_index(drop=True)\n",
    ")\n",
    "\n",
    "print(\"Clusters borders: \")\n",
    "borders"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bbe840d6",
   "metadata": {},
   "source": [
    "Осуществляем кластеризацию каскадом.  \n",
    "Общая логика:\n",
    "\n",
    "1. Маппим по \"населенный пункт\", \"район\", \"область\"\n",
    "2. Для неопределившихся на предыдущем шаге маппим по \"район\", \"область\" (балл берем как медиану, кластер определяем по медианному балу и границам, определенным на пред. шаге)\n",
    "3. Для неопределившихся на предыдущем шаге маппим по \"область\" (логика баллов и кластеров аналогична пред. пункту)\n",
    "4. (Костыль) для оставшихся маппим по \"населенный пункт\" (кейсы, когда указан в адресе город, но нет района/области)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "9c852f66",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Выделяем кластеры с уровня \"регион-область\", 'область'\n",
    "def define_cluster(row, borders):\n",
    "    cluster = row[\"for_clusters_gr\"]\n",
    "    value = row[\"балл развития\"]\n",
    "    if cluster in [0, 1] and (value is not None):\n",
    "        borders = borders.loc[borders[\"for_clusters_gr\"] == cluster]\n",
    "        for _, rows in borders.iterrows():\n",
    "            if (value >= rows[\"min\"]) and (value <= rows[\"max\"]):\n",
    "                return rows[\"Klaster\"]\n",
    "    else:\n",
    "        return None\n",
    "\n",
    "\n",
    "df_cluster_region_oblast = (\n",
    "    df_cluster.loc[\n",
    "        ~(\n",
    "            (df_cluster[\"Name region\"] == \"-1\")\n",
    "            & (df_cluster[\"Name oblast\"] == \"-1\")\n",
    "        )\n",
    "    ]\n",
    "    .groupby(\n",
    "        by=[\"Name region\", \"Name oblast\", \"for_clusters_gr\"], as_index=False\n",
    "    )\n",
    "    .agg(балл_развития=(\"балл развития\", \"median\"))\n",
    "    .reset_index(drop=True)\n",
    "    .rename(columns={\"балл_развития\": \"балл развития\"})\n",
    "    .assign(\n",
    "        Klaster=lambda df: df.apply(\n",
    "            lambda row: define_cluster(row, borders), axis=1\n",
    "        )\n",
    "    )\n",
    ")\n",
    "\n",
    "df_cluster_oblast = (\n",
    "    df_cluster.loc[~(df_cluster[\"Name oblast\"] == \"-1\")]\n",
    "    .groupby(by=[\"Name oblast\", \"for_clusters_gr\"], as_index=False)\n",
    "    .agg(балл_развития=(\"балл развития\", \"median\"))\n",
    "    .reset_index(drop=True)\n",
    "    .rename(columns={\"балл_развития\": \"балл развития\"})\n",
    "    .assign(\n",
    "        Klaster=lambda df: df.apply(\n",
    "            lambda row: define_cluster(row, borders), axis=1\n",
    "        )\n",
    "    )\n",
    ")\n",
    "\n",
    "# Костыль, для особых оставшихся случаев\n",
    "df_cluster_NP = df_cluster.sort_values(\n",
    "    by=[\"Name NP\", \"for_clusters_gr\", \"балл развития\"],\n",
    "    ascending=[True, True, False],\n",
    ").drop_duplicates(subset=[\"Name NP\", \"for_clusters_gr\"])[\n",
    "    [\"Name NP\", \"for_clusters_gr\", \"балл развития\", \"Klaster\"]\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "c7cbe6de",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total_df_wd_filter.drop(columns=['Klaster_0', 'Klaster_1', 'Klaster_2', 'Klaster_3', 'балл_развития_0', 'балл_развития_1', 'балл_развития_2', 'балл_развития_3'], inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "caefe69f",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_wd_filter = (\n",
    "    total_df_wd_filter.merge(\n",
    "        df_cluster[\n",
    "            [\n",
    "                \"Name NP\",\n",
    "                \"Name region\",\n",
    "                \"Name oblast\",\n",
    "                \"балл развития\",\n",
    "                \"Klaster\",\n",
    "                \"for_clusters_gr\",\n",
    "            ]\n",
    "        ].rename(\n",
    "            columns={\"Klaster\": \"Klaster_0\", \"балл развития\": \"балл_развития_0\"}\n",
    "        ),\n",
    "        how=\"left\",\n",
    "        on=[\"Name NP\", \"Name region\", \"Name oblast\", \"for_clusters_gr\"],\n",
    "    )\n",
    "    .merge(\n",
    "        df_cluster_region_oblast[\n",
    "            [\n",
    "                \"Name region\",\n",
    "                \"Name oblast\",\n",
    "                \"балл развития\",\n",
    "                \"Klaster\",\n",
    "                \"for_clusters_gr\",\n",
    "            ]\n",
    "        ].rename(\n",
    "            columns={\"Klaster\": \"Klaster_1\", \"балл развития\": \"балл_развития_1\"}\n",
    "        ),\n",
    "        how=\"left\",\n",
    "        on=[\"Name region\", \"Name oblast\", \"for_clusters_gr\"],\n",
    "    )\n",
    "    .merge(\n",
    "        df_cluster_oblast[\n",
    "            [\"Name oblast\", \"балл развития\", \"Klaster\", \"for_clusters_gr\"]\n",
    "        ].rename(\n",
    "            columns={\"Klaster\": \"Klaster_2\", \"балл развития\": \"балл_развития_2\"}\n",
    "        ),\n",
    "        how=\"left\",\n",
    "        on=[\"Name oblast\", \"for_clusters_gr\"],\n",
    "    )\n",
    "    .merge(\n",
    "        df_cluster_NP[\n",
    "            [\"Name NP\", \"балл развития\", \"Klaster\", \"for_clusters_gr\"]\n",
    "        ].rename(\n",
    "            columns={\"Klaster\": \"Klaster_3\", \"балл развития\": \"балл_развития_3\"}\n",
    "        ),\n",
    "        how=\"left\",\n",
    "        on=[\"Name NP\", \"for_clusters_gr\"],\n",
    "    )\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "51d4b754",
   "metadata": {},
   "outputs": [],
   "source": [
    "def define_total_score(row):\n",
    "\n",
    "    if (row[\"балл_развития_0\"] is not None) and (\n",
    "        pd.notna(row[\"балл_развития_0\"])\n",
    "    ):\n",
    "        return row[\"балл_развития_0\"]\n",
    "    elif (row[\"балл_развития_1\"] is not None) and (\n",
    "        pd.notna(row[\"балл_развития_1\"])\n",
    "    ):\n",
    "        return row[\"балл_развития_1\"]\n",
    "    elif (row[\"балл_развития_2\"] is not None) and (\n",
    "        pd.notna(row[\"балл_развития_2\"])\n",
    "    ):\n",
    "        return row[\"балл_развития_2\"]\n",
    "    elif (row[\"балл_развития_3\"] is not None) and (\n",
    "        pd.notna(row[\"балл_развития_3\"])\n",
    "    ):\n",
    "        return row[\"балл_развития_3\"]\n",
    "\n",
    "    else:\n",
    "        return None\n",
    "\n",
    "\n",
    "def define_total_cluster(row):\n",
    "\n",
    "    if (row[\"Klaster_0\"] is not None) and (pd.notna(row[\"Klaster_0\"])):\n",
    "        return row[\"Klaster_0\"]\n",
    "    elif (row[\"Klaster_1\"] is not None) and (pd.notna(row[\"Klaster_1\"])):\n",
    "        return row[\"Klaster_1\"]\n",
    "    elif (row[\"Klaster_2\"] is not None) and (pd.notna(row[\"Klaster_2\"])):\n",
    "        return row[\"Klaster_2\"]\n",
    "    elif (row[\"Klaster_3\"] is not None) and (pd.notna(row[\"Klaster_3\"])):\n",
    "        return row[\"Klaster_3\"]\n",
    "    else:\n",
    "        return None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "5dc27c4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_wd_filter[\"cluster_score\"] = total_df_wd_filter.apply(\n",
    "    lambda row: define_total_score(row), axis=1\n",
    ")\n",
    "total_df_wd_filter[\"cluster\"] = total_df_wd_filter.apply(\n",
    "    lambda row: define_total_cluster(row), axis=1\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "18e058c1",
   "metadata": {},
   "source": [
    "Филлим для неподвязанных кейсов -1 для скора, 'undef' для кластеров\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "c65d765d",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_wd_filter[\"cluster_score\"] = total_df_wd_filter[\n",
    "    \"cluster_score\"\n",
    "].fillna(-1)\n",
    "total_df_wd_filter[\"cluster\"] = total_df_wd_filter[\"cluster\"].fillna(\"undef\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "94724f4e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "cluster\n",
       "A        5011\n",
       "B        4477\n",
       "E        3216\n",
       "C        2952\n",
       "undef    2406\n",
       "D        2387\n",
       "F        1644\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_wd_filter[\"cluster\"].value_counts(dropna=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "42b780be",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Убираем промежуточные данные\n",
    "total_df_wd_filter.drop(\n",
    "    columns=[\n",
    "        \"Klaster_0\",\n",
    "        \"Klaster_1\",\n",
    "        \"Klaster_2\",\n",
    "        \"Klaster_3\",\n",
    "        \"балл_развития_0\",\n",
    "        \"балл_развития_1\",\n",
    "        \"балл_развития_2\",\n",
    "        \"балл_развития_3\",\n",
    "    ],\n",
    "    inplace=True,\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "id": "58f95fa2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(22093, 78)"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_wd_filter.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "d9e38683",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total_df_wd_filter.loc[(pd.isna(total_df_wd_filter['cluster'])) & (total_df_wd_filter['for_clusters_gr'] != -1)]#.shape#.loc[8709, 'Адрес']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "id": "b7ae9a41",
   "metadata": {},
   "outputs": [],
   "source": [
    "# data = total_df_wd_filter[['Адрес', 'for_clusters_gr', 'Name NP', 'Name region', 'Name oblast']]\n",
    "# data.loc[(data['Name NP'] == '-1') & (data['Name region'] == '-1') & (data['Name oblast'] == '-1') & (data['for_clusters_gr'] != -1)]#.iloc[0,0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "c80ca8ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "# industry_df_wd_filter = total_df_wd_filter.loc[total_df_wd_filter['category'].isin(['склад', 'производство', 'сельхоз', 'сто'])]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0812e678",
   "metadata": {},
   "source": [
    "## Проверка на пустые значения\n",
    "\n",
    "---\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "id": "9f04a897",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total_df_wd_filter_test = total_df_wd_filter.loc[~pd.isna(total_df_wd_filter['category'])]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "a0d03688",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>dtype</th>\n",
       "      <th>nunique</th>\n",
       "      <th>nunique_%</th>\n",
       "      <th>Nulls</th>\n",
       "      <th>Nulls_%</th>\n",
       "      <th>min</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>22093</td>\n",
       "      <td>100.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Дата консервации</th>\n",
       "      <td>object</td>\n",
       "      <td>3</td>\n",
       "      <td>0.01</td>\n",
       "      <td>22089</td>\n",
       "      <td>99.98</td>\n",
       "      <td>NaN</td>\n",
       "      <td>24.03.2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>п/п</th>\n",
       "      <td>float64</td>\n",
       "      <td>35</td>\n",
       "      <td>0.16</td>\n",
       "      <td>22053</td>\n",
       "      <td>99.82</td>\n",
       "      <td>1.0</td>\n",
       "      <td>258.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <td>object</td>\n",
       "      <td>199</td>\n",
       "      <td>0.90</td>\n",
       "      <td>21598</td>\n",
       "      <td>97.76</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26.03.2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>7</td>\n",
       "      <td>0.03</td>\n",
       "      <td>21546</td>\n",
       "      <td>97.52</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <td>object</td>\n",
       "      <td>23</td>\n",
       "      <td>0.10</td>\n",
       "      <td>21350</td>\n",
       "      <td>96.64</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Исходная валюта</th>\n",
       "      <td>object</td>\n",
       "      <td>4</td>\n",
       "      <td>0.02</td>\n",
       "      <td>21339</td>\n",
       "      <td>96.59</td>\n",
       "      <td>NaN</td>\n",
       "      <td>евро</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Исходная цена</th>\n",
       "      <td>float64</td>\n",
       "      <td>308</td>\n",
       "      <td>1.39</td>\n",
       "      <td>21322</td>\n",
       "      <td>96.51</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15879333442.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>20871</td>\n",
       "      <td>94.47</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>98</td>\n",
       "      <td>0.44</td>\n",
       "      <td>20352</td>\n",
       "      <td>92.12</td>\n",
       "      <td>NaN</td>\n",
       "      <td>311</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>324</td>\n",
       "      <td>1.47</td>\n",
       "      <td>20150</td>\n",
       "      <td>91.21</td>\n",
       "      <td>NaN</td>\n",
       "      <td>378.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>2</td>\n",
       "      <td>0.01</td>\n",
       "      <td>19825</td>\n",
       "      <td>89.73</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Есть</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>1395</td>\n",
       "      <td>6.31</td>\n",
       "      <td>19687</td>\n",
       "      <td>89.11</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.03.2012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>80</td>\n",
       "      <td>0.36</td>\n",
       "      <td>19677</td>\n",
       "      <td>89.06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Биде,Душевая кабина,Мойка,Умывальник (раковина...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>6</td>\n",
       "      <td>0.03</td>\n",
       "      <td>19600</td>\n",
       "      <td>88.72</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Локальная система</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>5</td>\n",
       "      <td>0.02</td>\n",
       "      <td>19569</td>\n",
       "      <td>88.58</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нет сведений</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>75</td>\n",
       "      <td>0.34</td>\n",
       "      <td>19544</td>\n",
       "      <td>88.46</td>\n",
       "      <td>NaN</td>\n",
       "      <td>72.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>6</td>\n",
       "      <td>0.03</td>\n",
       "      <td>19502</td>\n",
       "      <td>88.27</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Централизованная</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>156</td>\n",
       "      <td>0.71</td>\n",
       "      <td>19483</td>\n",
       "      <td>88.19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7807.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>6</td>\n",
       "      <td>0.03</td>\n",
       "      <td>19483</td>\n",
       "      <td>88.19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Централизованная</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>69</td>\n",
       "      <td>0.31</td>\n",
       "      <td>19477</td>\n",
       "      <td>88.16</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Котел на твердом топливе,Теплый пол</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>76</td>\n",
       "      <td>0.34</td>\n",
       "      <td>19444</td>\n",
       "      <td>88.01</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Деревянные изделия,Металлические изделия</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>1889</td>\n",
       "      <td>8.55</td>\n",
       "      <td>19439</td>\n",
       "      <td>87.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>58097</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>6</td>\n",
       "      <td>0.03</td>\n",
       "      <td>19408</td>\n",
       "      <td>87.85</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Локальная система</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>109</td>\n",
       "      <td>0.49</td>\n",
       "      <td>19405</td>\n",
       "      <td>87.83</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Стекло</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <td>object</td>\n",
       "      <td>67</td>\n",
       "      <td>0.30</td>\n",
       "      <td>19405</td>\n",
       "      <td>87.83</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Железобетон,Кирпичи</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <td>object</td>\n",
       "      <td>4</td>\n",
       "      <td>0.02</td>\n",
       "      <td>16161</td>\n",
       "      <td>73.15</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Описание цены</th>\n",
       "      <td>object</td>\n",
       "      <td>3317</td>\n",
       "      <td>15.01</td>\n",
       "      <td>13853</td>\n",
       "      <td>62.70</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.55556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <td>object</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>12345</td>\n",
       "      <td>55.88</td>\n",
       "      <td>NaN</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <td>object</td>\n",
       "      <td>133</td>\n",
       "      <td>0.60</td>\n",
       "      <td>12334</td>\n",
       "      <td>55.83</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{747/10000,2077/5000,3149/10000,527/5000,56/625}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <td>object</td>\n",
       "      <td>119</td>\n",
       "      <td>0.54</td>\n",
       "      <td>12334</td>\n",
       "      <td>55.83</td>\n",
       "      <td>NaN</td>\n",
       "      <td>{6/25,19/25}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>floor</th>\n",
       "      <td>object</td>\n",
       "      <td>30</td>\n",
       "      <td>0.14</td>\n",
       "      <td>10776</td>\n",
       "      <td>48.78</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <td>object</td>\n",
       "      <td>36</td>\n",
       "      <td>0.16</td>\n",
       "      <td>10775</td>\n",
       "      <td>48.77</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Техническое подполье</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <td>object</td>\n",
       "      <td>3945</td>\n",
       "      <td>17.86</td>\n",
       "      <td>9992</td>\n",
       "      <td>45.23</td>\n",
       "      <td>NaN</td>\n",
       "      <td>для строительства и обслуживания здания и соор...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <td>object</td>\n",
       "      <td>1380</td>\n",
       "      <td>6.25</td>\n",
       "      <td>9759</td>\n",
       "      <td>44.17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>02.08.2025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Переходящая доля</th>\n",
       "      <td>object</td>\n",
       "      <td>180</td>\n",
       "      <td>0.81</td>\n",
       "      <td>9759</td>\n",
       "      <td>44.17</td>\n",
       "      <td>1/1</td>\n",
       "      <td>14/25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Тип цены</th>\n",
       "      <td>object</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>9759</td>\n",
       "      <td>44.17</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <td>object</td>\n",
       "      <td>7129</td>\n",
       "      <td>32.27</td>\n",
       "      <td>8307</td>\n",
       "      <td>37.60</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Пристройка (лит. 1), два крыльца, сарай (лит. ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Маркеры</th>\n",
       "      <td>object</td>\n",
       "      <td>1125</td>\n",
       "      <td>5.09</td>\n",
       "      <td>7716</td>\n",
       "      <td>34.93</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Транзит, Δ цены: 12.46%</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Дата ввода</th>\n",
       "      <td>object</td>\n",
       "      <td>3094</td>\n",
       "      <td>14.00</td>\n",
       "      <td>2664</td>\n",
       "      <td>12.06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26.05.2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>category</th>\n",
       "      <td>object</td>\n",
       "      <td>6</td>\n",
       "      <td>0.03</td>\n",
       "      <td>2397</td>\n",
       "      <td>10.85</td>\n",
       "      <td>офис</td>\n",
       "      <td>сто</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Описание назначения</th>\n",
       "      <td>object</td>\n",
       "      <td>641</td>\n",
       "      <td>2.90</td>\n",
       "      <td>1791</td>\n",
       "      <td>8.11</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Здание хозяйственного блока</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <td>object</td>\n",
       "      <td>649</td>\n",
       "      <td>2.94</td>\n",
       "      <td>1388</td>\n",
       "      <td>6.28</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание хозяйственного блока</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Валюта по договору</th>\n",
       "      <td>object</td>\n",
       "      <td>11</td>\n",
       "      <td>0.05</td>\n",
       "      <td>890</td>\n",
       "      <td>4.03</td>\n",
       "      <td>BYN</td>\n",
       "      <td>BYR</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <td>object</td>\n",
       "      <td>1948</td>\n",
       "      <td>8.82</td>\n",
       "      <td>794</td>\n",
       "      <td>3.59</td>\n",
       "      <td>17030.0</td>\n",
       "      <td>21731</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Цена по договору</th>\n",
       "      <td>object</td>\n",
       "      <td>9752</td>\n",
       "      <td>44.14</td>\n",
       "      <td>790</td>\n",
       "      <td>3.58</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40325.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <td>object</td>\n",
       "      <td>67</td>\n",
       "      <td>0.30</td>\n",
       "      <td>374</td>\n",
       "      <td>1.69</td>\n",
       "      <td>Земельный участок для размещения объектов иног...</td>\n",
       "      <td>Земельный участок для размещения объектов топл...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <td>object</td>\n",
       "      <td>30</td>\n",
       "      <td>0.14</td>\n",
       "      <td>333</td>\n",
       "      <td>1.51</td>\n",
       "      <td>1.0</td>\n",
       "      <td>-1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Материал стен</th>\n",
       "      <td>object</td>\n",
       "      <td>33</td>\n",
       "      <td>0.15</td>\n",
       "      <td>245</td>\n",
       "      <td>1.11</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>Камень природный</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наименование КС</th>\n",
       "      <td>object</td>\n",
       "      <td>6196</td>\n",
       "      <td>28.05</td>\n",
       "      <td>168</td>\n",
       "      <td>0.76</td>\n",
       "      <td>Многоквартирный жилой дом</td>\n",
       "      <td>здание продовольственного магазина</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>15977</td>\n",
       "      <td>72.32</td>\n",
       "      <td>148</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.0</td>\n",
       "      <td>695.953932</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>15382</td>\n",
       "      <td>69.62</td>\n",
       "      <td>148</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.0</td>\n",
       "      <td>760.171564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Назначение КС</th>\n",
       "      <td>object</td>\n",
       "      <td>60</td>\n",
       "      <td>0.27</td>\n",
       "      <td>148</td>\n",
       "      <td>0.67</td>\n",
       "      <td>Здание специализированное складов, торговых ба...</td>\n",
       "      <td>Здание специализированное для добычи и перераб...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Цена в евро</th>\n",
       "      <td>object</td>\n",
       "      <td>17688</td>\n",
       "      <td>80.06</td>\n",
       "      <td>145</td>\n",
       "      <td>0.66</td>\n",
       "      <td>NaN</td>\n",
       "      <td>32501.048628</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <td>object</td>\n",
       "      <td>15546</td>\n",
       "      <td>70.37</td>\n",
       "      <td>145</td>\n",
       "      <td>0.66</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35500.012048</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>17247</td>\n",
       "      <td>78.07</td>\n",
       "      <td>141</td>\n",
       "      <td>0.64</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2239.920771</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <td>object</td>\n",
       "      <td>11804</td>\n",
       "      <td>53.43</td>\n",
       "      <td>138</td>\n",
       "      <td>0.62</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>104604.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>5822</td>\n",
       "      <td>26.35</td>\n",
       "      <td>109</td>\n",
       "      <td>0.49</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3115.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <td>object</td>\n",
       "      <td>10214</td>\n",
       "      <td>46.23</td>\n",
       "      <td>56</td>\n",
       "      <td>0.25</td>\n",
       "      <td>623688000001000404</td>\n",
       "      <td>500000000009004672.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>search_param</th>\n",
       "      <td>object</td>\n",
       "      <td>34</td>\n",
       "      <td>0.15</td>\n",
       "      <td>40</td>\n",
       "      <td>0.18</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>Помещение многофункциональное, Здание многофун...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <td>object</td>\n",
       "      <td>12720</td>\n",
       "      <td>57.57</td>\n",
       "      <td>11</td>\n",
       "      <td>0.05</td>\n",
       "      <td>600/C-130210</td>\n",
       "      <td>614/C-37814</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>8803</td>\n",
       "      <td>39.85</td>\n",
       "      <td>11</td>\n",
       "      <td>0.05</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2763.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Наименование</th>\n",
       "      <td>object</td>\n",
       "      <td>7136</td>\n",
       "      <td>32.30</td>\n",
       "      <td>10</td>\n",
       "      <td>0.05</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>здание хозяйственного блока</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <td>object</td>\n",
       "      <td>19021</td>\n",
       "      <td>86.10</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>350/D-279535</td>\n",
       "      <td>614/C-37814</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Адрес</th>\n",
       "      <td>object</td>\n",
       "      <td>18590</td>\n",
       "      <td>84.14</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Гомельская обл., Жлобинский р-н, д. Солоное, у...</td>\n",
       "      <td>Минская обл., Смолевичский р-н, Усяжский с/с, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <td>object</td>\n",
       "      <td>17975</td>\n",
       "      <td>81.36</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>69745428-комплекс</td>\n",
       "      <td>80624161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <td>object</td>\n",
       "      <td>6819</td>\n",
       "      <td>30.86</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>23.5</td>\n",
       "      <td>823.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Дата сделки</th>\n",
       "      <td>object</td>\n",
       "      <td>2214</td>\n",
       "      <td>10.02</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>19.04.2024</td>\n",
       "      <td>2021-12-12 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>cluster_score</th>\n",
       "      <td>float64</td>\n",
       "      <td>220</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>1027.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Name NP</th>\n",
       "      <td>object</td>\n",
       "      <td>194</td>\n",
       "      <td>0.88</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>-1</td>\n",
       "      <td>брагин</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Name region</th>\n",
       "      <td>object</td>\n",
       "      <td>119</td>\n",
       "      <td>0.54</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>-1</td>\n",
       "      <td>краснопольский</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Назначение</th>\n",
       "      <td>object</td>\n",
       "      <td>63</td>\n",
       "      <td>0.29</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Здание специализированное научно-исследователь...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>sheet_source</th>\n",
       "      <td>object</td>\n",
       "      <td>52</td>\n",
       "      <td>0.24</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Боровляны</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <td>object</td>\n",
       "      <td>45</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Name oblast</th>\n",
       "      <td>object</td>\n",
       "      <td>7</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>-1</td>\n",
       "      <td>могилевская</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>cluster</th>\n",
       "      <td>object</td>\n",
       "      <td>7</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>A</td>\n",
       "      <td>F</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>for_clusters_gr</th>\n",
       "      <td>int64</td>\n",
       "      <td>3</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>-1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <td>object</td>\n",
       "      <td>2</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>Капитальное строение</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                      dtype  nunique  \\\n",
       "Жилая площадь КС, кв.м                               object        0   \n",
       "Дата консервации                                     object        3   \n",
       "п/п                                                 float64       35   \n",
       "Дата реконструкции (реставрации, капитального р...   object      199   \n",
       "Стоимости КС / РХ                                    object        7   \n",
       "Количество комнат ИП                                 object       23   \n",
       "Исходная валюта                                      object        4   \n",
       "Исходная цена                                       float64      308   \n",
       "Жилая площадь, кв.м                                  object        1   \n",
       "Количество изолированных помещений (квартир) КС...   object       98   \n",
       "Общая площадь нежилых помещений КС, кв.м / РХ        object      324   \n",
       "Наличие напольных электроплит КС / РХ                object        2   \n",
       "Дата проведения обследования КС / РХ                 object     1395   \n",
       "Наличие ванн (душей) КС / РХ                         object       80   \n",
       "Наличие газоснабжения КС / РХ                        object        6   \n",
       "Наличие горячего водоснабжения КС / РХ               object        5   \n",
       "Физический износ на дату обследования КС, % / РХ     object       75   \n",
       "Наличие канализации КС / РХ                          object        6   \n",
       "Общая площадь жилых помещений КС, кв.м / РХ          object      156   \n",
       "Наличие холодного водоснабжения КС / РХ              object        6   \n",
       "Наличие отопления КС / РХ                            object       69   \n",
       "Материал перекрытий КС / РХ                          object       76   \n",
       "Объем КС, куб.м / РХ                                 object     1889   \n",
       "Наличие электроснабжения КС / РХ                     object        6   \n",
       "Материал  крыши (кровли) КС / РХ                     object      109   \n",
       "Материал фундамента КС / РХ                          object       67   \n",
       "Количество подземных этажей, шт.                     object        4   \n",
       "Описание цены                                        object     3317   \n",
       "Процент готовности КС                                object        1   \n",
       "Распределение долей до сделки                        object      133   \n",
       "Распределение долей после сделки                     object      119   \n",
       "floor                                                object       30   \n",
       "Этаж расположения ИП                                 object       36   \n",
       "Описание назначения ЗУ                               object     3945   \n",
       "Дата регистрации договора                            object     1380   \n",
       "Переходящая доля                                     object      180   \n",
       "Тип цены                                             object        1   \n",
       "Составные элементы и принадлежности                  object     7129   \n",
       "Маркеры                                              object     1125   \n",
       "Дата ввода                                           object     3094   \n",
       "category                                             object        6   \n",
       "Описание назначения                                  object      641   \n",
       "Описание назначения КС                               object      649   \n",
       "Валюта по договору                                   object       11   \n",
       "Уникальный номер АТЕ                                 object     1948   \n",
       "Цена по договору                                     object     9752   \n",
       "Назначение ЗУ                                        object       67   \n",
       "Количество надземных этажей, шт.                     object       30   \n",
       "Материал стен                                        object       33   \n",
       "Наименование КС                                      object     6196   \n",
       "Цена в евро за кв.м                                  object    15977   \n",
       "Цена в долларах США за кв.м                          object    15382   \n",
       "Назначение КС                                        object       60   \n",
       "Цена в евро                                          object    17688   \n",
       "Цена в долларах США                                  object    15546   \n",
       "Цена в бел. руб. за кв.м                             object    17247   \n",
       "Цена в бел. руб.                                     object    11804   \n",
       "Площадь ЗУ, кв.м                                     object     5822   \n",
       "Кадастровый номер ЗУ                                 object    10214   \n",
       "search_param                                         object       34   \n",
       "Инвентарный номер КС                                 object    12720   \n",
       "Общая площадь КС, кв.м                               object     8803   \n",
       "Наименование                                         object     7136   \n",
       "Инвентарный номер                                    object    19021   \n",
       "Адрес                                                object    18590   \n",
       "Идентификатор сделки                                 object    17975   \n",
       "Общая площадь, кв.м                                  object     6819   \n",
       "Дата сделки                                          object     2214   \n",
       "cluster_score                                       float64      220   \n",
       "Name NP                                              object      194   \n",
       "Name region                                          object      119   \n",
       "Назначение                                           object       63   \n",
       "sheet_source                                         object       52   \n",
       "Количество объектов в сделке                         object       45   \n",
       "Name oblast                                          object        7   \n",
       "cluster                                              object        7   \n",
       "for_clusters_gr                                       int64        3   \n",
       "Тип недвижимого имущества                            object        2   \n",
       "\n",
       "                                                    nunique_%  Nulls  Nulls_%  \\\n",
       "Жилая площадь КС, кв.м                                   0.00  22093   100.00   \n",
       "Дата консервации                                         0.01  22089    99.98   \n",
       "п/п                                                      0.16  22053    99.82   \n",
       "Дата реконструкции (реставрации, капитального р...       0.90  21598    97.76   \n",
       "Стоимости КС / РХ                                        0.03  21546    97.52   \n",
       "Количество комнат ИП                                     0.10  21350    96.64   \n",
       "Исходная валюта                                          0.02  21339    96.59   \n",
       "Исходная цена                                            1.39  21322    96.51   \n",
       "Жилая площадь, кв.м                                      0.00  20871    94.47   \n",
       "Количество изолированных помещений (квартир) КС...       0.44  20352    92.12   \n",
       "Общая площадь нежилых помещений КС, кв.м / РХ            1.47  20150    91.21   \n",
       "Наличие напольных электроплит КС / РХ                    0.01  19825    89.73   \n",
       "Дата проведения обследования КС / РХ                     6.31  19687    89.11   \n",
       "Наличие ванн (душей) КС / РХ                             0.36  19677    89.06   \n",
       "Наличие газоснабжения КС / РХ                            0.03  19600    88.72   \n",
       "Наличие горячего водоснабжения КС / РХ                   0.02  19569    88.58   \n",
       "Физический износ на дату обследования КС, % / РХ         0.34  19544    88.46   \n",
       "Наличие канализации КС / РХ                              0.03  19502    88.27   \n",
       "Общая площадь жилых помещений КС, кв.м / РХ              0.71  19483    88.19   \n",
       "Наличие холодного водоснабжения КС / РХ                  0.03  19483    88.19   \n",
       "Наличие отопления КС / РХ                                0.31  19477    88.16   \n",
       "Материал перекрытий КС / РХ                              0.34  19444    88.01   \n",
       "Объем КС, куб.м / РХ                                     8.55  19439    87.99   \n",
       "Наличие электроснабжения КС / РХ                         0.03  19408    87.85   \n",
       "Материал  крыши (кровли) КС / РХ                         0.49  19405    87.83   \n",
       "Материал фундамента КС / РХ                              0.30  19405    87.83   \n",
       "Количество подземных этажей, шт.                         0.02  16161    73.15   \n",
       "Описание цены                                           15.01  13853    62.70   \n",
       "Процент готовности КС                                    0.00  12345    55.88   \n",
       "Распределение долей до сделки                            0.60  12334    55.83   \n",
       "Распределение долей после сделки                         0.54  12334    55.83   \n",
       "floor                                                    0.14  10776    48.78   \n",
       "Этаж расположения ИП                                     0.16  10775    48.77   \n",
       "Описание назначения ЗУ                                  17.86   9992    45.23   \n",
       "Дата регистрации договора                                6.25   9759    44.17   \n",
       "Переходящая доля                                         0.81   9759    44.17   \n",
       "Тип цены                                                 0.00   9759    44.17   \n",
       "Составные элементы и принадлежности                     32.27   8307    37.60   \n",
       "Маркеры                                                  5.09   7716    34.93   \n",
       "Дата ввода                                              14.00   2664    12.06   \n",
       "category                                                 0.03   2397    10.85   \n",
       "Описание назначения                                      2.90   1791     8.11   \n",
       "Описание назначения КС                                   2.94   1388     6.28   \n",
       "Валюта по договору                                       0.05    890     4.03   \n",
       "Уникальный номер АТЕ                                     8.82    794     3.59   \n",
       "Цена по договору                                        44.14    790     3.58   \n",
       "Назначение ЗУ                                            0.30    374     1.69   \n",
       "Количество надземных этажей, шт.                         0.14    333     1.51   \n",
       "Материал стен                                            0.15    245     1.11   \n",
       "Наименование КС                                         28.05    168     0.76   \n",
       "Цена в евро за кв.м                                     72.32    148     0.67   \n",
       "Цена в долларах США за кв.м                             69.62    148     0.67   \n",
       "Назначение КС                                            0.27    148     0.67   \n",
       "Цена в евро                                             80.06    145     0.66   \n",
       "Цена в долларах США                                     70.37    145     0.66   \n",
       "Цена в бел. руб. за кв.м                                78.07    141     0.64   \n",
       "Цена в бел. руб.                                        53.43    138     0.62   \n",
       "Площадь ЗУ, кв.м                                        26.35    109     0.49   \n",
       "Кадастровый номер ЗУ                                    46.23     56     0.25   \n",
       "search_param                                             0.15     40     0.18   \n",
       "Инвентарный номер КС                                    57.57     11     0.05   \n",
       "Общая площадь КС, кв.м                                  39.85     11     0.05   \n",
       "Наименование                                            32.30     10     0.05   \n",
       "Инвентарный номер                                       86.10      0     0.00   \n",
       "Адрес                                                   84.14      0     0.00   \n",
       "Идентификатор сделки                                    81.36      0     0.00   \n",
       "Общая площадь, кв.м                                     30.86      0     0.00   \n",
       "Дата сделки                                             10.02      0     0.00   \n",
       "cluster_score                                            1.00      0     0.00   \n",
       "Name NP                                                  0.88      0     0.00   \n",
       "Name region                                              0.54      0     0.00   \n",
       "Назначение                                               0.29      0     0.00   \n",
       "sheet_source                                             0.24      0     0.00   \n",
       "Количество объектов в сделке                             0.20      0     0.00   \n",
       "Name oblast                                              0.03      0     0.00   \n",
       "cluster                                                  0.03      0     0.00   \n",
       "for_clusters_gr                                          0.01      0     0.00   \n",
       "Тип недвижимого имущества                                0.01      0     0.00   \n",
       "\n",
       "                                                                                                  min  \\\n",
       "Жилая площадь КС, кв.м                                                                            NaN   \n",
       "Дата консервации                                                                                  NaN   \n",
       "п/п                                                                                               1.0   \n",
       "Дата реконструкции (реставрации, капитального р...                                                NaN   \n",
       "Стоимости КС / РХ                                                                                 NaN   \n",
       "Количество комнат ИП                                                                              NaN   \n",
       "Исходная валюта                                                                                   NaN   \n",
       "Исходная цена                                                                                     0.0   \n",
       "Жилая площадь, кв.м                                                                               NaN   \n",
       "Количество изолированных помещений (квартир) КС...                                                NaN   \n",
       "Общая площадь нежилых помещений КС, кв.м / РХ                                                     NaN   \n",
       "Наличие напольных электроплит КС / РХ                                                             NaN   \n",
       "Дата проведения обследования КС / РХ                                                              NaN   \n",
       "Наличие ванн (душей) КС / РХ                                                                      NaN   \n",
       "Наличие газоснабжения КС / РХ                                                                     NaN   \n",
       "Наличие горячего водоснабжения КС / РХ                                                            NaN   \n",
       "Физический износ на дату обследования КС, % / РХ                                                  NaN   \n",
       "Наличие канализации КС / РХ                                                                       NaN   \n",
       "Общая площадь жилых помещений КС, кв.м / РХ                                                       NaN   \n",
       "Наличие холодного водоснабжения КС / РХ                                                           NaN   \n",
       "Наличие отопления КС / РХ                                                                         NaN   \n",
       "Материал перекрытий КС / РХ                                                                       NaN   \n",
       "Объем КС, куб.м / РХ                                                                              NaN   \n",
       "Наличие электроснабжения КС / РХ                                                                  NaN   \n",
       "Материал  крыши (кровли) КС / РХ                                                                  NaN   \n",
       "Материал фундамента КС / РХ                                                                       NaN   \n",
       "Количество подземных этажей, шт.                                                                  NaN   \n",
       "Описание цены                                                                                     NaN   \n",
       "Процент готовности КС                                                                             NaN   \n",
       "Распределение долей до сделки                                                                     NaN   \n",
       "Распределение долей после сделки                                                                  NaN   \n",
       "floor                                                                                             NaN   \n",
       "Этаж расположения ИП                                                                              NaN   \n",
       "Описание назначения ЗУ                                                                            NaN   \n",
       "Дата регистрации договора                                                                         NaN   \n",
       "Переходящая доля                                                                                  1/1   \n",
       "Тип цены                                                                                 Цена объекта   \n",
       "Составные элементы и принадлежности                                                               NaN   \n",
       "Маркеры                                                                                           NaN   \n",
       "Дата ввода                                                                                        NaN   \n",
       "category                                                                                         офис   \n",
       "Описание назначения                                                        Административное помещение   \n",
       "Описание назначения КС                                            Здание многоквартирного жилого дома   \n",
       "Валюта по договору                                                                                BYN   \n",
       "Уникальный номер АТЕ                                                                          17030.0   \n",
       "Цена по договору                                                                                  NaN   \n",
       "Назначение ЗУ                                       Земельный участок для размещения объектов иног...   \n",
       "Количество надземных этажей, шт.                                                                  1.0   \n",
       "Материал стен                                                                                  Кирпич   \n",
       "Наименование КС                                                             Многоквартирный жилой дом   \n",
       "Цена в евро за кв.м                                                                               0.0   \n",
       "Цена в долларах США за кв.м                                                                       0.0   \n",
       "Назначение КС                                       Здание специализированное складов, торговых ба...   \n",
       "Цена в евро                                                                                       NaN   \n",
       "Цена в долларах США                                                                               NaN   \n",
       "Цена в бел. руб. за кв.м                                                                          0.0   \n",
       "Цена в бел. руб.                                                                              10000.0   \n",
       "Площадь ЗУ, кв.м                                                                                  0.0   \n",
       "Кадастровый номер ЗУ                                                              623688000001000404    \n",
       "search_param                                        Здание административно-хозяйственное; \\nАдмини...   \n",
       "Инвентарный номер КС                                                                     600/C-130210   \n",
       "Общая площадь КС, кв.м                                                                            0.0   \n",
       "Наименование                                                               Административное помещение   \n",
       "Инвентарный номер                                                                        350/D-279535   \n",
       "Адрес                                               Гомельская обл., Жлобинский р-н, д. Солоное, у...   \n",
       "Идентификатор сделки                                                                69745428-комплекс   \n",
       "Общая площадь, кв.м                                                                              23.5   \n",
       "Дата сделки                                                                                19.04.2024   \n",
       "cluster_score                                                                                    -1.0   \n",
       "Name NP                                                                                            -1   \n",
       "Name region                                                                                        -1   \n",
       "Назначение                                                                 Административное помещение   \n",
       "sheet_source                                                                             РБ админ NEW   \n",
       "Количество объектов в сделке                                                                        1   \n",
       "Name oblast                                                                                        -1   \n",
       "cluster                                                                                             A   \n",
       "for_clusters_gr                                                                                    -1   \n",
       "Тип недвижимого имущества                                                     Изолированное помещение   \n",
       "\n",
       "                                                                                                  max  \n",
       "Жилая площадь КС, кв.м                                                                            NaN  \n",
       "Дата консервации                                                                           24.03.2021  \n",
       "п/п                                                                                             258.0  \n",
       "Дата реконструкции (реставрации, капитального р...                                         26.03.2021  \n",
       "Стоимости КС / РХ                                                                               17.75  \n",
       "Количество комнат ИП                                                                             17.0  \n",
       "Исходная валюта                                                                                  евро  \n",
       "Исходная цена                                                                           15879333442.0  \n",
       "Жилая площадь, кв.м                                                                               0.0  \n",
       "Количество изолированных помещений (квартир) КС...                                                311  \n",
       "Общая площадь нежилых помещений КС, кв.м / РХ                                                   378.5  \n",
       "Наличие напольных электроплит КС / РХ                                                            Есть  \n",
       "Дата проведения обследования КС / РХ                                                       17.03.2012  \n",
       "Наличие ванн (душей) КС / РХ                        Биде,Душевая кабина,Мойка,Умывальник (раковина...  \n",
       "Наличие газоснабжения КС / РХ                                                       Локальная система  \n",
       "Наличие горячего водоснабжения КС / РХ                                                   Нет сведений  \n",
       "Физический износ на дату обследования КС, % / РХ                                                 72.0  \n",
       "Наличие канализации КС / РХ                                                          Централизованная  \n",
       "Общая площадь жилых помещений КС, кв.м / РХ                                                    7807.7  \n",
       "Наличие холодного водоснабжения КС / РХ                                              Централизованная  \n",
       "Наличие отопления КС / РХ                                         Котел на твердом топливе,Теплый пол  \n",
       "Материал перекрытий КС / РХ                                  Деревянные изделия,Металлические изделия  \n",
       "Объем КС, куб.м / РХ                                                                            58097  \n",
       "Наличие электроснабжения КС / РХ                                                    Локальная система  \n",
       "Материал  крыши (кровли) КС / РХ                                                               Стекло  \n",
       "Материал фундамента КС / РХ                                                       Железобетон,Кирпичи  \n",
       "Количество подземных этажей, шт.                                                                  4.0  \n",
       "Описание цены                                                                                 2.55556  \n",
       "Процент готовности КС                                                                             100  \n",
       "Распределение долей до сделки                        {747/10000,2077/5000,3149/10000,527/5000,56/625}  \n",
       "Распределение долей после сделки                                                         {6/25,19/25}  \n",
       "floor                                                                                            22.0  \n",
       "Этаж расположения ИП                                                             Техническое подполье  \n",
       "Описание назначения ЗУ                              для строительства и обслуживания здания и соор...  \n",
       "Дата регистрации договора                                                                  02.08.2025  \n",
       "Переходящая доля                                                                                14/25  \n",
       "Тип цены                                                                                          NaN  \n",
       "Составные элементы и принадлежности                 Пристройка (лит. 1), два крыльца, сарай (лит. ...  \n",
       "Маркеры                                                                       Транзит, Δ цены: 12.46%  \n",
       "Дата ввода                                                                                 26.05.2016  \n",
       "category                                                                                          сто  \n",
       "Описание назначения                                                       Здание хозяйственного блока  \n",
       "Описание назначения КС                                                    Здание хозяйственного блока  \n",
       "Валюта по договору                                                                                BYR  \n",
       "Уникальный номер АТЕ                                                                            21731  \n",
       "Цена по договору                                                                              40325.0  \n",
       "Назначение ЗУ                                       Земельный участок для размещения объектов топл...  \n",
       "Количество надземных этажей, шт.                                                                 -1.0  \n",
       "Материал стен                                                                        Камень природный  \n",
       "Наименование КС                                                    здание продовольственного магазина  \n",
       "Цена в евро за кв.м                                                                        695.953932  \n",
       "Цена в долларах США за кв.м                                                                760.171564  \n",
       "Назначение КС                                       Здание специализированное для добычи и перераб...  \n",
       "Цена в евро                                                                              32501.048628  \n",
       "Цена в долларах США                                                                      35500.012048  \n",
       "Цена в бел. руб. за кв.м                                                                  2239.920771  \n",
       "Цена в бел. руб.                                                                             104604.3  \n",
       "Площадь ЗУ, кв.м                                                                               3115.0  \n",
       "Кадастровый номер ЗУ                                                             500000000009004672.0  \n",
       "search_param                                        Помещение многофункциональное, Здание многофун...  \n",
       "Инвентарный номер КС                                                                      614/C-37814  \n",
       "Общая площадь КС, кв.м                                                                         2763.3  \n",
       "Наименование                                                              здание хозяйственного блока  \n",
       "Инвентарный номер                                                                         614/C-37814  \n",
       "Адрес                                               Минская обл., Смолевичский р-н, Усяжский с/с, ...  \n",
       "Идентификатор сделки                                                                         80624161  \n",
       "Общая площадь, кв.м                                                                             823.8  \n",
       "Дата сделки                                                                       2021-12-12 00:00:00  \n",
       "cluster_score                                                                                  1027.0  \n",
       "Name NP                                                                                        брагин  \n",
       "Name region                                                                            краснопольский  \n",
       "Назначение                                          Здание специализированное научно-исследователь...  \n",
       "sheet_source                                                                                Боровляны  \n",
       "Количество объектов в сделке                                                                       39  \n",
       "Name oblast                                                                               могилевская  \n",
       "cluster                                                                                             F  \n",
       "for_clusters_gr                                                                                     1  \n",
       "Тип недвижимого имущества                                                        Капитальное строение  "
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "feats_desc_values = [\n",
    "    total_df_wd_filter.nunique(),\n",
    "    total_df_wd_filter.isna().sum() + (total_df_wd_filter == \"\").sum(),\n",
    "    total_df_wd_filter.apply(\n",
    "        lambda x: (\n",
    "            x.value_counts(dropna=False).index[0]\n",
    "            if x.dtype == \"object\"\n",
    "            else x.min()\n",
    "        ),\n",
    "        axis=0,\n",
    "    ),\n",
    "    total_df_wd_filter.apply(\n",
    "        lambda x: (\n",
    "            x.value_counts(dropna=False).index[-1]\n",
    "            if x.dtype == \"object\"\n",
    "            else x.max()\n",
    "        ),\n",
    "        axis=0,\n",
    "    ),\n",
    "]\n",
    "\n",
    "feats_desc = pd.DataFrame(\n",
    "    {\n",
    "        \"dtype\": total_df_wd_filter.dtypes.astype(str),  # - тип данных\n",
    "        \"nunique\": feats_desc_values[0],  # - количество уникальных значений\n",
    "        \"nunique_%\": (\n",
    "            feats_desc_values[0] / total_df_wd_filter.shape[0] * 100\n",
    "        ).round(2),\n",
    "        \"Nulls\": feats_desc_values[1],  # - количество пропусков\n",
    "        \"Nulls_%\": (\n",
    "            feats_desc_values[1] / total_df_wd_filter.shape[0] * 100\n",
    "        ).round(2),\n",
    "        \"min\": feats_desc_values[2],  # - min\n",
    "        \"max\": feats_desc_values[3],  # - max\n",
    "    }\n",
    ").sort_values(\n",
    "    by=[\n",
    "        \"Nulls\",\n",
    "        \"nunique\",\n",
    "        \"dtype\",\n",
    "    ],  # - поля для сортировки\n",
    "    ascending=[False, False, False],  # - направление сортировки\n",
    ")\n",
    "feats_desc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "id": "97032d86",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(22093, 78)"
      ]
     },
     "execution_count": 84,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_wd_filter.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "id": "58433a5e",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_wd_filter.to_excel(\n",
    "    \"./data/total_df_after_preproces_artem_without_dupl.xlsx\", index=False\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6bdbc024",
   "metadata": {},
   "source": [
    "# NewTasks\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5d597d72",
   "metadata": {},
   "source": [
    "## Load and Additional\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "id": "ddaabb7d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(22093, 78)\n"
     ]
    }
   ],
   "source": [
    "# total_df = pd.read_excel(\"./data/total_df_ater_preprocess_artem.xlsx\")\n",
    "\n",
    "total_df = pd.read_excel(\n",
    "    \"./data/total_df_after_preproces_artem_without_dupl.xlsx\"\n",
    ")\n",
    "\n",
    "print(total_df.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "id": "48aa7b6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# в группу офис попали ненужные строки, сейчас поменяем группу"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "id": "a86f1f74",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['торговля', 'офис', 'производство', 'склад', 'сто', nan, 'сельхоз'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[\"category\"].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "id": "1521f4c1",
   "metadata": {},
   "outputs": [],
   "source": [
    "exclude_patterns = [\n",
    "    \"база отдыха\",\n",
    "    \"гостевой дом\",\n",
    "    \"гостиница\",\n",
    "    \"гостиничный комплекс\",\n",
    "    \"дом охотника\",\n",
    "    \"дом рыбака\",\n",
    "    \"дом отдыха\",\n",
    "    \"турбаза\",\n",
    "    \"деревянный домик\",\n",
    "    \"дом на озере\",\n",
    "    \"дом рубленный\",\n",
    "    \"дом общинника\",\n",
    "    \"коттедж\",\n",
    "]\n",
    "\n",
    "# Создаём единое регулярное выражение\n",
    "pattern = \"|\".join(exclude_patterns + [\"баня\", \"фок\"])\n",
    "\n",
    "# Применяем условие\n",
    "mask = (total_df[\"category\"].str.lower() == \"офис\") & (\n",
    "    total_df[\"Наименование\"].str.lower().str.contains(pattern, na=False)\n",
    ")\n",
    "\n",
    "# Заменяем category на NaN там, где условие выполнено\n",
    "total_df.loc[mask, \"category\"] = np.nan"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "id": "d14231c4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Наименование</th>\n",
       "      <th>category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3866</th>\n",
       "      <td>Баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15477</th>\n",
       "      <td>Магазин-баня</td>\n",
       "      <td>торговля</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16829</th>\n",
       "      <td>Баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21126</th>\n",
       "      <td>Баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21127</th>\n",
       "      <td>Баня под склад имущества, инв. № 109/54</td>\n",
       "      <td>склад</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21128</th>\n",
       "      <td>баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21219</th>\n",
       "      <td>Гостевой дом-баня, двухэтажный, брусчатый</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21252</th>\n",
       "      <td>баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21308</th>\n",
       "      <td>Баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21311</th>\n",
       "      <td>Баня с котельной оздоровительного лагеря</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21359</th>\n",
       "      <td>Баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21431</th>\n",
       "      <td>Декоративное строении \"Русская баня\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21676</th>\n",
       "      <td>баня</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                    Наименование  category\n",
       "3866                                        Баня       NaN\n",
       "15477                               Магазин-баня  торговля\n",
       "16829                                       Баня       NaN\n",
       "21126                                       Баня       NaN\n",
       "21127    Баня под склад имущества, инв. № 109/54     склад\n",
       "21128                                       баня       NaN\n",
       "21219  Гостевой дом-баня, двухэтажный, брусчатый       NaN\n",
       "21252                                       баня       NaN\n",
       "21308                                       Баня       NaN\n",
       "21311   Баня с котельной оздоровительного лагеря       NaN\n",
       "21359                                       Баня       NaN\n",
       "21431       Декоративное строении \"Русская баня\"       NaN\n",
       "21676                                       баня       NaN"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[total_df[\"Наименование\"].str.contains(\"Баня\", case=False, na=False)][\n",
    "    [\"Наименование\", \"category\"]\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "7e24246b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Наименование</th>\n",
       "      <th>category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>7864</th>\n",
       "      <td>гостевой домик \"Рыбака\" №2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7865</th>\n",
       "      <td>гостевой домик \"Рыбака\" №1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7867</th>\n",
       "      <td>гостевой домик \"Охотника\" №2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15492</th>\n",
       "      <td>Гостевой дом на 4 человека</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15493</th>\n",
       "      <td>Гостевой дом на 4 человека</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15494</th>\n",
       "      <td>Гостевой дом на 5 человек</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20257</th>\n",
       "      <td>гостевой дом</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21039</th>\n",
       "      <td>Гостевой дом 1Н \" Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21040</th>\n",
       "      <td>Гостевой дом 1 \"Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21041</th>\n",
       "      <td>Гостевой дом 1Н \" Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21042</th>\n",
       "      <td>Гостевой дом 1 \"Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21043</th>\n",
       "      <td>Гостевой дом 1К\" Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21044</th>\n",
       "      <td>Гостевой дом 1 КН \"Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21045</th>\n",
       "      <td>Гостевой дом 1КН \" Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21046</th>\n",
       "      <td>Гостевой дом 1КН \" Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21047</th>\n",
       "      <td>Гостевой дом 1К \"Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21048</th>\n",
       "      <td>Гостевой дом 1К \" Дом общинника\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21049</th>\n",
       "      <td>Гостевой дом 2 \"Мещанский\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21050</th>\n",
       "      <td>Гостевой дом 2Н \"Мещанский\"</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21083</th>\n",
       "      <td>Гостевой домик № 2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21084</th>\n",
       "      <td>Гостевой домик № 3</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21085</th>\n",
       "      <td>Гостевой домик № 4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21219</th>\n",
       "      <td>Гостевой дом-баня, двухэтажный, брусчатый</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21683</th>\n",
       "      <td>Жилой гостевой дом усадебного типа</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21688</th>\n",
       "      <td>Гостевой дом</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21689</th>\n",
       "      <td>Гостевой дом</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21690</th>\n",
       "      <td>Гостевой дом</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21692</th>\n",
       "      <td>Гостевой дом № 2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21750</th>\n",
       "      <td>гостевой дом</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21762</th>\n",
       "      <td>Гостевой дом № 1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21763</th>\n",
       "      <td>Гостевой дом № 7</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21764</th>\n",
       "      <td>Гостевой дом № 6</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21765</th>\n",
       "      <td>Гостевой дом № 3</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21766</th>\n",
       "      <td>Гостевой дом № 4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21767</th>\n",
       "      <td>Гостевой дом № 8</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21768</th>\n",
       "      <td>Гостевой дом № 5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21769</th>\n",
       "      <td>Гостевой дом № 2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                    Наименование category\n",
       "7864                  гостевой домик \"Рыбака\" №2      NaN\n",
       "7865                  гостевой домик \"Рыбака\" №1      NaN\n",
       "7867                гостевой домик \"Охотника\" №2      NaN\n",
       "15492                 Гостевой дом на 4 человека      NaN\n",
       "15493                 Гостевой дом на 4 человека      NaN\n",
       "15494                  Гостевой дом на 5 человек      NaN\n",
       "20257                               гостевой дом      NaN\n",
       "21039           Гостевой дом 1Н \" Дом общинника\"      NaN\n",
       "21040             Гостевой дом 1 \"Дом общинника\"      NaN\n",
       "21041           Гостевой дом 1Н \" Дом общинника\"      NaN\n",
       "21042             Гостевой дом 1 \"Дом общинника\"      NaN\n",
       "21043            Гостевой дом 1К\" Дом общинника\"      NaN\n",
       "21044          Гостевой дом 1 КН \"Дом общинника\"      NaN\n",
       "21045          Гостевой дом 1КН \" Дом общинника\"      NaN\n",
       "21046          Гостевой дом 1КН \" Дом общинника\"      NaN\n",
       "21047            Гостевой дом 1К \"Дом общинника\"      NaN\n",
       "21048           Гостевой дом 1К \" Дом общинника\"      NaN\n",
       "21049                 Гостевой дом 2 \"Мещанский\"      NaN\n",
       "21050                Гостевой дом 2Н \"Мещанский\"      NaN\n",
       "21083                         Гостевой домик № 2      NaN\n",
       "21084                         Гостевой домик № 3      NaN\n",
       "21085                         Гостевой домик № 4      NaN\n",
       "21219  Гостевой дом-баня, двухэтажный, брусчатый      NaN\n",
       "21683         Жилой гостевой дом усадебного типа      NaN\n",
       "21688                               Гостевой дом      NaN\n",
       "21689                               Гостевой дом      NaN\n",
       "21690                               Гостевой дом      NaN\n",
       "21692                           Гостевой дом № 2      NaN\n",
       "21750                               гостевой дом      NaN\n",
       "21762                           Гостевой дом № 1      NaN\n",
       "21763                           Гостевой дом № 7      NaN\n",
       "21764                           Гостевой дом № 6      NaN\n",
       "21765                           Гостевой дом № 3      NaN\n",
       "21766                           Гостевой дом № 4      NaN\n",
       "21767                           Гостевой дом № 8      NaN\n",
       "21768                           Гостевой дом № 5      NaN\n",
       "21769                           Гостевой дом № 2      NaN"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[\n",
    "    total_df[\"Наименование\"].str.contains(\"Гостевой дом\", case=False, na=False)\n",
    "][[\"Наименование\", \"category\"]]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8aace8e0",
   "metadata": {},
   "source": [
    "## 2 Привязать курс доллара к датам сделок\n",
    "\n",
    "Есть отдельная выгрзука с курсом зза период с 2014 по 2025.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "b3f57167",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0   2022-05-10\n",
       "1   2022-05-10\n",
       "2   2022-05-05\n",
       "3   2022-05-05\n",
       "4   2022-05-04\n",
       "Name: Дата сделки, dtype: datetime64[ns]"
      ]
     },
     "execution_count": 92,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# display(total_df['Дата сделки'].head())\n",
    "total_df[\"Дата сделки\"] = pd.to_datetime(total_df[\"Дата сделки\"], dayfirst=True)\n",
    "total_df[\"Дата сделки\"].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "59c4bca4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 4235 entries, 0 to 4234\n",
      "Data columns (total 4 columns):\n",
      " #   Column                    Non-Null Count  Dtype         \n",
      "---  ------                    --------------  -----         \n",
      " 0   Дата                      4235 non-null   datetime64[ns]\n",
      " 1   1 Евро (EUR)              4235 non-null   float64       \n",
      " 2   1 Российский рубль (RUB)  4235 non-null   float64       \n",
      " 3   1 Доллар США (USD)        4235 non-null   float64       \n",
      "dtypes: datetime64[ns](1), float64(3)\n",
      "memory usage: 132.5 KB\n"
     ]
    }
   ],
   "source": [
    "currency_data = pd.read_excel(\n",
    "    \"./data/2014_2025_cur_rates.xlsx\", sheet_name=\"курс\"\n",
    ")\n",
    "currency_data[\"Дата\"] = pd.to_datetime(currency_data[\"Дата\"], dayfirst=True)\n",
    "currency_data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "5d95ed09",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Проверим отсуствуют ли данные из-за left join Дата                        0.000815\n",
      "1 Евро (EUR)                0.000815\n",
      "1 Российский рубль (RUB)    0.000815\n",
      "1 Доллар США (USD)          0.000815\n",
      "dtype: float64\n"
     ]
    }
   ],
   "source": [
    "# join по датам\n",
    "total_df_merged = total_df.merge(\n",
    "    currency_data, left_on=\"Дата сделки\", right_on=\"Дата\", how=\"left\"\n",
    ")\n",
    "print(\n",
    "    \"Проверим отсуствуют ли данные из-за left join\",\n",
    "    total_df_merged[currency_data.columns].isna().mean(),\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "81708eab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Дата                   18\n",
       "Дата сделки             0\n",
       "Цена в бел. руб.        0\n",
       "Цена в долларах США     0\n",
       "Цена в евро             0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# всего 1 строка с пустой инфой по цене -> курс не взять\n",
    "total_df_merged.loc[\n",
    "    total_df_merged[\"1 Доллар США (USD)\"].isna(),\n",
    "    [\n",
    "        \"Дата\",\n",
    "        \"Дата сделки\",\n",
    "        \"Цена в бел. руб.\",\n",
    "        \"Цена в долларах США\",\n",
    "        \"Цена в евро\",\n",
    "    ],\n",
    "].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "a477f5f9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в евро</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>21431</th>\n",
       "      <td>2013-12-30</td>\n",
       "      <td>107742.34</td>\n",
       "      <td>113412.99</td>\n",
       "      <td>82434.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21432</th>\n",
       "      <td>2013-10-25</td>\n",
       "      <td>48690.97</td>\n",
       "      <td>53156.08</td>\n",
       "      <td>38582.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21433</th>\n",
       "      <td>2013-05-31</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21434</th>\n",
       "      <td>2013-05-31</td>\n",
       "      <td>2000.00</td>\n",
       "      <td>2304.15</td>\n",
       "      <td>1777.78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21435</th>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>45000.00</td>\n",
       "      <td>51724.14</td>\n",
       "      <td>40394.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21436</th>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21437</th>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21438</th>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21439</th>\n",
       "      <td>2013-03-29</td>\n",
       "      <td>1876852.23</td>\n",
       "      <td>2162272.15</td>\n",
       "      <td>1689335.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21440</th>\n",
       "      <td>2013-03-29</td>\n",
       "      <td>1876852.23</td>\n",
       "      <td>2162272.15</td>\n",
       "      <td>1689335.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21441</th>\n",
       "      <td>2013-03-29</td>\n",
       "      <td>1876852.23</td>\n",
       "      <td>2162272.15</td>\n",
       "      <td>1689335.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21442</th>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>4858.63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21443</th>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>4858.63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21444</th>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>4858.63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21445</th>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>4858.63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21446</th>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>4858.63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21447</th>\n",
       "      <td>2013-01-08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21448</th>\n",
       "      <td>2013-01-08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Дата сделки  Цена в бел. руб.  Цена в долларах США  Цена в евро\n",
       "21431  2013-12-30         107742.34            113412.99     82434.84\n",
       "21432  2013-10-25          48690.97             53156.08     38582.39\n",
       "21433  2013-05-31              0.00                 0.00         0.00\n",
       "21434  2013-05-31           2000.00              2304.15      1777.78\n",
       "21435  2013-04-04          45000.00             51724.14     40394.97\n",
       "21436  2013-04-04              0.00                 0.00         0.00\n",
       "21437  2013-04-04              0.00                 0.00         0.00\n",
       "21438  2013-04-04              0.00                 0.00         0.00\n",
       "21439  2013-03-29        1876852.23           2162272.15   1689335.94\n",
       "21440  2013-03-29        1876852.23           2162272.15   1689335.94\n",
       "21441  2013-03-29        1876852.23           2162272.15   1689335.94\n",
       "21442  2013-01-19           5602.00              6506.39      4858.63\n",
       "21443  2013-01-19           5602.00              6506.39      4858.63\n",
       "21444  2013-01-19           5602.00              6506.39      4858.63\n",
       "21445  2013-01-19           5602.00              6506.39      4858.63\n",
       "21446  2013-01-19           5602.00              6506.39      4858.63\n",
       "21447  2013-01-08              0.00                 0.00         0.00\n",
       "21448  2013-01-08              0.00                 0.00         0.00"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged.loc[\n",
    "    total_df_merged[\"1 Доллар США (USD)\"].isna(),\n",
    "    [\"Дата сделки\", \"Цена в бел. руб.\", \"Цена в долларах США\", \"Цена в евро\"],\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "c7e4ffe8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <th>Адрес</th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Описание назначения</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <th>Материал стен</th>\n",
       "      <th>Дата ввода</th>\n",
       "      <th>Дата консервации</th>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <th>Тип цены</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Валюта по договору</th>\n",
       "      <th>Переходящая доля</th>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <th>Назначение КС</th>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <th>Наименование КС</th>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <th>Маркеры</th>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>search_param</th>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <th>Исходная цена</th>\n",
       "      <th>Исходная валюта</th>\n",
       "      <th>п/п</th>\n",
       "      <th>floor</th>\n",
       "      <th>category</th>\n",
       "      <th>for_clusters_gr</th>\n",
       "      <th>Name NP</th>\n",
       "      <th>Name region</th>\n",
       "      <th>Name oblast</th>\n",
       "      <th>cluster_score</th>\n",
       "      <th>cluster</th>\n",
       "      <th>Дата</th>\n",
       "      <th>1 Евро (EUR)</th>\n",
       "      <th>1 Российский рубль (RUB)</th>\n",
       "      <th>1 Доллар США (USD)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>21431</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>451/C-12525</td>\n",
       "      <td>Гродненская обл., Дятловский р-н, Дятловский с...</td>\n",
       "      <td>Здание специализированное для лечебно-профилак...</td>\n",
       "      <td>Здание специализированное для лечебно-профилак...</td>\n",
       "      <td>Декоративное строении \"Русская баня\"</td>\n",
       "      <td>237.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Смешанной конструкции</td>\n",
       "      <td>2011-04-15 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-12-30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59780181</td>\n",
       "      <td>1</td>\n",
       "      <td>107742.34</td>\n",
       "      <td>454.42</td>\n",
       "      <td>NaN</td>\n",
       "      <td>113412.99</td>\n",
       "      <td>478.33</td>\n",
       "      <td>82434.84</td>\n",
       "      <td>347.68</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>451/C-12525</td>\n",
       "      <td>237.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для лечебно-профилак...</td>\n",
       "      <td>Здание специализированное для лечебно-профилак...</td>\n",
       "      <td>Декоративное строении \"Русская баня\"</td>\n",
       "      <td>100.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Склад</td>\n",
       "      <td>422382300602000045</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4997.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа объекта с составными частями и принадл...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>1.077423e+09</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>дятловский</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>96.0</td>\n",
       "      <td>F</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21432</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>710/C-60916</td>\n",
       "      <td>Могилевская обл., Бобруйский р-н, база отдыха\"...</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>430.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1982-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-10-25</td>\n",
       "      <td>NaN</td>\n",
       "      <td>60230290</td>\n",
       "      <td>11</td>\n",
       "      <td>48690.97</td>\n",
       "      <td>113.02</td>\n",
       "      <td>Указана цена за 11 капитальных строений</td>\n",
       "      <td>53156.08</td>\n",
       "      <td>123.39</td>\n",
       "      <td>38582.39</td>\n",
       "      <td>89.56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>710/C-60916</td>\n",
       "      <td>430.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>крыльца, отмостка</td>\n",
       "      <td>720800000030000001</td>\n",
       "      <td>Земельный участок для размещения объектов здра...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>42000.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>4.869097e+08</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>могилевская</td>\n",
       "      <td>418.0</td>\n",
       "      <td>E</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21433</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>111/C-7386</td>\n",
       "      <td>Брестская обл., Ляховичский р-н, Начевский с/с...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>пищеблок</td>\n",
       "      <td>402.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Каркасно-засыпные</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-05-31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59982404</td>\n",
       "      <td>6</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>цена указана в листе СА6 на капитальное строен...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>111/C-7386</td>\n",
       "      <td>402.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>пищеблок</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное сборно-щитовое здание пищеблока с ...</td>\n",
       "      <td>125083103101000001</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>58989.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует дата вв...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>ляховичский</td>\n",
       "      <td>брестская</td>\n",
       "      <td>161.0</td>\n",
       "      <td>E</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21434</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>111/C-7384</td>\n",
       "      <td>Брестская обл., Ляховичский р-н, Начевский с/с...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>клуб</td>\n",
       "      <td>112.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Смешанной конструкции</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-05-31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59982404</td>\n",
       "      <td>6</td>\n",
       "      <td>2000.00</td>\n",
       "      <td>17.83</td>\n",
       "      <td>цена на пять капитальных строения</td>\n",
       "      <td>2304.15</td>\n",
       "      <td>20.54</td>\n",
       "      <td>1777.78</td>\n",
       "      <td>15.84</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>111/C-7384</td>\n",
       "      <td>112.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>Здание специализированное культурно-просветите...</td>\n",
       "      <td>клуб</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное сборно-щитовое облицованное кирпич...</td>\n",
       "      <td>125083103101000001</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>58989.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует дата вв...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>2.000000e+07</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>ляховичский</td>\n",
       "      <td>брестская</td>\n",
       "      <td>161.0</td>\n",
       "      <td>E</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21435</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>442/C-6216</td>\n",
       "      <td>Гродненская обл., Островецкий р-н, Ворнянский ...</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>административное здание</td>\n",
       "      <td>107.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Дерево, бруски, бревна</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59763838</td>\n",
       "      <td>19</td>\n",
       "      <td>45000.00</td>\n",
       "      <td>419.38</td>\n",
       "      <td>общая цена капитальных строений с инв. №№ 442/...</td>\n",
       "      <td>51724.14</td>\n",
       "      <td>482.05</td>\n",
       "      <td>40394.97</td>\n",
       "      <td>376.47</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>442/C-6216</td>\n",
       "      <td>107.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>административное здание</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>424680407101000025</td>\n",
       "      <td>Земельный участок для размещения объектов неус...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4542.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует дата вв...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>4.500000e+08</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>островецкий</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>191.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21436</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>442/C-6218</td>\n",
       "      <td>Гродненская обл., Островецкий р-н, Ворнянский ...</td>\n",
       "      <td>Здание неустановленного назначения</td>\n",
       "      <td>Здание неустановленного назначения</td>\n",
       "      <td>склад-спальный корпус</td>\n",
       "      <td>509.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59763838</td>\n",
       "      <td>19</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>общая цена объектов указана в листе СА капитал...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>442/C-6218</td>\n",
       "      <td>509.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание неустановленного назначения</td>\n",
       "      <td>Здание неустановленного назначения</td>\n",
       "      <td>склад-спальный корпус</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>424680407101000025</td>\n",
       "      <td>Земельный участок для размещения объектов неус...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4542.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует дата вв...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>склад</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>островецкий</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>45.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21437</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>442/C-112</td>\n",
       "      <td>Гродненская обл., Островецкий р-н, Ворнянский ...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>столовая</td>\n",
       "      <td>547.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1996-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59763838</td>\n",
       "      <td>19</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>общая цена объектов указана в листе СА капитал...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>442/C-112</td>\n",
       "      <td>547.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>столовая</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>424680407101000025</td>\n",
       "      <td>Земельный участок для размещения объектов неус...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4542.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует цена до...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>островецкий</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>191.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21438</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>442/C-6213</td>\n",
       "      <td>Гродненская обл., Островецкий р-н, Ворнянский ...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>медпункт</td>\n",
       "      <td>76.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Другое</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-04-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59763838</td>\n",
       "      <td>19</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>общая цена объектов указана в листе СА капитал...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>442/C-6213</td>\n",
       "      <td>76.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>медпункт</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>424680407101000025</td>\n",
       "      <td>Земельный участок для размещения объектов неус...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4542.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует дата вв...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>островецкий</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>191.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21439</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-708053707</td>\n",
       "      <td>г. Минск, ул. Одоевского,  131-7</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Кабинеты, серверная, зал заседаний</td>\n",
       "      <td>512.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Крупнопанельные</td>\n",
       "      <td>2005-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-03-29</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59188692</td>\n",
       "      <td>7</td>\n",
       "      <td>1876852.23</td>\n",
       "      <td>3662.15</td>\n",
       "      <td>цена указана в отношении изолированных помещен...</td>\n",
       "      <td>2162272.15</td>\n",
       "      <td>4219.07</td>\n",
       "      <td>1689335.94</td>\n",
       "      <td>3296.27</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2-й</td>\n",
       "      <td>500/C-40304</td>\n",
       "      <td>2819.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Административно-хозяйственное здание</td>\n",
       "      <td>100.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000006002847</td>\n",
       "      <td>Земельный участок для размещения объектов адми...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2481.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>2.162272e+06</td>\n",
       "      <td>доллар США</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>1027.0</td>\n",
       "      <td>A</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21440</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-708053702</td>\n",
       "      <td>г. Минск, ул. Одоевского,  131-2</td>\n",
       "      <td>Производственное помещение</td>\n",
       "      <td>Производственное помещение</td>\n",
       "      <td>Производственное помещение</td>\n",
       "      <td>109.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Крупнопанельные</td>\n",
       "      <td>2005-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-03-29</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59188692</td>\n",
       "      <td>7</td>\n",
       "      <td>1876852.23</td>\n",
       "      <td>17218.83</td>\n",
       "      <td>цена указана в отношении изолированных помещен...</td>\n",
       "      <td>2162272.15</td>\n",
       "      <td>19837.36</td>\n",
       "      <td>1689335.94</td>\n",
       "      <td>15498.49</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>500/C-40304</td>\n",
       "      <td>2819.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Административно-хозяйственное здание</td>\n",
       "      <td>100.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000006002847</td>\n",
       "      <td>Земельный участок для размещения объектов адми...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2481.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>2.162272e+06</td>\n",
       "      <td>доллар США</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>производство</td>\n",
       "      <td>0</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>287.0</td>\n",
       "      <td>A</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21441</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-708053703</td>\n",
       "      <td>г. Минск, ул. Одоевского,  131-3</td>\n",
       "      <td>Складское помещение</td>\n",
       "      <td>Складское помещение</td>\n",
       "      <td>Кладовые</td>\n",
       "      <td>35.9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Крупнопанельные</td>\n",
       "      <td>2005-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-03-29</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59188692</td>\n",
       "      <td>7</td>\n",
       "      <td>1876852.23</td>\n",
       "      <td>52280.01</td>\n",
       "      <td>цена указана в отношении изолированных помещен...</td>\n",
       "      <td>2162272.15</td>\n",
       "      <td>60230.42</td>\n",
       "      <td>1689335.94</td>\n",
       "      <td>47056.71</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>500/C-40304</td>\n",
       "      <td>2819.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Административно-хозяйственное здание</td>\n",
       "      <td>100.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000006002847</td>\n",
       "      <td>Земельный участок для размещения объектов адми...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2481.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>2.162272e+06</td>\n",
       "      <td>доллар США</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>склад</td>\n",
       "      <td>0</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>287.0</td>\n",
       "      <td>A</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21442</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>642/C-26794</td>\n",
       "      <td>Минская обл., Копыльский р-н, Бучатинский с/с,...</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Контора</td>\n",
       "      <td>66.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки более 51 см</td>\n",
       "      <td>1962-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59044827</td>\n",
       "      <td>15</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>84.37</td>\n",
       "      <td>Цена указана с учетом стоимости пятнадцати кап...</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>97.99</td>\n",
       "      <td>4858.63</td>\n",
       "      <td>73.17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>642/C-26794</td>\n",
       "      <td>66.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Здание административно-хозяйственное</td>\n",
       "      <td>Контора</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание А1/к</td>\n",
       "      <td>622881700001000007</td>\n",
       "      <td>Земельный участок для иных сельскохозяйственны...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>465052.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>5.602000e+07</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>копыльский</td>\n",
       "      <td>минская</td>\n",
       "      <td>137.0</td>\n",
       "      <td>E</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21443</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>642/C-26810</td>\n",
       "      <td>Минская обл., Копыльский р-н, Бучатинский с/с,...</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Механическая мастерская</td>\n",
       "      <td>67.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1958-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59044827</td>\n",
       "      <td>15</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>82.75</td>\n",
       "      <td>Цена указана с учетом стоимости пятнадцати кап...</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>96.11</td>\n",
       "      <td>4858.63</td>\n",
       "      <td>71.77</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>642/C-26810</td>\n",
       "      <td>67.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Здание нежилое</td>\n",
       "      <td>Механическая мастерская</td>\n",
       "      <td>100.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Двухэтажное кирпичное здание А2/к</td>\n",
       "      <td>622881700001000007</td>\n",
       "      <td>Земельный участок для иных сельскохозяйственны...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>465052.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>5.602000e+07</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>производство</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>копыльский</td>\n",
       "      <td>минская</td>\n",
       "      <td>31.0</td>\n",
       "      <td>E</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21444</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>642/C-26798</td>\n",
       "      <td>Минская обл., Копыльский р-н, Бучатинский с/с,...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Галерея сушки</td>\n",
       "      <td>202.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1967-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59044827</td>\n",
       "      <td>15</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>27.62</td>\n",
       "      <td>Цена указана с учетом стоимости пятнадцати кап...</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>32.08</td>\n",
       "      <td>4858.63</td>\n",
       "      <td>23.96</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>642/C-26798</td>\n",
       "      <td>202.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Галерея сушки</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание А1/к с двумя прис...</td>\n",
       "      <td>622881700001000007</td>\n",
       "      <td>Земельный участок для иных сельскохозяйственны...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>465052.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>5.602000e+07</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>undef</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21445</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>642/C-26801</td>\n",
       "      <td>Минская обл., Копыльский р-н, Бучатинский с/с,...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Производственный корпус</td>\n",
       "      <td>541.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1966-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59044827</td>\n",
       "      <td>15</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>10.34</td>\n",
       "      <td>Цена указана с учетом стоимости пятнадцати кап...</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>12.01</td>\n",
       "      <td>4858.63</td>\n",
       "      <td>8.97</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>642/C-26801</td>\n",
       "      <td>541.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Производственный корпус</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание А1/к</td>\n",
       "      <td>622881700001000007</td>\n",
       "      <td>Земельный участок для иных сельскохозяйственны...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>465052.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>5.602000e+07</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>производство</td>\n",
       "      <td>0</td>\n",
       "      <td>-1</td>\n",
       "      <td>копыльский</td>\n",
       "      <td>минская</td>\n",
       "      <td>31.0</td>\n",
       "      <td>E</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21446</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>642/C-26792</td>\n",
       "      <td>Минская обл., Копыльский р-н, Бучатинский с/с,...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Сушилка</td>\n",
       "      <td>665.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1962-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>59044827</td>\n",
       "      <td>15</td>\n",
       "      <td>5602.00</td>\n",
       "      <td>8.41</td>\n",
       "      <td>Цена указана с учетом стоимости пятнадцати кап...</td>\n",
       "      <td>6506.39</td>\n",
       "      <td>9.77</td>\n",
       "      <td>4858.63</td>\n",
       "      <td>7.30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>642/C-26792</td>\n",
       "      <td>665.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Здание специализированное для производства стр...</td>\n",
       "      <td>Сушилка</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание А1/к</td>\n",
       "      <td>622881700001000007</td>\n",
       "      <td>Земельный участок для иных сельскохозяйственны...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>465052.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Продажа нескольких объектов в комплексе; Прода...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>5.602000e+07</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>undef</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21447</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>600/C-137246</td>\n",
       "      <td>Республика Беларусь,Минская обл., Минский р-н,...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>381.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1958-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>60075491</td>\n",
       "      <td>16</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Цена за капитальные строения 600/С-137251, 600...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>600/C-137246</td>\n",
       "      <td>381.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание столовой с пристр...</td>\n",
       "      <td>623683400001000568</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38765.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует цена до...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>минский</td>\n",
       "      <td>минская</td>\n",
       "      <td>461.0</td>\n",
       "      <td>B</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21448</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>600/C-137243</td>\n",
       "      <td>Республика Беларусь,Минская обл., Минский р-н,...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Медпункт</td>\n",
       "      <td>69.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1958-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>60075491</td>\n",
       "      <td>16</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Цена за строения 600/С-137251, 600/С-137252, 6...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>600/C-137243</td>\n",
       "      <td>69.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Медпункт</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание медпункта с крыльцом</td>\n",
       "      <td>623683400001000568</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38765.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует цена до...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>минский</td>\n",
       "      <td>минская</td>\n",
       "      <td>461.0</td>\n",
       "      <td>B</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Тип недвижимого имущества Инвентарный номер  \\\n",
       "21431      Капитальное строение       451/C-12525   \n",
       "21432      Капитальное строение       710/C-60916   \n",
       "21433      Капитальное строение        111/C-7386   \n",
       "21434      Капитальное строение        111/C-7384   \n",
       "21435      Капитальное строение        442/C-6216   \n",
       "21436      Капитальное строение        442/C-6218   \n",
       "21437      Капитальное строение         442/C-112   \n",
       "21438      Капитальное строение        442/C-6213   \n",
       "21439   Изолированное помещение   500/D-708053707   \n",
       "21440   Изолированное помещение   500/D-708053702   \n",
       "21441   Изолированное помещение   500/D-708053703   \n",
       "21442      Капитальное строение       642/C-26794   \n",
       "21443      Капитальное строение       642/C-26810   \n",
       "21444      Капитальное строение       642/C-26798   \n",
       "21445      Капитальное строение       642/C-26801   \n",
       "21446      Капитальное строение       642/C-26792   \n",
       "21447      Капитальное строение      600/C-137246   \n",
       "21448      Капитальное строение      600/C-137243   \n",
       "\n",
       "                                                   Адрес  \\\n",
       "21431  Гродненская обл., Дятловский р-н, Дятловский с...   \n",
       "21432  Могилевская обл., Бобруйский р-н, база отдыха\"...   \n",
       "21433  Брестская обл., Ляховичский р-н, Начевский с/с...   \n",
       "21434  Брестская обл., Ляховичский р-н, Начевский с/с...   \n",
       "21435  Гродненская обл., Островецкий р-н, Ворнянский ...   \n",
       "21436  Гродненская обл., Островецкий р-н, Ворнянский ...   \n",
       "21437  Гродненская обл., Островецкий р-н, Ворнянский ...   \n",
       "21438  Гродненская обл., Островецкий р-н, Ворнянский ...   \n",
       "21439                   г. Минск, ул. Одоевского,  131-7   \n",
       "21440                   г. Минск, ул. Одоевского,  131-2   \n",
       "21441                   г. Минск, ул. Одоевского,  131-3   \n",
       "21442  Минская обл., Копыльский р-н, Бучатинский с/с,...   \n",
       "21443  Минская обл., Копыльский р-н, Бучатинский с/с,...   \n",
       "21444  Минская обл., Копыльский р-н, Бучатинский с/с,...   \n",
       "21445  Минская обл., Копыльский р-н, Бучатинский с/с,...   \n",
       "21446  Минская обл., Копыльский р-н, Бучатинский с/с,...   \n",
       "21447  Республика Беларусь,Минская обл., Минский р-н,...   \n",
       "21448  Республика Беларусь,Минская обл., Минский р-н,...   \n",
       "\n",
       "                                              Назначение  \\\n",
       "21431  Здание специализированное для лечебно-профилак...   \n",
       "21432                                     Здание нежилое   \n",
       "21433  Здание специализированное для общественного пи...   \n",
       "21434  Здание специализированное культурно-просветите...   \n",
       "21435               Здание административно-хозяйственное   \n",
       "21436                 Здание неустановленного назначения   \n",
       "21437  Здание специализированное для общественного пи...   \n",
       "21438  Здание специализированное здравоохранения и пр...   \n",
       "21439                         Административное помещение   \n",
       "21440                         Производственное помещение   \n",
       "21441                                Складское помещение   \n",
       "21442               Здание административно-хозяйственное   \n",
       "21443                                     Здание нежилое   \n",
       "21444  Здание специализированное для производства стр...   \n",
       "21445  Здание специализированное для производства стр...   \n",
       "21446  Здание специализированное для производства стр...   \n",
       "21447  Здание специализированное для общественного пи...   \n",
       "21448  Здание специализированное здравоохранения и пр...   \n",
       "\n",
       "                                     Описание назначения  \\\n",
       "21431  Здание специализированное для лечебно-профилак...   \n",
       "21432                                     Здание нежилое   \n",
       "21433  Здание специализированное для общественного пи...   \n",
       "21434  Здание специализированное культурно-просветите...   \n",
       "21435               Здание административно-хозяйственное   \n",
       "21436                 Здание неустановленного назначения   \n",
       "21437  Здание специализированное для общественного пи...   \n",
       "21438  Здание специализированное здравоохранения и пр...   \n",
       "21439                         Административное помещение   \n",
       "21440                         Производственное помещение   \n",
       "21441                                Складское помещение   \n",
       "21442               Здание административно-хозяйственное   \n",
       "21443                                     Здание нежилое   \n",
       "21444  Здание специализированное для производства стр...   \n",
       "21445  Здание специализированное для производства стр...   \n",
       "21446  Здание специализированное для производства стр...   \n",
       "21447  Здание специализированное для общественного пи...   \n",
       "21448  Здание специализированное здравоохранения и пр...   \n",
       "\n",
       "                               Наименование  Общая площадь, кв.м  \\\n",
       "21431  Декоративное строении \"Русская баня\"                237.1   \n",
       "21432                              Столовая                430.8   \n",
       "21433                              пищеблок                402.8   \n",
       "21434                                  клуб                112.2   \n",
       "21435               административное здание                107.3   \n",
       "21436                 склад-спальный корпус                509.3   \n",
       "21437                              столовая                547.6   \n",
       "21438                              медпункт                 76.8   \n",
       "21439    Кабинеты, серверная, зал заседаний                512.5   \n",
       "21440            Производственное помещение                109.0   \n",
       "21441                              Кладовые                 35.9   \n",
       "21442                               Контора                 66.4   \n",
       "21443               Механическая мастерская                 67.7   \n",
       "21444                         Галерея сушки                202.8   \n",
       "21445               Производственный корпус                541.6   \n",
       "21446                               Сушилка                665.8   \n",
       "21447                              Столовая                381.3   \n",
       "21448                              Медпункт                 69.6   \n",
       "\n",
       "       Жилая площадь, кв.м                       Материал стен  \\\n",
       "21431                  NaN               Смешанной конструкции   \n",
       "21432                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21433                  NaN                   Каркасно-засыпные   \n",
       "21434                  NaN               Смешанной конструкции   \n",
       "21435                  NaN              Дерево, бруски, бревна   \n",
       "21436                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21437                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21438                  NaN                              Другое   \n",
       "21439                  NaN                     Крупнопанельные   \n",
       "21440                  NaN                     Крупнопанельные   \n",
       "21441                  NaN                     Крупнопанельные   \n",
       "21442                  NaN  Кирпич толщиной кладки более 51 см   \n",
       "21443                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21444                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21445                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21446                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21447                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "21448                  NaN     Кирпич толщиной кладки до 45 см   \n",
       "\n",
       "                Дата ввода Дата консервации  \\\n",
       "21431  2011-04-15 00:00:00              NaN   \n",
       "21432  1982-01-01 00:00:00              NaN   \n",
       "21433                  NaN              NaN   \n",
       "21434                  NaN              NaN   \n",
       "21435                  NaN              NaN   \n",
       "21436                  NaN              NaN   \n",
       "21437  1996-01-01 00:00:00              NaN   \n",
       "21438                  NaN              NaN   \n",
       "21439  2005-01-01 00:00:00              NaN   \n",
       "21440  2005-01-01 00:00:00              NaN   \n",
       "21441  2005-01-01 00:00:00              NaN   \n",
       "21442  1962-01-01 00:00:00              NaN   \n",
       "21443  1958-01-01 00:00:00              NaN   \n",
       "21444  1967-01-01 00:00:00              NaN   \n",
       "21445  1966-01-01 00:00:00              NaN   \n",
       "21446  1962-01-01 00:00:00              NaN   \n",
       "21447  1958-01-01 00:00:00              NaN   \n",
       "21448  1958-01-01 00:00:00              NaN   \n",
       "\n",
       "      Дата реконструкции (реставрации, капитального ремонта) Дата сделки  \\\n",
       "21431                                                NaN      2013-12-30   \n",
       "21432                                                NaN      2013-10-25   \n",
       "21433                                                NaN      2013-05-31   \n",
       "21434                                                NaN      2013-05-31   \n",
       "21435                                                NaN      2013-04-04   \n",
       "21436                                                NaN      2013-04-04   \n",
       "21437                                                NaN      2013-04-04   \n",
       "21438                                                NaN      2013-04-04   \n",
       "21439                                                NaN      2013-03-29   \n",
       "21440                                                NaN      2013-03-29   \n",
       "21441                                                NaN      2013-03-29   \n",
       "21442                                                NaN      2013-01-19   \n",
       "21443                                                NaN      2013-01-19   \n",
       "21444                                                NaN      2013-01-19   \n",
       "21445                                                NaN      2013-01-19   \n",
       "21446                                                NaN      2013-01-19   \n",
       "21447                                                NaN      2013-01-08   \n",
       "21448                                                NaN      2013-01-08   \n",
       "\n",
       "      Дата регистрации договора Идентификатор сделки  \\\n",
       "21431                       NaN             59780181   \n",
       "21432                       NaN             60230290   \n",
       "21433                       NaN             59982404   \n",
       "21434                       NaN             59982404   \n",
       "21435                       NaN             59763838   \n",
       "21436                       NaN             59763838   \n",
       "21437                       NaN             59763838   \n",
       "21438                       NaN             59763838   \n",
       "21439                       NaN             59188692   \n",
       "21440                       NaN             59188692   \n",
       "21441                       NaN             59188692   \n",
       "21442                       NaN             59044827   \n",
       "21443                       NaN             59044827   \n",
       "21444                       NaN             59044827   \n",
       "21445                       NaN             59044827   \n",
       "21446                       NaN             59044827   \n",
       "21447                       NaN             60075491   \n",
       "21448                       NaN             60075491   \n",
       "\n",
       "       Количество объектов в сделке  Цена в бел. руб.  \\\n",
       "21431                             1         107742.34   \n",
       "21432                            11          48690.97   \n",
       "21433                             6              0.00   \n",
       "21434                             6           2000.00   \n",
       "21435                            19          45000.00   \n",
       "21436                            19              0.00   \n",
       "21437                            19              0.00   \n",
       "21438                            19              0.00   \n",
       "21439                             7        1876852.23   \n",
       "21440                             7        1876852.23   \n",
       "21441                             7        1876852.23   \n",
       "21442                            15           5602.00   \n",
       "21443                            15           5602.00   \n",
       "21444                            15           5602.00   \n",
       "21445                            15           5602.00   \n",
       "21446                            15           5602.00   \n",
       "21447                            16              0.00   \n",
       "21448                            16              0.00   \n",
       "\n",
       "       Цена в бел. руб. за кв.м  \\\n",
       "21431                    454.42   \n",
       "21432                    113.02   \n",
       "21433                      0.00   \n",
       "21434                     17.83   \n",
       "21435                    419.38   \n",
       "21436                      0.00   \n",
       "21437                      0.00   \n",
       "21438                      0.00   \n",
       "21439                   3662.15   \n",
       "21440                  17218.83   \n",
       "21441                  52280.01   \n",
       "21442                     84.37   \n",
       "21443                     82.75   \n",
       "21444                     27.62   \n",
       "21445                     10.34   \n",
       "21446                      8.41   \n",
       "21447                      0.00   \n",
       "21448                      0.00   \n",
       "\n",
       "                                           Описание цены  Цена в долларах США  \\\n",
       "21431                                                NaN            113412.99   \n",
       "21432            Указана цена за 11 капитальных строений             53156.08   \n",
       "21433  цена указана в листе СА6 на капитальное строен...                 0.00   \n",
       "21434                  цена на пять капитальных строения              2304.15   \n",
       "21435  общая цена капитальных строений с инв. №№ 442/...             51724.14   \n",
       "21436  общая цена объектов указана в листе СА капитал...                 0.00   \n",
       "21437  общая цена объектов указана в листе СА капитал...                 0.00   \n",
       "21438  общая цена объектов указана в листе СА капитал...                 0.00   \n",
       "21439  цена указана в отношении изолированных помещен...           2162272.15   \n",
       "21440  цена указана в отношении изолированных помещен...           2162272.15   \n",
       "21441  цена указана в отношении изолированных помещен...           2162272.15   \n",
       "21442  Цена указана с учетом стоимости пятнадцати кап...              6506.39   \n",
       "21443  Цена указана с учетом стоимости пятнадцати кап...              6506.39   \n",
       "21444  Цена указана с учетом стоимости пятнадцати кап...              6506.39   \n",
       "21445  Цена указана с учетом стоимости пятнадцати кап...              6506.39   \n",
       "21446  Цена указана с учетом стоимости пятнадцати кап...              6506.39   \n",
       "21447  Цена за капитальные строения 600/С-137251, 600...                 0.00   \n",
       "21448  Цена за строения 600/С-137251, 600/С-137252, 6...                 0.00   \n",
       "\n",
       "       Цена в долларах США за кв.м  Цена в евро  Цена в евро за кв.м Тип цены  \\\n",
       "21431                       478.33     82434.84               347.68      NaN   \n",
       "21432                       123.39     38582.39                89.56      NaN   \n",
       "21433                         0.00         0.00                 0.00      NaN   \n",
       "21434                        20.54      1777.78                15.84      NaN   \n",
       "21435                       482.05     40394.97               376.47      NaN   \n",
       "21436                         0.00         0.00                 0.00      NaN   \n",
       "21437                         0.00         0.00                 0.00      NaN   \n",
       "21438                         0.00         0.00                 0.00      NaN   \n",
       "21439                      4219.07   1689335.94              3296.27      NaN   \n",
       "21440                     19837.36   1689335.94             15498.49      NaN   \n",
       "21441                     60230.42   1689335.94             47056.71      NaN   \n",
       "21442                        97.99      4858.63                73.17      NaN   \n",
       "21443                        96.11      4858.63                71.77      NaN   \n",
       "21444                        32.08      4858.63                23.96      NaN   \n",
       "21445                        12.01      4858.63                 8.97      NaN   \n",
       "21446                         9.77      4858.63                 7.30      NaN   \n",
       "21447                         0.00         0.00                 0.00      NaN   \n",
       "21448                         0.00         0.00                 0.00      NaN   \n",
       "\n",
       "       Цена по договору Валюта по договору Переходящая доля  \\\n",
       "21431               NaN                NaN              NaN   \n",
       "21432               NaN                NaN              NaN   \n",
       "21433               NaN                NaN              NaN   \n",
       "21434               NaN                NaN              NaN   \n",
       "21435               NaN                NaN              NaN   \n",
       "21436               NaN                NaN              NaN   \n",
       "21437               NaN                NaN              NaN   \n",
       "21438               NaN                NaN              NaN   \n",
       "21439               NaN                NaN              NaN   \n",
       "21440               NaN                NaN              NaN   \n",
       "21441               NaN                NaN              NaN   \n",
       "21442               NaN                NaN              NaN   \n",
       "21443               NaN                NaN              NaN   \n",
       "21444               NaN                NaN              NaN   \n",
       "21445               NaN                NaN              NaN   \n",
       "21446               NaN                NaN              NaN   \n",
       "21447               NaN                NaN              NaN   \n",
       "21448               NaN                NaN              NaN   \n",
       "\n",
       "       Количество комнат ИП Этаж расположения ИП Инвентарный номер КС  \\\n",
       "21431                   NaN                  NaN          451/C-12525   \n",
       "21432                   NaN                  NaN          710/C-60916   \n",
       "21433                   NaN                  NaN           111/C-7386   \n",
       "21434                   NaN                  NaN           111/C-7384   \n",
       "21435                   NaN                  NaN           442/C-6216   \n",
       "21436                   NaN                  NaN           442/C-6218   \n",
       "21437                   NaN                  NaN            442/C-112   \n",
       "21438                   NaN                  NaN           442/C-6213   \n",
       "21439                   NaN                  2-й          500/C-40304   \n",
       "21440                   NaN                  1-й          500/C-40304   \n",
       "21441                   NaN                  1-й          500/C-40304   \n",
       "21442                   NaN                  NaN          642/C-26794   \n",
       "21443                   NaN                  NaN          642/C-26810   \n",
       "21444                   NaN                  NaN          642/C-26798   \n",
       "21445                   NaN                  NaN          642/C-26801   \n",
       "21446                   NaN                  NaN          642/C-26792   \n",
       "21447                   NaN                  NaN         600/C-137246   \n",
       "21448                   NaN                  NaN         600/C-137243   \n",
       "\n",
       "       Общая площадь КС, кв.м  Жилая площадь КС, кв.м  \\\n",
       "21431                   237.1                     NaN   \n",
       "21432                   430.8                     NaN   \n",
       "21433                   402.8                     NaN   \n",
       "21434                   112.2                     NaN   \n",
       "21435                   107.3                     NaN   \n",
       "21436                   509.3                     NaN   \n",
       "21437                   547.6                     NaN   \n",
       "21438                    76.8                     NaN   \n",
       "21439                  2819.4                     NaN   \n",
       "21440                  2819.4                     NaN   \n",
       "21441                  2819.4                     NaN   \n",
       "21442                    66.4                     NaN   \n",
       "21443                    67.7                     NaN   \n",
       "21444                   202.8                     NaN   \n",
       "21445                   541.6                     NaN   \n",
       "21446                   665.8                     NaN   \n",
       "21447                   381.3                     NaN   \n",
       "21448                    69.6                     NaN   \n",
       "\n",
       "                                           Назначение КС  \\\n",
       "21431  Здание специализированное для лечебно-профилак...   \n",
       "21432                                     Здание нежилое   \n",
       "21433  Здание специализированное для общественного пи...   \n",
       "21434  Здание специализированное культурно-просветите...   \n",
       "21435               Здание административно-хозяйственное   \n",
       "21436                 Здание неустановленного назначения   \n",
       "21437  Здание специализированное для общественного пи...   \n",
       "21438  Здание специализированное здравоохранения и пр...   \n",
       "21439               Здание административно-хозяйственное   \n",
       "21440               Здание административно-хозяйственное   \n",
       "21441               Здание административно-хозяйственное   \n",
       "21442               Здание административно-хозяйственное   \n",
       "21443                                     Здание нежилое   \n",
       "21444  Здание специализированное для производства стр...   \n",
       "21445  Здание специализированное для производства стр...   \n",
       "21446  Здание специализированное для производства стр...   \n",
       "21447  Здание специализированное для общественного пи...   \n",
       "21448  Здание специализированное здравоохранения и пр...   \n",
       "\n",
       "                                  Описание назначения КС  \\\n",
       "21431  Здание специализированное для лечебно-профилак...   \n",
       "21432                                     Здание нежилое   \n",
       "21433  Здание специализированное для общественного пи...   \n",
       "21434  Здание специализированное культурно-просветите...   \n",
       "21435               Здание административно-хозяйственное   \n",
       "21436                 Здание неустановленного назначения   \n",
       "21437  Здание специализированное для общественного пи...   \n",
       "21438  Здание специализированное здравоохранения и пр...   \n",
       "21439               Здание административно-хозяйственное   \n",
       "21440               Здание административно-хозяйственное   \n",
       "21441               Здание административно-хозяйственное   \n",
       "21442               Здание административно-хозяйственное   \n",
       "21443                                     Здание нежилое   \n",
       "21444  Здание специализированное для производства стр...   \n",
       "21445  Здание специализированное для производства стр...   \n",
       "21446  Здание специализированное для производства стр...   \n",
       "21447  Здание специализированное для общественного пи...   \n",
       "21448  Здание специализированное здравоохранения и пр...   \n",
       "\n",
       "                            Наименование КС  Процент готовности КС  \\\n",
       "21431  Декоративное строении \"Русская баня\"                  100.0   \n",
       "21432                              Столовая                  100.0   \n",
       "21433                              пищеблок                  100.0   \n",
       "21434                                  клуб                  100.0   \n",
       "21435               административное здание                  100.0   \n",
       "21436                 склад-спальный корпус                  100.0   \n",
       "21437                              столовая                  100.0   \n",
       "21438                              медпункт                  100.0   \n",
       "21439  Административно-хозяйственное здание                  100.0   \n",
       "21440  Административно-хозяйственное здание                  100.0   \n",
       "21441  Административно-хозяйственное здание                  100.0   \n",
       "21442                               Контора                  100.0   \n",
       "21443               Механическая мастерская                  100.0   \n",
       "21444                         Галерея сушки                  100.0   \n",
       "21445               Производственный корпус                  100.0   \n",
       "21446                               Сушилка                  100.0   \n",
       "21447                              Столовая                  100.0   \n",
       "21448                              Медпункт                  100.0   \n",
       "\n",
       "       Количество надземных этажей, шт.  Количество подземных этажей, шт.  \\\n",
       "21431                               2.0                               NaN   \n",
       "21432                               1.0                               NaN   \n",
       "21433                               1.0                               NaN   \n",
       "21434                               1.0                               NaN   \n",
       "21435                               1.0                               NaN   \n",
       "21436                               1.0                               NaN   \n",
       "21437                               1.0                               NaN   \n",
       "21438                               1.0                               NaN   \n",
       "21439                               5.0                               NaN   \n",
       "21440                               5.0                               NaN   \n",
       "21441                               5.0                               NaN   \n",
       "21442                               1.0                               NaN   \n",
       "21443                               2.0                               NaN   \n",
       "21444                               1.0                               NaN   \n",
       "21445                               1.0                               NaN   \n",
       "21446                               1.0                               NaN   \n",
       "21447                               1.0                               NaN   \n",
       "21448                               1.0                               NaN   \n",
       "\n",
       "                     Составные элементы и принадлежности Кадастровый номер ЗУ  \\\n",
       "21431                                              Склад   422382300602000045   \n",
       "21432                                  крыльца, отмостка   720800000030000001   \n",
       "21433  Одноэтажное сборно-щитовое здание пищеблока с ...   125083103101000001   \n",
       "21434  Одноэтажное сборно-щитовое облицованное кирпич...   125083103101000001   \n",
       "21435                                                NaN   424680407101000025   \n",
       "21436                                                NaN   424680407101000025   \n",
       "21437                                                NaN   424680407101000025   \n",
       "21438                                                NaN   424680407101000025   \n",
       "21439                                                NaN   500000000006002847   \n",
       "21440                                                NaN   500000000006002847   \n",
       "21441                                                NaN   500000000006002847   \n",
       "21442                  Одноэтажное кирпичное здание А1/к   622881700001000007   \n",
       "21443                  Двухэтажное кирпичное здание А2/к   622881700001000007   \n",
       "21444  Одноэтажное кирпичное здание А1/к с двумя прис...   622881700001000007   \n",
       "21445                  Одноэтажное кирпичное здание А1/к   622881700001000007   \n",
       "21446                  Одноэтажное кирпичное здание А1/к   622881700001000007   \n",
       "21447  Одноэтажное кирпичное здание столовой с пристр...   623683400001000568   \n",
       "21448  Одноэтажное кирпичное здание медпункта с крыльцом   623683400001000568   \n",
       "\n",
       "                                           Назначение ЗУ  \\\n",
       "21431  Земельный участок для размещения объектов физк...   \n",
       "21432  Земельный участок для размещения объектов здра...   \n",
       "21433  Земельный участок для размещения объектов физк...   \n",
       "21434  Земельный участок для размещения объектов физк...   \n",
       "21435  Земельный участок для размещения объектов неус...   \n",
       "21436  Земельный участок для размещения объектов неус...   \n",
       "21437  Земельный участок для размещения объектов неус...   \n",
       "21438  Земельный участок для размещения объектов неус...   \n",
       "21439  Земельный участок для размещения объектов адми...   \n",
       "21440  Земельный участок для размещения объектов адми...   \n",
       "21441  Земельный участок для размещения объектов адми...   \n",
       "21442  Земельный участок для иных сельскохозяйственны...   \n",
       "21443  Земельный участок для иных сельскохозяйственны...   \n",
       "21444  Земельный участок для иных сельскохозяйственны...   \n",
       "21445  Земельный участок для иных сельскохозяйственны...   \n",
       "21446  Земельный участок для иных сельскохозяйственны...   \n",
       "21447  Земельный участок для размещения объектов физк...   \n",
       "21448  Земельный участок для размещения объектов физк...   \n",
       "\n",
       "      Описание назначения ЗУ  Площадь ЗУ, кв.м  Уникальный номер АТЕ  \\\n",
       "21431                    NaN            4997.0                   NaN   \n",
       "21432                    NaN           42000.0                   NaN   \n",
       "21433                    NaN           58989.0                   NaN   \n",
       "21434                    NaN           58989.0                   NaN   \n",
       "21435                    NaN            4542.0                   NaN   \n",
       "21436                    NaN            4542.0                   NaN   \n",
       "21437                    NaN            4542.0                   NaN   \n",
       "21438                    NaN            4542.0                   NaN   \n",
       "21439                    NaN            2481.0                   NaN   \n",
       "21440                    NaN            2481.0                   NaN   \n",
       "21441                    NaN            2481.0                   NaN   \n",
       "21442                    NaN          465052.0                   NaN   \n",
       "21443                    NaN          465052.0                   NaN   \n",
       "21444                    NaN          465052.0                   NaN   \n",
       "21445                    NaN          465052.0                   NaN   \n",
       "21446                    NaN          465052.0                   NaN   \n",
       "21447                    NaN           38765.0                   NaN   \n",
       "21448                    NaN           38765.0                   NaN   \n",
       "\n",
       "                                                 Маркеры  \\\n",
       "21431  Продажа объекта с составными частями и принадл...   \n",
       "21432  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21433  Нерепрезентативная сделка; Отсутствует дата вв...   \n",
       "21434  Нерепрезентативная сделка; Отсутствует дата вв...   \n",
       "21435  Нерепрезентативная сделка; Отсутствует дата вв...   \n",
       "21436  Нерепрезентативная сделка; Отсутствует дата вв...   \n",
       "21437  Нерепрезентативная сделка; Отсутствует цена до...   \n",
       "21438  Нерепрезентативная сделка; Отсутствует дата вв...   \n",
       "21439  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21440  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21441            Продажа нескольких объектов в комплексе   \n",
       "21442  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21443  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21444  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21445  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21446  Продажа нескольких объектов в комплексе; Прода...   \n",
       "21447  Нерепрезентативная сделка; Отсутствует цена до...   \n",
       "21448  Нерепрезентативная сделка; Отсутствует цена до...   \n",
       "\n",
       "      Дата проведения обследования КС / РХ  Объем КС, куб.м / РХ  \\\n",
       "21431                                  NaN                   NaN   \n",
       "21432                                  NaN                   NaN   \n",
       "21433                                  NaN                   NaN   \n",
       "21434                                  NaN                   NaN   \n",
       "21435                                  NaN                   NaN   \n",
       "21436                                  NaN                   NaN   \n",
       "21437                                  NaN                   NaN   \n",
       "21438                                  NaN                   NaN   \n",
       "21439                                  NaN                   NaN   \n",
       "21440                                  NaN                   NaN   \n",
       "21441                                  NaN                   NaN   \n",
       "21442                                  NaN                   NaN   \n",
       "21443                                  NaN                   NaN   \n",
       "21444                                  NaN                   NaN   \n",
       "21445                                  NaN                   NaN   \n",
       "21446                                  NaN                   NaN   \n",
       "21447                                  NaN                   NaN   \n",
       "21448                                  NaN                   NaN   \n",
       "\n",
       "       Общая площадь жилых помещений КС, кв.м / РХ  \\\n",
       "21431                                          NaN   \n",
       "21432                                          NaN   \n",
       "21433                                          NaN   \n",
       "21434                                          NaN   \n",
       "21435                                          NaN   \n",
       "21436                                          NaN   \n",
       "21437                                          NaN   \n",
       "21438                                          NaN   \n",
       "21439                                          NaN   \n",
       "21440                                          NaN   \n",
       "21441                                          NaN   \n",
       "21442                                          NaN   \n",
       "21443                                          NaN   \n",
       "21444                                          NaN   \n",
       "21445                                          NaN   \n",
       "21446                                          NaN   \n",
       "21447                                          NaN   \n",
       "21448                                          NaN   \n",
       "\n",
       "       Общая площадь нежилых помещений КС, кв.м / РХ  \\\n",
       "21431                                            NaN   \n",
       "21432                                            NaN   \n",
       "21433                                            NaN   \n",
       "21434                                            NaN   \n",
       "21435                                            NaN   \n",
       "21436                                            NaN   \n",
       "21437                                            NaN   \n",
       "21438                                            NaN   \n",
       "21439                                            NaN   \n",
       "21440                                            NaN   \n",
       "21441                                            NaN   \n",
       "21442                                            NaN   \n",
       "21443                                            NaN   \n",
       "21444                                            NaN   \n",
       "21445                                            NaN   \n",
       "21446                                            NaN   \n",
       "21447                                            NaN   \n",
       "21448                                            NaN   \n",
       "\n",
       "       Количество изолированных помещений (квартир) КС / РХ  \\\n",
       "21431                                                NaN      \n",
       "21432                                                NaN      \n",
       "21433                                                NaN      \n",
       "21434                                                NaN      \n",
       "21435                                                NaN      \n",
       "21436                                                NaN      \n",
       "21437                                                NaN      \n",
       "21438                                                NaN      \n",
       "21439                                                NaN      \n",
       "21440                                                NaN      \n",
       "21441                                                NaN      \n",
       "21442                                                NaN      \n",
       "21443                                                NaN      \n",
       "21444                                                NaN      \n",
       "21445                                                NaN      \n",
       "21446                                                NaN      \n",
       "21447                                                NaN      \n",
       "21448                                                NaN      \n",
       "\n",
       "       Физический износ на дату обследования КС, % / РХ  \\\n",
       "21431                                               NaN   \n",
       "21432                                               NaN   \n",
       "21433                                               NaN   \n",
       "21434                                               NaN   \n",
       "21435                                               NaN   \n",
       "21436                                               NaN   \n",
       "21437                                               NaN   \n",
       "21438                                               NaN   \n",
       "21439                                               NaN   \n",
       "21440                                               NaN   \n",
       "21441                                               NaN   \n",
       "21442                                               NaN   \n",
       "21443                                               NaN   \n",
       "21444                                               NaN   \n",
       "21445                                               NaN   \n",
       "21446                                               NaN   \n",
       "21447                                               NaN   \n",
       "21448                                               NaN   \n",
       "\n",
       "      Наличие холодного водоснабжения КС / РХ  \\\n",
       "21431                                     NaN   \n",
       "21432                                     NaN   \n",
       "21433                                     NaN   \n",
       "21434                                     NaN   \n",
       "21435                                     NaN   \n",
       "21436                                     NaN   \n",
       "21437                                     NaN   \n",
       "21438                                     NaN   \n",
       "21439                                     NaN   \n",
       "21440                                     NaN   \n",
       "21441                                     NaN   \n",
       "21442                                     NaN   \n",
       "21443                                     NaN   \n",
       "21444                                     NaN   \n",
       "21445                                     NaN   \n",
       "21446                                     NaN   \n",
       "21447                                     NaN   \n",
       "21448                                     NaN   \n",
       "\n",
       "      Наличие горячего водоснабжения КС / РХ Наличие канализации КС / РХ  \\\n",
       "21431                                    NaN                         NaN   \n",
       "21432                                    NaN                         NaN   \n",
       "21433                                    NaN                         NaN   \n",
       "21434                                    NaN                         NaN   \n",
       "21435                                    NaN                         NaN   \n",
       "21436                                    NaN                         NaN   \n",
       "21437                                    NaN                         NaN   \n",
       "21438                                    NaN                         NaN   \n",
       "21439                                    NaN                         NaN   \n",
       "21440                                    NaN                         NaN   \n",
       "21441                                    NaN                         NaN   \n",
       "21442                                    NaN                         NaN   \n",
       "21443                                    NaN                         NaN   \n",
       "21444                                    NaN                         NaN   \n",
       "21445                                    NaN                         NaN   \n",
       "21446                                    NaN                         NaN   \n",
       "21447                                    NaN                         NaN   \n",
       "21448                                    NaN                         NaN   \n",
       "\n",
       "      Наличие отопления КС / РХ Наличие газоснабжения КС / РХ  \\\n",
       "21431                       NaN                           NaN   \n",
       "21432                       NaN                           NaN   \n",
       "21433                       NaN                           NaN   \n",
       "21434                       NaN                           NaN   \n",
       "21435                       NaN                           NaN   \n",
       "21436                       NaN                           NaN   \n",
       "21437                       NaN                           NaN   \n",
       "21438                       NaN                           NaN   \n",
       "21439                       NaN                           NaN   \n",
       "21440                       NaN                           NaN   \n",
       "21441                       NaN                           NaN   \n",
       "21442                       NaN                           NaN   \n",
       "21443                       NaN                           NaN   \n",
       "21444                       NaN                           NaN   \n",
       "21445                       NaN                           NaN   \n",
       "21446                       NaN                           NaN   \n",
       "21447                       NaN                           NaN   \n",
       "21448                       NaN                           NaN   \n",
       "\n",
       "      Наличие электроснабжения КС / РХ Наличие ванн (душей) КС / РХ  \\\n",
       "21431                              NaN                          NaN   \n",
       "21432                              NaN                          NaN   \n",
       "21433                              NaN                          NaN   \n",
       "21434                              NaN                          NaN   \n",
       "21435                              NaN                          NaN   \n",
       "21436                              NaN                          NaN   \n",
       "21437                              NaN                          NaN   \n",
       "21438                              NaN                          NaN   \n",
       "21439                              NaN                          NaN   \n",
       "21440                              NaN                          NaN   \n",
       "21441                              NaN                          NaN   \n",
       "21442                              NaN                          NaN   \n",
       "21443                              NaN                          NaN   \n",
       "21444                              NaN                          NaN   \n",
       "21445                              NaN                          NaN   \n",
       "21446                              NaN                          NaN   \n",
       "21447                              NaN                          NaN   \n",
       "21448                              NaN                          NaN   \n",
       "\n",
       "      Наличие напольных электроплит КС / РХ Материал  крыши (кровли) КС / РХ  \\\n",
       "21431                                   NaN                              NaN   \n",
       "21432                                   NaN                              NaN   \n",
       "21433                                   NaN                              NaN   \n",
       "21434                                   NaN                              NaN   \n",
       "21435                                   NaN                              NaN   \n",
       "21436                                   NaN                              NaN   \n",
       "21437                                   NaN                              NaN   \n",
       "21438                                   NaN                              NaN   \n",
       "21439                                   NaN                              NaN   \n",
       "21440                                   NaN                              NaN   \n",
       "21441                                   NaN                              NaN   \n",
       "21442                                   NaN                              NaN   \n",
       "21443                                   NaN                              NaN   \n",
       "21444                                   NaN                              NaN   \n",
       "21445                                   NaN                              NaN   \n",
       "21446                                   NaN                              NaN   \n",
       "21447                                   NaN                              NaN   \n",
       "21448                                   NaN                              NaN   \n",
       "\n",
       "      Материал фундамента КС / РХ Материал перекрытий КС / РХ  \\\n",
       "21431                         NaN                         NaN   \n",
       "21432                         NaN                         NaN   \n",
       "21433                         NaN                         NaN   \n",
       "21434                         NaN                         NaN   \n",
       "21435                         NaN                         NaN   \n",
       "21436                         NaN                         NaN   \n",
       "21437                         NaN                         NaN   \n",
       "21438                         NaN                         NaN   \n",
       "21439                         NaN                         NaN   \n",
       "21440                         NaN                         NaN   \n",
       "21441                         NaN                         NaN   \n",
       "21442                         NaN                         NaN   \n",
       "21443                         NaN                         NaN   \n",
       "21444                         NaN                         NaN   \n",
       "21445                         NaN                         NaN   \n",
       "21446                         NaN                         NaN   \n",
       "21447                         NaN                         NaN   \n",
       "21448                         NaN                         NaN   \n",
       "\n",
       "      Стоимости КС / РХ sheet_source search_param  \\\n",
       "21431               NaN      РБ баня            -   \n",
       "21432               NaN      РБ баня            -   \n",
       "21433               NaN      РБ баня            -   \n",
       "21434               NaN      РБ баня            -   \n",
       "21435               NaN      РБ баня            -   \n",
       "21436               NaN      РБ баня            -   \n",
       "21437               NaN      РБ баня            -   \n",
       "21438               NaN      РБ баня            -   \n",
       "21439               NaN      РБ баня            -   \n",
       "21440               NaN      РБ баня            -   \n",
       "21441               NaN      РБ баня            -   \n",
       "21442               NaN      РБ баня            -   \n",
       "21443               NaN      РБ баня            -   \n",
       "21444               NaN      РБ баня            -   \n",
       "21445               NaN      РБ баня            -   \n",
       "21446               NaN      РБ баня            -   \n",
       "21447               NaN      РБ баня            -   \n",
       "21448               NaN      РБ баня            -   \n",
       "\n",
       "      Распределение долей до сделки Распределение долей после сделки  \\\n",
       "21431                         {1/1}                            {1/1}   \n",
       "21432                         {1/1}                            {1/1}   \n",
       "21433                         {1/1}                            {1/1}   \n",
       "21434                         {1/1}                            {1/1}   \n",
       "21435                         {1/1}                            {1/1}   \n",
       "21436                         {1/1}                            {1/1}   \n",
       "21437                         {1/1}                            {1/1}   \n",
       "21438                         {1/1}                            {1/1}   \n",
       "21439                         {1/1}                            {1/1}   \n",
       "21440                         {1/1}                            {1/1}   \n",
       "21441                         {1/1}                            {1/1}   \n",
       "21442                         {1/1}                            {1/1}   \n",
       "21443                         {1/1}                            {1/1}   \n",
       "21444                         {1/1}                            {1/1}   \n",
       "21445                         {1/1}                            {1/1}   \n",
       "21446                         {1/1}                            {1/1}   \n",
       "21447                         {1/1}                            {1/1}   \n",
       "21448                         {1/1}                            {1/1}   \n",
       "\n",
       "       Исходная цена    Исходная валюта  п/п  floor      category  \\\n",
       "21431   1.077423e+09  белорусский рубль  NaN    NaN           NaN   \n",
       "21432   4.869097e+08  белорусский рубль  NaN    NaN          офис   \n",
       "21433   0.000000e+00  белорусский рубль  NaN    NaN      торговля   \n",
       "21434   2.000000e+07  белорусский рубль  NaN    NaN          офис   \n",
       "21435   4.500000e+08  белорусский рубль  NaN    NaN          офис   \n",
       "21436   0.000000e+00  белорусский рубль  NaN    NaN         склад   \n",
       "21437   0.000000e+00  белорусский рубль  NaN    NaN      торговля   \n",
       "21438   0.000000e+00  белорусский рубль  NaN    NaN          офис   \n",
       "21439   2.162272e+06         доллар США  NaN    2.0          офис   \n",
       "21440   2.162272e+06         доллар США  NaN    1.0  производство   \n",
       "21441   2.162272e+06         доллар США  NaN    1.0         склад   \n",
       "21442   5.602000e+07  белорусский рубль  NaN    NaN          офис   \n",
       "21443   5.602000e+07  белорусский рубль  NaN    NaN  производство   \n",
       "21444   5.602000e+07  белорусский рубль  NaN    NaN           NaN   \n",
       "21445   5.602000e+07  белорусский рубль  NaN    NaN  производство   \n",
       "21446   5.602000e+07  белорусский рубль  NaN    NaN           NaN   \n",
       "21447   0.000000e+00  белорусский рубль  NaN    NaN      торговля   \n",
       "21448   0.000000e+00  белорусский рубль  NaN    NaN          офис   \n",
       "\n",
       "       for_clusters_gr Name NP  Name region  Name oblast  cluster_score  \\\n",
       "21431                1      -1   дятловский  гродненская           96.0   \n",
       "21432                1      -1           -1  могилевская          418.0   \n",
       "21433                1      -1  ляховичский    брестская          161.0   \n",
       "21434                1      -1  ляховичский    брестская          161.0   \n",
       "21435                1      -1  островецкий  гродненская          191.0   \n",
       "21436                0      -1  островецкий  гродненская           45.0   \n",
       "21437                1      -1  островецкий  гродненская          191.0   \n",
       "21438                1      -1  островецкий  гродненская          191.0   \n",
       "21439                1   минск           -1           -1         1027.0   \n",
       "21440                0   минск           -1           -1          287.0   \n",
       "21441                0   минск           -1           -1          287.0   \n",
       "21442                1      -1   копыльский      минская          137.0   \n",
       "21443                0      -1   копыльский      минская           31.0   \n",
       "21444               -1      -1           -1           -1           -1.0   \n",
       "21445                0      -1   копыльский      минская           31.0   \n",
       "21446               -1      -1           -1           -1           -1.0   \n",
       "21447                1      -1      минский      минская          461.0   \n",
       "21448                1      -1      минский      минская          461.0   \n",
       "\n",
       "      cluster Дата  1 Евро (EUR)  1 Российский рубль (RUB)  1 Доллар США (USD)  \n",
       "21431       F  NaT           NaN                       NaN                 NaN  \n",
       "21432       E  NaT           NaN                       NaN                 NaN  \n",
       "21433       E  NaT           NaN                       NaN                 NaN  \n",
       "21434       E  NaT           NaN                       NaN                 NaN  \n",
       "21435       D  NaT           NaN                       NaN                 NaN  \n",
       "21436       D  NaT           NaN                       NaN                 NaN  \n",
       "21437       D  NaT           NaN                       NaN                 NaN  \n",
       "21438       D  NaT           NaN                       NaN                 NaN  \n",
       "21439       A  NaT           NaN                       NaN                 NaN  \n",
       "21440       A  NaT           NaN                       NaN                 NaN  \n",
       "21441       A  NaT           NaN                       NaN                 NaN  \n",
       "21442       E  NaT           NaN                       NaN                 NaN  \n",
       "21443       E  NaT           NaN                       NaN                 NaN  \n",
       "21444   undef  NaT           NaN                       NaN                 NaN  \n",
       "21445       E  NaT           NaN                       NaN                 NaN  \n",
       "21446   undef  NaT           NaN                       NaN                 NaN  \n",
       "21447       B  NaT           NaN                       NaN                 NaN  \n",
       "21448       B  NaT           NaN                       NaN                 NaN  "
      ]
     },
     "execution_count": 97,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[total_df_merged[\"1 Доллар США (USD)\"].isna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "64100efd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Тип недвижимого имущества', 'Инвентарный номер', 'Адрес', 'Назначение',\n",
       "       'Описание назначения', 'Наименование', 'Общая площадь, кв.м',\n",
       "       'Жилая площадь, кв.м', 'Материал стен', 'Дата ввода',\n",
       "       'Дата консервации',\n",
       "       'Дата реконструкции (реставрации, капитального ремонта)', 'Дата сделки',\n",
       "       'Дата регистрации договора', 'Идентификатор сделки',\n",
       "       'Количество объектов в сделке', 'Цена в бел. руб.',\n",
       "       'Цена в бел. руб. за кв.м', 'Описание цены', 'Цена в долларах США',\n",
       "       'Цена в долларах США за кв.м', 'Цена в евро', 'Цена в евро за кв.м',\n",
       "       'Тип цены', 'Цена по договору', 'Валюта по договору',\n",
       "       'Переходящая доля', 'Количество комнат ИП', 'Этаж расположения ИП',\n",
       "       'Инвентарный номер КС', 'Общая площадь КС, кв.м',\n",
       "       'Жилая площадь КС, кв.м', 'Назначение КС', 'Описание назначения КС',\n",
       "       'Наименование КС', 'Процент готовности КС',\n",
       "       'Количество надземных этажей, шт.', 'Количество подземных этажей, шт.',\n",
       "       'Составные элементы и принадлежности', 'Кадастровый номер ЗУ',\n",
       "       'Назначение ЗУ', 'Описание назначения ЗУ', 'Площадь ЗУ, кв.м',\n",
       "       'Уникальный номер АТЕ', 'Маркеры',\n",
       "       'Дата проведения обследования КС / РХ', 'Объем КС, куб.м / РХ',\n",
       "       'Общая площадь жилых помещений КС, кв.м / РХ',\n",
       "       'Общая площадь нежилых помещений КС, кв.м / РХ',\n",
       "       'Количество изолированных помещений (квартир) КС / РХ',\n",
       "       'Физический износ на дату обследования КС, % / РХ',\n",
       "       'Наличие холодного водоснабжения КС / РХ',\n",
       "       'Наличие горячего водоснабжения КС / РХ', 'Наличие канализации КС / РХ',\n",
       "       'Наличие отопления КС / РХ', 'Наличие газоснабжения КС / РХ',\n",
       "       'Наличие электроснабжения КС / РХ', 'Наличие ванн (душей) КС / РХ',\n",
       "       'Наличие напольных электроплит КС / РХ',\n",
       "       'Материал  крыши (кровли) КС / РХ', 'Материал фундамента КС / РХ',\n",
       "       'Материал перекрытий КС / РХ', 'Стоимости КС / РХ', 'sheet_source',\n",
       "       'search_param', 'Распределение долей до сделки',\n",
       "       'Распределение долей после сделки', 'Исходная цена', 'Исходная валюта',\n",
       "       'п/п', 'floor', 'category', 'for_clusters_gr', 'Name NP', 'Name region',\n",
       "       'Name oblast', 'cluster_score', 'cluster', 'Дата', '1 Евро (EUR)',\n",
       "       '1 Российский рубль (RUB)', '1 Доллар США (USD)'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 98,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "id": "1c1b71f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "rub = pd.to_numeric(total_df_merged[\"Цена в бел. руб.\"], errors=\"coerce\")\n",
    "usd = pd.to_numeric(\n",
    "    total_df_merged[\"Цена в долларах США\"], errors=\"coerce\"\n",
    ").replace(0, np.nan)\n",
    "\n",
    "rate_usd_by_date = (\n",
    "    rub.div(usd).groupby(total_df_merged[\"Дата сделки\"]).transform(\"max\")\n",
    ")\n",
    "\n",
    "total_df_merged[\"1 Доллар США (USD)\"] = (\n",
    "    pd.to_numeric(total_df_merged[\"1 Доллар США (USD)\"], errors=\"coerce\")\n",
    "    .fillna(rate_usd_by_date)\n",
    "    .round(4)\n",
    ")\n",
    "\n",
    "# --- EUR ---\n",
    "eur = pd.to_numeric(total_df_merged[\"Цена в евро\"], errors=\"coerce\").replace(\n",
    "    0, np.nan\n",
    ")\n",
    "\n",
    "rate_eur_by_date = (\n",
    "    rub.div(eur).groupby(total_df_merged[\"Дата сделки\"]).transform(\"max\")\n",
    ")\n",
    "\n",
    "total_df_merged[\"1 Евро (EUR)\"] = (\n",
    "    pd.to_numeric(total_df_merged[\"1 Евро (EUR)\"], errors=\"coerce\")\n",
    "    .fillna(rate_eur_by_date)\n",
    "    .round(4)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "26190bab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <th>Адрес</th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Описание назначения</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <th>Материал стен</th>\n",
       "      <th>Дата ввода</th>\n",
       "      <th>Дата консервации</th>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <th>Тип цены</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Валюта по договору</th>\n",
       "      <th>Переходящая доля</th>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <th>Назначение КС</th>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <th>Наименование КС</th>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <th>Маркеры</th>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>search_param</th>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <th>Исходная цена</th>\n",
       "      <th>Исходная валюта</th>\n",
       "      <th>п/п</th>\n",
       "      <th>floor</th>\n",
       "      <th>category</th>\n",
       "      <th>for_clusters_gr</th>\n",
       "      <th>Name NP</th>\n",
       "      <th>Name region</th>\n",
       "      <th>Name oblast</th>\n",
       "      <th>cluster_score</th>\n",
       "      <th>cluster</th>\n",
       "      <th>Дата</th>\n",
       "      <th>1 Евро (EUR)</th>\n",
       "      <th>1 Российский рубль (RUB)</th>\n",
       "      <th>1 Доллар США (USD)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>21447</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>600/C-137246</td>\n",
       "      <td>Республика Беларусь,Минская обл., Минский р-н,...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>381.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1958-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>60075491</td>\n",
       "      <td>16</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Цена за капитальные строения 600/С-137251, 600...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>600/C-137246</td>\n",
       "      <td>381.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Здание специализированное для общественного пи...</td>\n",
       "      <td>Столовая</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание столовой с пристр...</td>\n",
       "      <td>623683400001000568</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38765.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует цена до...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.0</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>минский</td>\n",
       "      <td>минская</td>\n",
       "      <td>461.0</td>\n",
       "      <td>B</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21448</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>600/C-137243</td>\n",
       "      <td>Республика Беларусь,Минская обл., Минский р-н,...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Медпункт</td>\n",
       "      <td>69.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич толщиной кладки до 45 см</td>\n",
       "      <td>1958-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>60075491</td>\n",
       "      <td>16</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Цена за строения 600/С-137251, 600/С-137252, 6...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>600/C-137243</td>\n",
       "      <td>69.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Здание специализированное здравоохранения и пр...</td>\n",
       "      <td>Медпункт</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Одноэтажное кирпичное здание медпункта с крыльцом</td>\n",
       "      <td>623683400001000568</td>\n",
       "      <td>Земельный участок для размещения объектов физк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38765.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Нерепрезентативная сделка; Отсутствует цена до...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ баня</td>\n",
       "      <td>-</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>{1/1}</td>\n",
       "      <td>0.0</td>\n",
       "      <td>белорусский рубль</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>минский</td>\n",
       "      <td>минская</td>\n",
       "      <td>461.0</td>\n",
       "      <td>B</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Тип недвижимого имущества Инвентарный номер  \\\n",
       "21447      Капитальное строение      600/C-137246   \n",
       "21448      Капитальное строение      600/C-137243   \n",
       "\n",
       "                                                   Адрес  \\\n",
       "21447  Республика Беларусь,Минская обл., Минский р-н,...   \n",
       "21448  Республика Беларусь,Минская обл., Минский р-н,...   \n",
       "\n",
       "                                              Назначение  \\\n",
       "21447  Здание специализированное для общественного пи...   \n",
       "21448  Здание специализированное здравоохранения и пр...   \n",
       "\n",
       "                                     Описание назначения Наименование  \\\n",
       "21447  Здание специализированное для общественного пи...     Столовая   \n",
       "21448  Здание специализированное здравоохранения и пр...     Медпункт   \n",
       "\n",
       "       Общая площадь, кв.м  Жилая площадь, кв.м  \\\n",
       "21447                381.3                  NaN   \n",
       "21448                 69.6                  NaN   \n",
       "\n",
       "                         Материал стен           Дата ввода Дата консервации  \\\n",
       "21447  Кирпич толщиной кладки до 45 см  1958-01-01 00:00:00              NaN   \n",
       "21448  Кирпич толщиной кладки до 45 см  1958-01-01 00:00:00              NaN   \n",
       "\n",
       "      Дата реконструкции (реставрации, капитального ремонта) Дата сделки  \\\n",
       "21447                                                NaN      2013-01-08   \n",
       "21448                                                NaN      2013-01-08   \n",
       "\n",
       "      Дата регистрации договора Идентификатор сделки  \\\n",
       "21447                       NaN             60075491   \n",
       "21448                       NaN             60075491   \n",
       "\n",
       "       Количество объектов в сделке  Цена в бел. руб.  \\\n",
       "21447                            16               0.0   \n",
       "21448                            16               0.0   \n",
       "\n",
       "       Цена в бел. руб. за кв.м  \\\n",
       "21447                       0.0   \n",
       "21448                       0.0   \n",
       "\n",
       "                                           Описание цены  Цена в долларах США  \\\n",
       "21447  Цена за капитальные строения 600/С-137251, 600...                  0.0   \n",
       "21448  Цена за строения 600/С-137251, 600/С-137252, 6...                  0.0   \n",
       "\n",
       "       Цена в долларах США за кв.м  Цена в евро  Цена в евро за кв.м Тип цены  \\\n",
       "21447                          0.0          0.0                  0.0      NaN   \n",
       "21448                          0.0          0.0                  0.0      NaN   \n",
       "\n",
       "       Цена по договору Валюта по договору Переходящая доля  \\\n",
       "21447               NaN                NaN              NaN   \n",
       "21448               NaN                NaN              NaN   \n",
       "\n",
       "       Количество комнат ИП Этаж расположения ИП Инвентарный номер КС  \\\n",
       "21447                   NaN                  NaN         600/C-137246   \n",
       "21448                   NaN                  NaN         600/C-137243   \n",
       "\n",
       "       Общая площадь КС, кв.м  Жилая площадь КС, кв.м  \\\n",
       "21447                   381.3                     NaN   \n",
       "21448                    69.6                     NaN   \n",
       "\n",
       "                                           Назначение КС  \\\n",
       "21447  Здание специализированное для общественного пи...   \n",
       "21448  Здание специализированное здравоохранения и пр...   \n",
       "\n",
       "                                  Описание назначения КС Наименование КС  \\\n",
       "21447  Здание специализированное для общественного пи...        Столовая   \n",
       "21448  Здание специализированное здравоохранения и пр...        Медпункт   \n",
       "\n",
       "       Процент готовности КС  Количество надземных этажей, шт.  \\\n",
       "21447                  100.0                               1.0   \n",
       "21448                  100.0                               1.0   \n",
       "\n",
       "       Количество подземных этажей, шт.  \\\n",
       "21447                               NaN   \n",
       "21448                               NaN   \n",
       "\n",
       "                     Составные элементы и принадлежности Кадастровый номер ЗУ  \\\n",
       "21447  Одноэтажное кирпичное здание столовой с пристр...   623683400001000568   \n",
       "21448  Одноэтажное кирпичное здание медпункта с крыльцом   623683400001000568   \n",
       "\n",
       "                                           Назначение ЗУ  \\\n",
       "21447  Земельный участок для размещения объектов физк...   \n",
       "21448  Земельный участок для размещения объектов физк...   \n",
       "\n",
       "      Описание назначения ЗУ  Площадь ЗУ, кв.м  Уникальный номер АТЕ  \\\n",
       "21447                    NaN           38765.0                   NaN   \n",
       "21448                    NaN           38765.0                   NaN   \n",
       "\n",
       "                                                 Маркеры  \\\n",
       "21447  Нерепрезентативная сделка; Отсутствует цена до...   \n",
       "21448  Нерепрезентативная сделка; Отсутствует цена до...   \n",
       "\n",
       "      Дата проведения обследования КС / РХ  Объем КС, куб.м / РХ  \\\n",
       "21447                                  NaN                   NaN   \n",
       "21448                                  NaN                   NaN   \n",
       "\n",
       "       Общая площадь жилых помещений КС, кв.м / РХ  \\\n",
       "21447                                          NaN   \n",
       "21448                                          NaN   \n",
       "\n",
       "       Общая площадь нежилых помещений КС, кв.м / РХ  \\\n",
       "21447                                            NaN   \n",
       "21448                                            NaN   \n",
       "\n",
       "       Количество изолированных помещений (квартир) КС / РХ  \\\n",
       "21447                                                NaN      \n",
       "21448                                                NaN      \n",
       "\n",
       "       Физический износ на дату обследования КС, % / РХ  \\\n",
       "21447                                               NaN   \n",
       "21448                                               NaN   \n",
       "\n",
       "      Наличие холодного водоснабжения КС / РХ  \\\n",
       "21447                                     NaN   \n",
       "21448                                     NaN   \n",
       "\n",
       "      Наличие горячего водоснабжения КС / РХ Наличие канализации КС / РХ  \\\n",
       "21447                                    NaN                         NaN   \n",
       "21448                                    NaN                         NaN   \n",
       "\n",
       "      Наличие отопления КС / РХ Наличие газоснабжения КС / РХ  \\\n",
       "21447                       NaN                           NaN   \n",
       "21448                       NaN                           NaN   \n",
       "\n",
       "      Наличие электроснабжения КС / РХ Наличие ванн (душей) КС / РХ  \\\n",
       "21447                              NaN                          NaN   \n",
       "21448                              NaN                          NaN   \n",
       "\n",
       "      Наличие напольных электроплит КС / РХ Материал  крыши (кровли) КС / РХ  \\\n",
       "21447                                   NaN                              NaN   \n",
       "21448                                   NaN                              NaN   \n",
       "\n",
       "      Материал фундамента КС / РХ Материал перекрытий КС / РХ  \\\n",
       "21447                         NaN                         NaN   \n",
       "21448                         NaN                         NaN   \n",
       "\n",
       "      Стоимости КС / РХ sheet_source search_param  \\\n",
       "21447               NaN      РБ баня            -   \n",
       "21448               NaN      РБ баня            -   \n",
       "\n",
       "      Распределение долей до сделки Распределение долей после сделки  \\\n",
       "21447                         {1/1}                            {1/1}   \n",
       "21448                         {1/1}                            {1/1}   \n",
       "\n",
       "       Исходная цена    Исходная валюта  п/п  floor  category  \\\n",
       "21447            0.0  белорусский рубль  NaN    NaN  торговля   \n",
       "21448            0.0  белорусский рубль  NaN    NaN      офис   \n",
       "\n",
       "       for_clusters_gr Name NP Name region Name oblast  cluster_score cluster  \\\n",
       "21447                1      -1     минский     минская          461.0       B   \n",
       "21448                1      -1     минский     минская          461.0       B   \n",
       "\n",
       "      Дата  1 Евро (EUR)  1 Российский рубль (RUB)  1 Доллар США (USD)  \n",
       "21447  NaT           NaN                       NaN                 NaN  \n",
       "21448  NaT           NaN                       NaN                 NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(total_df_merged[total_df_merged[\"1 Доллар США (USD)\"].isna()])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "id": "3e329e8f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Start (22093, 82)\n",
      "End (22091, 82)\n"
     ]
    }
   ],
   "source": [
    "print(\"Start\", total_df_merged.shape)\n",
    "total_df_merged = total_df_merged[\n",
    "    total_df_merged[\"Дата сделки\"] != \"2013-01-08\"\n",
    "]\n",
    "print(\"End\", total_df_merged.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "8c2bc664",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Axes: xlabel='Дата сделки'>"
      ]
     },
     "execution_count": 102,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "total_df_merged.groupby(\"Дата сделки\")[\n",
    "    [\"1 Доллар США (USD)\", \"1 Евро (EUR)\"]\n",
    "].mean().plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ddbdc5fa",
   "metadata": {},
   "source": [
    "## 3. При наличии пустых ячеек со стоимостью рассчитать стоимость каждого объекта во всех валютах\n",
    "\n",
    "(Есть небольшое кол-во сделок, где не указана «цена в долларах США». Надо провести следующие действия, если есть стоимость в белорусских рублях, то ее необходимо по курсу на дату сделки перевести в доллары. Курсы валют ранее направляла) Где нет стоимости есть информация в поле \"Описание цены\", можно оттуда взять стоимость.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "bf293a27",
   "metadata": {},
   "outputs": [],
   "source": [
    "price_mask = [\n",
    "    \"Цена в бел. руб.\",\n",
    "    \"Цена в долларах США\",\n",
    "    \"1 Доллар США (USD)\",\n",
    "    \"Цена в евро\",\n",
    "    \"1 Евро (EUR)\",\n",
    "    \"Цена по договору\",\n",
    "    \"Описание цены\",\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "id": "00861b72",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Цена в бел. руб.         138\n",
       "Цена в долларах США      145\n",
       "1 Доллар США (USD)         0\n",
       "Цена в евро              145\n",
       "1 Евро (EUR)               0\n",
       "Цена по договору         788\n",
       "Описание цены          13853\n",
       "dtype: int64"
      ]
     },
     "execution_count": 104,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[price_mask].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "65206071",
   "metadata": {},
   "outputs": [],
   "source": [
    "# цена по договору = цена в бел руб\n",
    "total_df_merged[\"Цена в бел. руб.\"] = np.where(\n",
    "    (total_df_merged[\"Цена в бел. руб.\"].isna())\n",
    "    & (total_df_merged[\"Цена по договору\"] != 0),\n",
    "    total_df_merged[\"Цена по договору\"],\n",
    "    total_df_merged[\"Цена в бел. руб.\"],\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "b218ad5f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Цена в бел. руб.         110\n",
       "Цена в долларах США      145\n",
       "1 Доллар США (USD)         0\n",
       "Цена в евро              145\n",
       "1 Евро (EUR)               0\n",
       "Цена по договору         788\n",
       "Описание цены          13853\n",
       "dtype: int64"
      ]
     },
     "execution_count": 106,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[price_mask].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "befe9ad7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>1 Доллар США (USD)</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>1 Евро (EUR)</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>1 Доллар США (USD)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>119817.10</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5493</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6816</td>\n",
       "      <td>119817.10</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>280000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5493</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6816</td>\n",
       "      <td>280000.00</td>\n",
       "      <td>цена указана согласно п. 2.1 договора купли-пр...</td>\n",
       "      <td>2.5493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>80000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6065</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.7437</td>\n",
       "      <td>80000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6065</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>67000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6065</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.7437</td>\n",
       "      <td>67000.00</td>\n",
       "      <td>согласно договора купли-продажи</td>\n",
       "      <td>2.6065</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4883</th>\n",
       "      <td>127621.20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1205</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3518</td>\n",
       "      <td>127621.20</td>\n",
       "      <td>цена по договору</td>\n",
       "      <td>2.1205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4927</th>\n",
       "      <td>8646687.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4376</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.8905</td>\n",
       "      <td>8646687.00</td>\n",
       "      <td>стоимость за 29 капитальных строений с инвента...</td>\n",
       "      <td>2.4376</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4999</th>\n",
       "      <td>453287.48</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6352</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0778</td>\n",
       "      <td>453287.48</td>\n",
       "      <td>Цена с НДС за 2 капитальных строения: 500/С-65...</td>\n",
       "      <td>2.6352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5023</th>\n",
       "      <td>5943.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6195</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.1742</td>\n",
       "      <td>5943.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6195</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6724</th>\n",
       "      <td>11000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5493</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6816</td>\n",
       "      <td>11000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6725</th>\n",
       "      <td>20000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5493</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6816</td>\n",
       "      <td>20000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10980</th>\n",
       "      <td>6511.03</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.2246</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4065</td>\n",
       "      <td>6511.03</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.2246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11300</th>\n",
       "      <td>30000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4629</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.8971</td>\n",
       "      <td>30000.00</td>\n",
       "      <td>цена согласно договору</td>\n",
       "      <td>2.4629</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11887</th>\n",
       "      <td>99000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5965</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.1082</td>\n",
       "      <td>99000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5965</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11969</th>\n",
       "      <td>8085.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5207</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0125</td>\n",
       "      <td>8085.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12410</th>\n",
       "      <td>33129.19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5473</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.7004</td>\n",
       "      <td>33129.19</td>\n",
       "      <td>Цена за капитальные строения с инвентарными но...</td>\n",
       "      <td>2.5473</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13264</th>\n",
       "      <td>126876.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1205</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3518</td>\n",
       "      <td>126876.00</td>\n",
       "      <td>цена по договору</td>\n",
       "      <td>2.1205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13265</th>\n",
       "      <td>129168.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1205</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3518</td>\n",
       "      <td>129168.00</td>\n",
       "      <td>цена по договору</td>\n",
       "      <td>2.1205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13266</th>\n",
       "      <td>109843.20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1205</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3518</td>\n",
       "      <td>109843.20</td>\n",
       "      <td>цена по договору</td>\n",
       "      <td>2.1205</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13289</th>\n",
       "      <td>296907.14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1098</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3542</td>\n",
       "      <td>296907.14</td>\n",
       "      <td>Цена за капитальные строения: 500/С-49285, 500...</td>\n",
       "      <td>2.1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13290</th>\n",
       "      <td>296907.14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1098</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3542</td>\n",
       "      <td>296907.14</td>\n",
       "      <td>Цена за капитальные строения: 500/С-49285, 500...</td>\n",
       "      <td>2.1098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13354</th>\n",
       "      <td>7000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4008</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6736</td>\n",
       "      <td>7000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4008</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13543</th>\n",
       "      <td>64178.83</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6393</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.1607</td>\n",
       "      <td>64178.83</td>\n",
       "      <td>Цена за капитальные строения с инвентарными но...</td>\n",
       "      <td>2.6393</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13560</th>\n",
       "      <td>165850.30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6631</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.1668</td>\n",
       "      <td>165850.30</td>\n",
       "      <td>Цена за 13 (тринадцать) капитальных строений: ...</td>\n",
       "      <td>2.6631</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13682</th>\n",
       "      <td>35028.21</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3879</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.7344</td>\n",
       "      <td>35028.21</td>\n",
       "      <td>цена за капитальные строения с инв №№ 700/С-66...</td>\n",
       "      <td>2.3879</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13714</th>\n",
       "      <td>207900.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5372</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0799</td>\n",
       "      <td>207900.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5372</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14089</th>\n",
       "      <td>591.60</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5312</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0944</td>\n",
       "      <td>591.60</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.5312</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14883</th>\n",
       "      <td>44000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.2342</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4703</td>\n",
       "      <td>44000.00</td>\n",
       "      <td>общая цена двух капитальных строений с инв. №№...</td>\n",
       "      <td>2.2342</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14885</th>\n",
       "      <td>256000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.2342</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4703</td>\n",
       "      <td>256000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.2342</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14916</th>\n",
       "      <td>3050.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1762</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3857</td>\n",
       "      <td>3050.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.1762</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16156</th>\n",
       "      <td>21855.12</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6459</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.1397</td>\n",
       "      <td>21855.12</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6459</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16158</th>\n",
       "      <td>22137.54</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6459</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.1397</td>\n",
       "      <td>22137.54</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6459</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16201</th>\n",
       "      <td>40000.00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.4214</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.7311</td>\n",
       "      <td>40000.00</td>\n",
       "      <td>договорная цена</td>\n",
       "      <td>2.4214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16808</th>\n",
       "      <td>28260.90</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6133</td>\n",
       "      <td>28260.90</td>\n",
       "      <td>цена продажи указана в отношении 6-ти следующи...</td>\n",
       "      <td>2.3995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16936</th>\n",
       "      <td>28260.90</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6133</td>\n",
       "      <td>28260.90</td>\n",
       "      <td>цена продажи указана в отношении 6-ти следующи...</td>\n",
       "      <td>2.3995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18092</th>\n",
       "      <td>28260.90</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.3995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.6133</td>\n",
       "      <td>28260.90</td>\n",
       "      <td>цена продажи указана в отношении 6-ти следующи...</td>\n",
       "      <td>2.3995</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Цена в бел. руб.  Цена в долларах США  1 Доллар США (USD)  Цена в евро  \\\n",
       "0             119817.10                  NaN              2.5493          NaN   \n",
       "1             280000.00                  NaN              2.5493          NaN   \n",
       "2              80000.00                  NaN              2.6065          NaN   \n",
       "3              67000.00                  NaN              2.6065          NaN   \n",
       "4883          127621.20                  NaN              2.1205          NaN   \n",
       "4927         8646687.00                  NaN              2.4376          NaN   \n",
       "4999          453287.48                  NaN              2.6352          NaN   \n",
       "5023            5943.00                  NaN              2.6195          NaN   \n",
       "6724           11000.00                  NaN              2.5493          NaN   \n",
       "6725           20000.00                  NaN              2.5493          NaN   \n",
       "10980           6511.03                  NaN              2.2246          NaN   \n",
       "11300          30000.00                  NaN              2.4629          NaN   \n",
       "11887          99000.00                  NaN              2.5965          NaN   \n",
       "11969           8085.00                  NaN              2.5207          NaN   \n",
       "12410          33129.19                  NaN              2.5473          NaN   \n",
       "13264         126876.00                  NaN              2.1205          NaN   \n",
       "13265         129168.00                  NaN              2.1205          NaN   \n",
       "13266         109843.20                  NaN              2.1205          NaN   \n",
       "13289         296907.14                  NaN              2.1098          NaN   \n",
       "13290         296907.14                  NaN              2.1098          NaN   \n",
       "13354           7000.00                  NaN              2.4008          NaN   \n",
       "13543          64178.83                  NaN              2.6393          NaN   \n",
       "13560         165850.30                  NaN              2.6631          NaN   \n",
       "13682          35028.21                  NaN              2.3879          NaN   \n",
       "13714         207900.00                  NaN              2.5372          NaN   \n",
       "14089            591.60                  NaN              2.5312          NaN   \n",
       "14883          44000.00                  NaN              2.2342          NaN   \n",
       "14885         256000.00                  NaN              2.2342          NaN   \n",
       "14916           3050.00                  NaN              2.1762          NaN   \n",
       "16156          21855.12                  NaN              2.6459          NaN   \n",
       "16158          22137.54                  NaN              2.6459          NaN   \n",
       "16201          40000.00                  NaN              2.4214          NaN   \n",
       "16808          28260.90                  NaN              2.3995          NaN   \n",
       "16936          28260.90                  NaN              2.3995          NaN   \n",
       "18092          28260.90                  NaN              2.3995          NaN   \n",
       "\n",
       "       1 Евро (EUR)  Цена по договору  \\\n",
       "0            2.6816         119817.10   \n",
       "1            2.6816         280000.00   \n",
       "2            2.7437          80000.00   \n",
       "3            2.7437          67000.00   \n",
       "4883         2.3518         127621.20   \n",
       "4927         2.8905        8646687.00   \n",
       "4999         3.0778         453287.48   \n",
       "5023         3.1742           5943.00   \n",
       "6724         2.6816          11000.00   \n",
       "6725         2.6816          20000.00   \n",
       "10980        2.4065           6511.03   \n",
       "11300        2.8971          30000.00   \n",
       "11887        3.1082          99000.00   \n",
       "11969        3.0125           8085.00   \n",
       "12410        2.7004          33129.19   \n",
       "13264        2.3518         126876.00   \n",
       "13265        2.3518         129168.00   \n",
       "13266        2.3518         109843.20   \n",
       "13289        2.3542         296907.14   \n",
       "13290        2.3542         296907.14   \n",
       "13354        2.6736           7000.00   \n",
       "13543        3.1607          64178.83   \n",
       "13560        3.1668         165850.30   \n",
       "13682        2.7344          35028.21   \n",
       "13714        3.0799         207900.00   \n",
       "14089        3.0944            591.60   \n",
       "14883        2.4703          44000.00   \n",
       "14885        2.4703         256000.00   \n",
       "14916        2.3857           3050.00   \n",
       "16156        3.1397          21855.12   \n",
       "16158        3.1397          22137.54   \n",
       "16201        2.7311          40000.00   \n",
       "16808        2.6133          28260.90   \n",
       "16936        2.6133          28260.90   \n",
       "18092        2.6133          28260.90   \n",
       "\n",
       "                                           Описание цены  1 Доллар США (USD)  \n",
       "0                                                    NaN              2.5493  \n",
       "1      цена указана согласно п. 2.1 договора купли-пр...              2.5493  \n",
       "2                                                    NaN              2.6065  \n",
       "3                        согласно договора купли-продажи              2.6065  \n",
       "4883                                    цена по договору              2.1205  \n",
       "4927   стоимость за 29 капитальных строений с инвента...              2.4376  \n",
       "4999   Цена с НДС за 2 капитальных строения: 500/С-65...              2.6352  \n",
       "5023                                                 NaN              2.6195  \n",
       "6724                                                 NaN              2.5493  \n",
       "6725                                                 NaN              2.5493  \n",
       "10980                                                NaN              2.2246  \n",
       "11300                             цена согласно договору              2.4629  \n",
       "11887                                                NaN              2.5965  \n",
       "11969                                                NaN              2.5207  \n",
       "12410  Цена за капитальные строения с инвентарными но...              2.5473  \n",
       "13264                                   цена по договору              2.1205  \n",
       "13265                                   цена по договору              2.1205  \n",
       "13266                                   цена по договору              2.1205  \n",
       "13289  Цена за капитальные строения: 500/С-49285, 500...              2.1098  \n",
       "13290  Цена за капитальные строения: 500/С-49285, 500...              2.1098  \n",
       "13354                                                NaN              2.4008  \n",
       "13543  Цена за капитальные строения с инвентарными но...              2.6393  \n",
       "13560  Цена за 13 (тринадцать) капитальных строений: ...              2.6631  \n",
       "13682  цена за капитальные строения с инв №№ 700/С-66...              2.3879  \n",
       "13714                                                NaN              2.5372  \n",
       "14089                                                NaN              2.5312  \n",
       "14883  общая цена двух капитальных строений с инв. №№...              2.2342  \n",
       "14885                                                NaN              2.2342  \n",
       "14916                                                NaN              2.1762  \n",
       "16156                                                NaN              2.6459  \n",
       "16158                                                NaN              2.6459  \n",
       "16201                                    договорная цена              2.4214  \n",
       "16808  цена продажи указана в отношении 6-ти следующи...              2.3995  \n",
       "16936  цена продажи указана в отношении 6-ти следующи...              2.3995  \n",
       "18092  цена продажи указана в отношении 6-ти следующи...              2.3995  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# бел рубли\n",
    "display(\n",
    "    total_df_merged[\n",
    "        (total_df_merged[\"Цена в бел. руб.\"].notna())\n",
    "        & (total_df_merged[\"Цена в долларах США\"].isna())\n",
    "    ][price_mask + [\"1 Доллар США (USD)\"]]\n",
    ")\n",
    "\n",
    "usd_mask = (\n",
    "    total_df_merged[\"Цена в бел. руб.\"].notna()\n",
    "    & total_df_merged[\"Цена в долларах США\"].isna()\n",
    ")\n",
    "eur_mask = (\n",
    "    total_df_merged[\"Цена в бел. руб.\"].notna()\n",
    "    & total_df_merged[\"Цена в евро\"].isna()\n",
    ")\n",
    "\n",
    "total_df_merged.loc[usd_mask, \"Цена в долларах США\"] = (\n",
    "    total_df_merged.loc[usd_mask, \"Цена в бел. руб.\"]\n",
    "    / total_df_merged.loc[usd_mask, \"1 Доллар США (USD)\"]\n",
    ")\n",
    "total_df_merged.loc[eur_mask, \"Цена в евро\"] = (\n",
    "    total_df_merged.loc[eur_mask, \"Цена в бел. руб.\"]\n",
    "    / total_df_merged.loc[eur_mask, \"1 Евро (EUR)\"]\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "db13dc2a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Цена в бел. руб.         110\n",
       "Цена в долларах США      110\n",
       "1 Доллар США (USD)         0\n",
       "Цена в евро              110\n",
       "1 Евро (EUR)               0\n",
       "Цена по договору         788\n",
       "Описание цены          13853\n",
       "dtype: int64"
      ]
     },
     "execution_count": 108,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[price_mask].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "56fd8fac",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        119817.100000\n",
       "1        280000.000000\n",
       "2         80000.000000\n",
       "3         67000.000000\n",
       "4         86849.400000\n",
       "             ...      \n",
       "22088    221850.000000\n",
       "22089     20896.660000\n",
       "22090     15000.000000\n",
       "22091     33604.166667\n",
       "22092    104604.300000\n",
       "Name: Цена в бел. руб., Length: 22091, dtype: float64"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[\"Цена в бел. руб.\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "4de19df2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "from typing import Dict, Tuple, Any, Optional\n",
    "\n",
    "\n",
    "class PriceExtractor:\n",
    "    \"\"\"\n",
    "    Настраиваемый извлекатель цен.\n",
    "    - Ищет шаблоны вида: '100 USD' / 'USD 100' / '$ 100' / '100 $'\n",
    "    - Русские варианты: '100 долларов', '100 долларов США', 'долл.', 'американских долларов'\n",
    "    - EUR: 'EUR', '€', 'евро'\n",
    "    - BYN: 'BYN', 'Br', 'бел. руб.', 'белорусских рублей', 'руб. BYN', 'руб. РБ'\n",
    "    - Опция treat_ue_as_usd, если хотите трактовать 'у.е.' как USD.\n",
    "    \"\"\"\n",
    "\n",
    "    NUM = r\"(?:\\d{1,3}(?:[ \\u00A0\\u202F]?\\d{3})+|\\d+)(?:[.,]\\d+)?\"\n",
    "\n",
    "    def __init__(self, treat_ue_as_usd: bool = True):\n",
    "        self.treat_ue_as_usd = treat_ue_as_usd\n",
    "\n",
    "        # расширено: ловит 'долларам/долларах/долларами США' и т.п.\n",
    "        usd_words = r\"(?:USD|\\$|долл?\\.?|доллар(?:[а-я]{0,6})?(?:\\s*США)?)\"\n",
    "        eur_words = r\"(?:EUR|€|евро)\"\n",
    "        byn_words_specific = (\n",
    "            r\"(?:BYN|Br|\"\n",
    "            r\"бел(?:орусск(?:ий|их)|\\.)\\s*руб(?:[а-я\\.]{0,6})?|\"\n",
    "            r\"бел\\.?\\s*руб(?:[а-я\\.]{0,6})?|\"\n",
    "            r\"руб(?:[а-я\\.]{0,6})?\\s*(?:BYN|РБ)\"\n",
    "            r\")\"\n",
    "        )\n",
    "        byn_words_plain = r\"(?:руб(?:[а-я\\.]{0,6})?|р\\.?)\"\n",
    "        byn_words = rf\"(?:{byn_words_specific}|{byn_words_plain})\"\n",
    "\n",
    "        self.currency_words: Dict[str, str] = {\n",
    "            \"USD\": usd_words,\n",
    "            \"EUR\": eur_words,\n",
    "            \"BYN\": byn_words,\n",
    "        }\n",
    "\n",
    "        # Скомпилированные паттерны: число-перед/после валюты\n",
    "        self.patterns: Dict[str, Any] = {\n",
    "            cur: [\n",
    "                re.compile(rf\"(?<!\\w)({self.NUM})\\s*(?:{words})(?!\\w)\", re.I),\n",
    "                re.compile(rf\"(?<!\\w)(?:{words})\\s*({self.NUM})(?!\\w)\", re.I),\n",
    "            ]\n",
    "            for cur, words in self.currency_words.items()\n",
    "        }\n",
    "\n",
    "        if self.treat_ue_as_usd:\n",
    "            # Очень частый кейс в СНГ: у.е. ~ USD\n",
    "            self.patterns[\"USD\"] += [\n",
    "                re.compile(\n",
    "                    rf\"(?<!\\w)({self.NUM})\\s*(?:у\\.?е\\.?|у[\\s-]?е)(?!\\w)\", re.I\n",
    "                ),\n",
    "                re.compile(\n",
    "                    rf\"(?<!\\w)(?:у\\.?е\\.?|у[\\s-]?е)\\s*({self.NUM})(?!\\w)\", re.I\n",
    "                ),\n",
    "            ]\n",
    "\n",
    "        # ---- ДОБАВЛЕНО: generic BYN (если явных валют нет) ----\n",
    "        # ловим конструкции: \"сумма/сумму/в сумме/в размере <число>\" или \"<число> сумма/цена/стоимость/итого\"\n",
    "        self.generic_byn_patterns = [\n",
    "            re.compile(\n",
    "                rf\"(?<!\\w)({self.NUM})\\s*(?:сумм[аеуы]|цена|стоимость|итог(?:о)?|в\\s*размере)(?!\\w)\",\n",
    "                re.I,\n",
    "            ),\n",
    "            re.compile(\n",
    "                rf\"(?<!\\w)(?:сумм[аеуы]|цена|стоимость|итог(?:о)?|в\\s*размере)\\s*({self.NUM})(?!\\w)\",\n",
    "                re.I,\n",
    "            ),\n",
    "            re.compile(rf\"(?<!\\w)в\\s*сумме\\s*({self.NUM})(?!\\w)\", re.I),\n",
    "        ]\n",
    "\n",
    "    @staticmethod\n",
    "    def _normalize_number(num_str: str) -> Tuple[float, str]:\n",
    "        \"\"\"\n",
    "        Приводит строку-число к float, возвращает (значение, объяснение_нормализации).\n",
    "        Учитывает неразрывные пробелы, пробелы-тысячные, запятую как десятичный разделитель.\n",
    "        \"\"\"\n",
    "        if not isinstance(num_str, str):\n",
    "            return (np.nan, \"не строка\")\n",
    "        s = num_str.strip().replace(\"\\u00a0\", \" \").replace(\"\\u202f\", \" \")\n",
    "        explain = []\n",
    "        # удалить пробелы-тысячные (между цифрами)\n",
    "        if re.search(r\"(?<=\\d) (?=\\d)\", s):\n",
    "            s = re.sub(r\"(?<=\\d) (?=\\d)\", \"\", s)\n",
    "            explain.append(\"удалены пробелы-тысячные\")\n",
    "        # если есть и запятая, и точка — считаем запятую тысячной\n",
    "        if \",\" in s and \".\" in s:\n",
    "            s = s.replace(\",\", \"\")\n",
    "            explain.append(\"удалены запятые-тысячные\")\n",
    "        elif \",\" in s and \".\" not in s:\n",
    "            s = s.replace(\",\", \".\")\n",
    "            explain.append(\"замена запятой на точку (десятичная)\")\n",
    "        # взять первое число\n",
    "        m = re.findall(r\"[+-]?\\d+(?:\\.\\d+)?\", s)\n",
    "        if not m:\n",
    "            return (np.nan, \"число не распознано\")\n",
    "        try:\n",
    "            return (\n",
    "                float(m[0]),\n",
    "                \"; \".join(explain) if explain else \"без преобразований\",\n",
    "            )\n",
    "        except Exception as e:\n",
    "            return (np.nan, f\"ошибка преобразования: {e}\")\n",
    "\n",
    "    def extract_from_text(\n",
    "        self, text: Any\n",
    "    ) -> Tuple[Dict[str, float], str, Dict[str, Optional[str]]]:\n",
    "        \"\"\"\n",
    "        Возвращает:\n",
    "        - dict значений {'USD': float|nan, 'EUR': ..., 'BYN': ...}\n",
    "        - строку-лог\n",
    "        - dict форм {'USD': matched_str|None, ...}\n",
    "        Берём ТОЛЬКО первое по позиции совпадение; generic BYN используем, если явных валют нет.\n",
    "        \"\"\"\n",
    "        vals = {\"USD\": np.nan, \"EUR\": np.nan, \"BYN\": np.nan}\n",
    "        forms: Dict[str, Optional[str]] = {\n",
    "            \"USD\": None,\n",
    "            \"EUR\": None,\n",
    "            \"BYN\": None,\n",
    "        }\n",
    "\n",
    "        if not isinstance(text, str):\n",
    "            return vals, \"исходное значение: не строка\", forms\n",
    "\n",
    "        t = text.strip()\n",
    "\n",
    "        # 1) явные валюты\n",
    "        candidates = []  # (pos, cur, value, full_match, order, note)\n",
    "        for cur, pats in self.patterns.items():\n",
    "            for i, p in enumerate(pats):\n",
    "                m = p.search(t)\n",
    "                if m:\n",
    "                    raw = m.group(1)\n",
    "                    val, norm_note = self._normalize_number(raw)\n",
    "                    order = (\n",
    "                        \"число перед валютой\"\n",
    "                        if (i % 2 == 0)\n",
    "                        else \"валюта перед числом\"\n",
    "                    )\n",
    "                    candidates.append(\n",
    "                        (m.start(), cur, val, m.group(0), order, norm_note)\n",
    "                    )\n",
    "                    break  # для этой валюты берём самый ранний матч\n",
    "\n",
    "        # 2) если явных нет — пробуем generic BYN (сумма/в сумме/в размере/цена/стоимость/итого)\n",
    "        if not candidates:\n",
    "            for p in self.generic_byn_patterns:\n",
    "                m = p.search(t)\n",
    "                if m:\n",
    "                    raw = m.group(1)\n",
    "                    val, norm_note = self._normalize_number(raw)\n",
    "                    candidates.append(\n",
    "                        (\n",
    "                            m.start(),\n",
    "                            \"BYN\",\n",
    "                            val,\n",
    "                            m.group(0),\n",
    "                            \"generic BYN\",\n",
    "                            norm_note,\n",
    "                        )\n",
    "                    )\n",
    "                    break\n",
    "\n",
    "        if not candidates:\n",
    "            # как и раньше — если ничего не нашли, пишем \"не найдено\" для каждой валюты\n",
    "            logs = [f\"{cur}: не найдено\" for cur in [\"USD\", \"EUR\", \"BYN\"]]\n",
    "            return vals, \" | \".join(logs), forms\n",
    "\n",
    "        # Берём самый ранний по позиции кандидат\n",
    "        pos, cur, val, full, order, note = sorted(\n",
    "            candidates, key=lambda x: x[0]\n",
    "        )[0]\n",
    "        vals[cur] = val\n",
    "        forms[cur] = full\n",
    "        log_used = f\"{cur}: '{full}' -> {val} ({order}; {note}); выбрано как первое совпадение\"\n",
    "\n",
    "        # Для остальных валют просто отметим, что проигнорированы (или не найдены)\n",
    "        logs = [log_used]\n",
    "        for other in [\"USD\", \"EUR\", \"BYN\"]:\n",
    "            if other == cur:\n",
    "                continue\n",
    "            if any(c[1] == other for c in candidates):\n",
    "                logs.append(\n",
    "                    f\"{other}: найдено, но проигнорировано (берём первое совпадение)\"\n",
    "                )\n",
    "            else:\n",
    "                logs.append(f\"{other}: не найдено\")\n",
    "\n",
    "        return vals, \" | \".join(logs), forms\n",
    "\n",
    "    def transform(\n",
    "        self,\n",
    "        df: pd.DataFrame,\n",
    "        col_name: str,\n",
    "        with_cases: bool = True,\n",
    "        return_copy: bool = True,\n",
    "    ):\n",
    "        \"\"\"\n",
    "        Применить к DataFrame.\n",
    "        Добавляет колонки USD/EUR/BYN, 'Логика извлечения' и (опц.) 'Форма_<CUR>'.\n",
    "        \"\"\"\n",
    "        if col_name not in df.columns:\n",
    "            raise KeyError(\n",
    "                f'В DataFrame нет колонки \"{col_name}\". Доступные: {list(df.columns)}'\n",
    "            )\n",
    "\n",
    "        target = df.copy() if return_copy else df\n",
    "        extracted = target[col_name].apply(self.extract_from_text)\n",
    "\n",
    "        vals_df = extracted.apply(lambda x: x[0]).apply(pd.Series)\n",
    "        vals_df = vals_df[[\"USD\", \"EUR\", \"BYN\"]]  # гарантируем порядок\n",
    "\n",
    "        logs = extracted.apply(lambda x: x[1])\n",
    "        forms_df = extracted.apply(lambda x: x[2]).apply(pd.Series)\n",
    "        forms_df.columns = [f\"Форма_{c}\" for c in forms_df.columns]\n",
    "\n",
    "        target[[\"USD\", \"EUR\", \"BYN\"]] = vals_df\n",
    "        target[\"Логика извлечения\"] = logs\n",
    "        if with_cases:\n",
    "            for c in [\"USD\", \"EUR\", \"BYN\"]:\n",
    "                target[f\"Форма_{c}\"] = forms_df.get(f\"Форма_{c}\")\n",
    "\n",
    "        return target\n",
    "\n",
    "    @staticmethod\n",
    "    def collect_unique_forms(transformed_df: pd.DataFrame):\n",
    "        \"\"\"\n",
    "        Собирает витрину уникальных найденных форм по валютам.\n",
    "        \"\"\"\n",
    "        rows = []\n",
    "        for cur in [\"USD\", \"EUR\", \"BYN\"]:\n",
    "            col = f\"Форма_{cur}\"\n",
    "            if col in transformed_df.columns:\n",
    "                uniq = (\n",
    "                    transformed_df[col]\n",
    "                    .dropna()\n",
    "                    .astype(str)\n",
    "                    .drop_duplicates()\n",
    "                    .tolist()\n",
    "                )\n",
    "                for u in uniq:\n",
    "                    rows.append({\"Валюта\": cur, \"Пример найденной формы\": u})\n",
    "        return pd.DataFrame(rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "190df546",
   "metadata": {},
   "outputs": [],
   "source": [
    "pe = PriceExtractor(treat_ue_as_usd=True)\n",
    "res = pe.transform(total_df_merged, \"Описание цены\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "cdc0e5f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "def fill_prices_from_temp(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    out = df.copy()\n",
    "    mapping = {\n",
    "        \"BYN\": \"Цена в бел. руб.\",\n",
    "        \"USD\": \"Цена в долларах США\",\n",
    "        \"EUR\": \"Цена в евро\",\n",
    "    }\n",
    "    for col in mapping.values():\n",
    "        if col not in out.columns:\n",
    "            out[col] = np.nan\n",
    "    for temp_col, target_col in mapping.items():\n",
    "        if temp_col in out.columns:\n",
    "            mask = out[target_col].isna() & out[temp_col].notna()\n",
    "            out.loc[mask, target_col] = out.loc[mask, temp_col]\n",
    "    return out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "id": "8f34f78d",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_merged = fill_prices_from_temp(res)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "5d9bff73",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Цена в бел. руб.          90\n",
       "Цена в долларах США       95\n",
       "1 Доллар США (USD)         0\n",
       "Цена в евро              108\n",
       "1 Евро (EUR)               0\n",
       "Цена по договору         788\n",
       "Описание цены          13853\n",
       "dtype: int64"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[price_mask].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "id": "1a1b333c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Цена в бел. руб.          90\n",
       "Цена в долларах США       95\n",
       "1 Доллар США (USD)         0\n",
       "Цена в евро              108\n",
       "1 Евро (EUR)               0\n",
       "Цена по договору         788\n",
       "Описание цены          13853\n",
       "dtype: int64"
      ]
     },
     "execution_count": 115,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mask = (\n",
    "    total_df_merged[\"Цена в бел. руб.\"].isna()\n",
    "    & total_df_merged[\"Цена в долларах США\"].notna()\n",
    ")\n",
    "\n",
    "total_df_merged.loc[usd_mask, \"Цена в бел. руб.\"] = (\n",
    "    total_df_merged.loc[usd_mask, \"Цена в долларах США\"]\n",
    "    * total_df_merged.loc[usd_mask, \"1 Доллар США (USD)\"]\n",
    ")\n",
    "total_df_merged[price_mask].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "d3ab83f1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Цена в бел. руб.          95\n",
       "Цена в долларах США       95\n",
       "1 Доллар США (USD)         0\n",
       "Цена в евро               95\n",
       "1 Евро (EUR)               0\n",
       "Цена по договору         788\n",
       "Описание цены          13853\n",
       "dtype: int64"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[\"Цена в бел. руб.\"] = (\n",
    "    total_df_merged[\"Цена в долларах США\"]\n",
    "    * total_df_merged[\"1 Доллар США (USD)\"]\n",
    ")\n",
    "total_df_merged[\"Цена в евро\"] = (\n",
    "    total_df_merged[\"Цена в бел. руб.\"] / total_df_merged[\"1 Евро (EUR)\"]\n",
    ")\n",
    "total_df_merged[price_mask].isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26ab01fa",
   "metadata": {},
   "source": [
    "остальное не достать или нету инфы\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "08f205b9",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_merged = total_df_merged[total_df_merged[\"Цена в бел. руб.\"].notna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "id": "ae636283",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Цена в бел. руб.           0\n",
       "Цена в долларах США        0\n",
       "1 Доллар США (USD)         0\n",
       "Цена в евро                0\n",
       "1 Евро (EUR)               0\n",
       "Цена по договору         752\n",
       "Описание цены          13835\n",
       "dtype: int64"
      ]
     },
     "execution_count": 118,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged[price_mask].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "8566391a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(21996, 89)"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 120,
   "id": "667e147b",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_merged.to_excel(\"./data/total_df_with_curr.xlsx\", index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1671aacb",
   "metadata": {},
   "source": [
    "## 4. Выделить дата сет (грязный) со следующим признакам:\n",
    "\n",
    "- столбец AU (маркеры) - доля;\n",
    "- столбец AC (переходящая доля), все доли за исключением 1/1; 1/1, 1/1; 1/1, 1/1,1/1 и пустых ячеек.\n",
    "- столбец R (Количество объектов в сделке) более 1, то есть начиная с 2,3,4.....и т.д.\n",
    "- столбец AU (маркеры) - комплекс\n",
    "- столбец U (описание цены включает слова \"долей, доля,доли и т.д.\")\n",
    "- столбец U (описание цены включает слова \"Цена указана за ......... объектов\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "id": "7507fc32",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(21996, 89)"
      ]
     },
     "execution_count": 121,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged = pd.read_excel(\"./data/total_df_with_curr.xlsx\")\n",
    "filtered_df = total_df_merged.copy()\n",
    "filtered_df.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a7bf024",
   "metadata": {},
   "source": [
    "Количество объектов в сделке $> 1$\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "id": "ea6a1871",
   "metadata": {},
   "outputs": [],
   "source": [
    "idx_with_two_and_more = filtered_df[\n",
    "    filtered_df[\"Количество объектов в сделке\"] > 1\n",
    "].index"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8177f908",
   "metadata": {},
   "source": [
    "**Описание цены** включает в себя\n",
    "\n",
    "- слова доля и тд\n",
    "- Включает слова `Цена указана за `\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "id": "c3e12aff",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\ф\\AppData\\Local\\Temp\\ipykernel_27600\\3956452644.py:4: UserWarning: This pattern is interpreted as a regular expression, and has match groups. To actually get the groups, use str.extract.\n",
      "  filtered_df[\"Описание цены\"].astype(str).str.contains(re_dolya, na=False)\n"
     ]
    }
   ],
   "source": [
    "re_dolya = r\"(?i)(?<!\\w)(доля|доли|долей|долю|доле|долям|долях|долями)(?!\\w)\"\n",
    "mask_dolya = pd.Series(False, index=filtered_df.index)\n",
    "mask_dolya = (\n",
    "    filtered_df[\"Описание цены\"].astype(str).str.contains(re_dolya, na=False)\n",
    ")\n",
    "idx_dolya_U = filtered_df.index[mask_dolya].tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "a01d0db3",
   "metadata": {},
   "outputs": [],
   "source": [
    "u_lower = filtered_df[\"Описание цены\"].astype(str).str.lower()\n",
    "mask_price_starts = u_lower.str.match(\n",
    "    r\"(?u)^\\s*цена\\s*указана\\s*за\\b[^,\\.;\\n\\r]*\\bобъект(?:а|у|ом|е|ы|ов|ам|ами|ах)?\\b\",\n",
    "    na=False,\n",
    ")\n",
    "idx_price_starts = filtered_df.index[mask_price_starts].tolist()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c7fead4a",
   "metadata": {},
   "source": [
    "Маркеры - доля и Маркеры - комплекс\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "id": "34dbd5c2",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\ф\\AppData\\Local\\Temp\\ipykernel_27600\\1853291178.py:1: UserWarning: This pattern is interpreted as a regular expression, and has match groups. To actually get the groups, use str.extract.\n",
      "  mask_dolya = filtered_df[\"Маркеры\"].astype(str).str.contains(re_dolya, na=False)\n"
     ]
    }
   ],
   "source": [
    "mask_dolya = filtered_df[\"Маркеры\"].astype(str).str.contains(re_dolya, na=False)\n",
    "idx_dolya_AU = filtered_df.index[mask_dolya].tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "id": "1055a5cd",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\ф\\AppData\\Local\\Temp\\ipykernel_27600\\1929709331.py:4: UserWarning: This pattern is interpreted as a regular expression, and has match groups. To actually get the groups, use str.extract.\n",
      "  filtered_df[\"Маркеры\"].astype(str).str.contains(re_complex, na=False)\n"
     ]
    }
   ],
   "source": [
    "re_complex = r\"(?i)(?<!\\w)(комплекс|комплекса|комплексу|комплексом|комплексе|комплексы|комплексов|комплексам|комплексами|комплексах)(?!\\w)\"\n",
    "\n",
    "mask_complex = (\n",
    "    filtered_df[\"Маркеры\"].astype(str).str.contains(re_complex, na=False)\n",
    ")\n",
    "idx_complex = filtered_df.index[mask_complex].tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "id": "83e1fa1b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Комплекс', 'Доля; Комплекс', 'Комплекс; Продавец Государство',\n",
       "       'Комплекс; Транзит, Δ цены: 8.90%', 'Комплекс; Нет даты ввода',\n",
       "       'Комплекс; Нет даты ввода; Продавец Государство',\n",
       "       'Комплекс; Продавец Банк', 'Комплекс; Цена содержит НДС',\n",
       "       'Комплекс; Смена назначения', 'Комплекс; Проверяется дата ввода',\n",
       "       'Комплекс; Первичный рынок', 'Комплекс; Транзит, Δ цены: 725.92%',\n",
       "       'Комплекс; Транзит, Δ цены: 727.61%',\n",
       "       'Комплекс; Нет даты ввода; Продавец Банк',\n",
       "       'Комплекс; Проверяется этаж', 'Комплекс; Транзит, Δ цены: 11.91%',\n",
       "       'Комплекс; Транзит, Δ цены: 12.00%',\n",
       "       'Комплекс; Транзит, Δ цены: 11.98%',\n",
       "       'Комплекс; Транзит, Δ цены: 69.60%',\n",
       "       'Комплекс; Транзит, Δ цены: 2.76%',\n",
       "       'Комплекс; Транзит, Δ цены: 2.04%',\n",
       "       'Комплекс; Проверяется дата ввода; Транзит, Δ цены: 2.04%',\n",
       "       'Аукцион; Комплекс; Продавец Государство',\n",
       "       'Комплекс; Транзит, Δ цены: 0.00%',\n",
       "       'Комплекс; Транзит, Δ цены: 1.68%',\n",
       "       'Комплекс; Транзит, Δ цены: 1.78%',\n",
       "       'Комплекс; Транзит, Δ цены: 3.29%',\n",
       "       'Комплекс; Транзит, Δ цены: 1.93%',\n",
       "       'Комплекс; Транзит, Δ цены: 1.80%', 'Аукцион; Комплекс',\n",
       "       'Комплекс; Первичный рынок; Цена содержит НДС',\n",
       "       'Комплекс; Продавец Государство; Смена назначения',\n",
       "       'Комплекс; Снесен/Гибель',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Цена содержит НДС',\n",
       "       'Комплекс; Нет мат. стен', 'Комплекс; Недостоверная валюта',\n",
       "       'Комплекс; Рассрочка; Цена содержит НДС',\n",
       "       'Доля; Комплекс; Нет даты ввода',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 95.42%; Цена содержит НДС',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 95.12%',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 94.79%',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 91.80%; Цена содержит НДС',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 91.74%; Цена содержит НДС',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 91.51%; Цена содержит НДС',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 90.29%; Цена содержит НДС',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 84.74%; Цена содержит НДС',\n",
       "       'Комплекс; Первичный рынок; Проверяется этаж; Транзит, Δ цены: 52.98%; Цена содержит НДС',\n",
       "       'Комплекс; Нет даты ввода; Смена назначения',\n",
       "       'Комплекс; Транзит, Δ цены: 0.72%',\n",
       "       'Комплекс; Транзит, Δ цены: 14.01%',\n",
       "       'Комплекс; Нет даты ввода; Цена содержит НДС',\n",
       "       'Комплекс; Транзит, Δ цены: 70.81%',\n",
       "       'Комплекс; Транзит, Δ цены: 46.93%',\n",
       "       'Комплекс; Транзит, Δ цены: 3.78%',\n",
       "       'Комплекс; Транзит, Δ цены: 3.76%',\n",
       "       'Комплекс; Транзит, Δ цены: 3.65%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 19.38%',\n",
       "       'Доля; Комплекс; Проверяется этаж',\n",
       "       'Комплекс; Транзит, Δ цены: 6.16%',\n",
       "       'Комплекс; Транзит, Δ цены: 171.23%',\n",
       "       'Комплекс; Транзит, Δ цены: 7.19%',\n",
       "       'Комплекс; Транзит, Δ цены: 0.23%',\n",
       "       'Комплекс; Транзит, Δ цены: 52.99%',\n",
       "       'Комплекс; Транзит, Δ цены: 80.88%',\n",
       "       'Комплекс; Транзит, Δ цены: 40.48%',\n",
       "       'Комплекс; Транзит, Δ цены: 39.85%',\n",
       "       'Комплекс; Продавец Государство; Цена содержит НДС',\n",
       "       'Комплекс; Транзит, Δ цены: 14.15%',\n",
       "       'Комплекс; Транзит, Δ цены: 15.83%',\n",
       "       'Доля; Комплекс; Продавец Банк',\n",
       "       'Комплекс; Транзит, Δ цены: 509.93%',\n",
       "       'Комплекс; Транзит, Δ цены: 286.78%',\n",
       "       'Комплекс; Транзит, Δ цены: 73.64%',\n",
       "       'Комплекс; Транзит, Δ цены: 87.73%',\n",
       "       'Комплекс; Транзит, Δ цены: 51.84%',\n",
       "       'Комплекс; Транзит, Δ цены: 62.78%',\n",
       "       'Комплекс; Транзит, Δ цены: 45.62%',\n",
       "       'Комплекс; Транзит, Δ цены: 1.62%',\n",
       "       'Комплекс; Нет даты ввода; Нет мат. стен',\n",
       "       'Комплекс; Транзит, Δ цены: 9795.85%',\n",
       "       'Комплекс; Транзит, Δ цены: 35.57%',\n",
       "       'Комплекс; Транзит, Δ цены: 74.36%',\n",
       "       'Комплекс; Транзит, Δ цены: 65.58%',\n",
       "       'Комплекс; Транзит, Δ цены: 64.61%',\n",
       "       'Комплекс; Транзит, Δ цены: 73.81%',\n",
       "       'Комплекс; Транзит, Δ цены: 51.58%',\n",
       "       'Комплекс; Транзит, Δ цены: 86.22%',\n",
       "       'Комплекс; Транзит, Δ цены: 66.87%',\n",
       "       'Комплекс; Транзит, Δ цены: 66.13%',\n",
       "       'Комплекс; Транзит, Δ цены: 1.15%',\n",
       "       'Аукцион; Комплекс; Проверяется дата ввода',\n",
       "       'Комплекс; Транзит, Δ цены: 15.33%',\n",
       "       'Комплекс; Транзит, Δ цены: 15.64%',\n",
       "       'Комплекс; Транзит, Δ цены: 0.61%',\n",
       "       'Комплекс; Транзит, Δ цены: 0.62%',\n",
       "       'Комплекс; Транзит, Δ цены: 8.18%',\n",
       "       'Комплекс; Транзит, Δ цены: 8.88%',\n",
       "       'Комплекс; Транзит, Δ цены: 8.19%',\n",
       "       'Комплекс; Транзит, Δ цены: 7.93%',\n",
       "       'Комплекс; Транзит, Δ цены: 8.52%',\n",
       "       'Комплекс; Транзит, Δ цены: 47213900.00%',\n",
       "       'Доля; Комплекс; Нет даты ввода; Смена назначения',\n",
       "       'Комплекс; Транзит, Δ цены: 425.68%',\n",
       "       'Комплекс; Транзит, Δ цены: 427.39%',\n",
       "       'Комплекс; Транзит, Δ цены: 1569.38%',\n",
       "       'Комплекс; Смена назначения; Транзит, Δ цены: 253.83%',\n",
       "       'Комплекс; Смена назначения; Транзит, Δ цены: 595.11%',\n",
       "       'Комплекс; Транзит, Δ цены: 61.47%',\n",
       "       'Комплекс; Транзит, Δ цены: 61.27%',\n",
       "       'Комплекс; Транзит, Δ цены: 65.38%',\n",
       "       'Комплекс; Смена назначения; Транзит, Δ цены: 4.88%',\n",
       "       'Доля; Комплекс; Рассрочка; Смена назначения',\n",
       "       'Доля; Комплекс; Рассрочка',\n",
       "       'Комплекс; Смена назначения; Транзит, Δ цены: 8619.55%',\n",
       "       'Комплекс; Транзит, Δ цены: 103.40%',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями; Продажа с аукциона',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа с аукциона',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продажа нескольких объектов в комплексе',\n",
       "       'Продажа доли в праве собственности; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продажа доли в праве собственности; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продавец Государство; Продажа доли в праве собственности; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продажа в течении года после ввода в эксплуатацию; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 9.66%; Продажа нескольких объектов в комплексе',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 91.54%; Продажа нескольких объектов в комплексе',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 90.05%; Продажа нескольких объектов в комплексе',\n",
       "       'Продажа доли в праве собственности; Продажа нескольких объектов в комплексе',\n",
       "       'Комплекс; Транзит, Δ цены: 83.81%',\n",
       "       'Комплекс; Транзит, Δ цены: 4.56%',\n",
       "       'Комплекс; Между аффилир. лицами; Смена назначения; Цена содержит НДС',\n",
       "       'Комплекс; Между аффилир. лицами',\n",
       "       'Доля; Комплекс; Смена назначения',\n",
       "       'Комплекс; Транзит, Δ цены: 550.54%',\n",
       "       'Комплекс; Транзит, Δ цены: 4.99%',\n",
       "       'Комплекс; Транзит, Δ цены: 9.09%',\n",
       "       'Комплекс; Транзит, Δ цены: 5.00%',\n",
       "       'Комплекс; Транзит, Δ цены: 17.61%',\n",
       "       'Комплекс; Транзит, Δ цены: 13.38%',\n",
       "       'Комплекс; Транзит, Δ цены: 83.80%',\n",
       "       'Комплекс; Транзит, Δ цены: 95.95%',\n",
       "       'Комплекс; Транзит, Δ цены: 0.05%',\n",
       "       'Комплекс; Рассрочка; Транзит, Δ цены: 1.50%; Цена содержит НДС',\n",
       "       'Комплекс; Рассрочка; Транзит, Δ цены: 1.50%',\n",
       "       'Комплекс; Транзит, Δ цены: 42.86%',\n",
       "       'Комплекс; Продавец Государство; Рассрочка',\n",
       "       'Аукцион; Комплекс; Нет даты ввода; Продавец Государство',\n",
       "       'Комплекс; Транзит, Δ цены: 54.63%',\n",
       "       'Комплекс; Транзит, Δ цены: 22.32%',\n",
       "       'Комплекс; Транзит, Δ цены: 31.14%',\n",
       "       'Комплекс; Транзит, Δ цены: 0.10%',\n",
       "       'Комплекс; Транзит, Δ цены: 5.15%',\n",
       "       'Комплекс; Нет даты ввода; Нет площади',\n",
       "       'Комплекс; Транзит, Δ цены: 13.01%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 13.01%',\n",
       "       'Комплекс; Транзит, Δ цены: 269.46%',\n",
       "       'Комплекс; Смена назначения; Транзит, Δ цены: 10.08%',\n",
       "       'Комплекс; Транзит, Δ цены: 10.33%',\n",
       "       'Комплекс; Транзит, Δ цены: 75.00%',\n",
       "       'Комплекс; Первичный рынок; Транзит, Δ цены: 11.44%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 7.01%',\n",
       "       'Комплекс; Нет даты ввода; Нет площади; Транзит, Δ цены: 86.34%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 86.34%',\n",
       "       'Комплекс; Транзит, Δ цены: 86.34%', 'Комплекс; Нет площади',\n",
       "       'Комплекс; Первичный рынок; Транзит, Δ цены: 25.00%',\n",
       "       'Комплекс; Проверяется дата ввода; Продавец Государство',\n",
       "       'Комплекс; Транзит, Δ цены: 403.93%',\n",
       "       'Комплекс; Транзит, Δ цены: 12273.21%',\n",
       "       'Комплекс; Транзит, Δ цены: 68.94%',\n",
       "       'Комплекс; Транзит, Δ цены: 473.83%',\n",
       "       'Комплекс; Транзит, Δ цены: 61.98%',\n",
       "       'Комплекс; Транзит, Δ цены: 17.93%',\n",
       "       'Комплекс; Транзит, Δ цены: 32.33%',\n",
       "       'Комплекс; Транзит, Δ цены: 84.16%',\n",
       "       'Комплекс; Транзит, Δ цены: 25.04%',\n",
       "       'Комплекс; Транзит, Δ цены: 24.57%',\n",
       "       'Комплекс; Транзит, Δ цены: 95.55%', 'Комплекс; Рассрочка',\n",
       "       'Комплекс; Нет даты ввода; Рассрочка',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 0.00%',\n",
       "       'Комплекс; Продавец Банк; Цена содержит НДС',\n",
       "       'Комплекс; Транзит, Δ цены: 74.34%',\n",
       "       'Комплекс; Транзит, Δ цены: 74.37%',\n",
       "       'Комплекс; Первичный рынок; Транзит, Δ цены: 4.40%',\n",
       "       'Аукцион; Комплекс; Продавец Банк',\n",
       "       'Комплекс; Транзит, Δ цены: 7.14%',\n",
       "       'Аукцион; Комплекс; Продавец Государство; Смена назначения',\n",
       "       'Доля; Комплекс; Транзит, Δ цены: 361.54%',\n",
       "       'Нерепрезентативная сделка; Отсутствует цена договора; Продажа нескольких объектов в комплексе',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 93.52%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 35.24%',\n",
       "       'Комплекс; Транзит, Δ цены: 93.52%',\n",
       "       'Комплекс; Транзит, Δ цены: 19.94%',\n",
       "       'Комплекс; Первичный рынок; Рассрочка',\n",
       "       'Комплекс; Транзит, Δ цены: 203.34%',\n",
       "       'Комплекс; Транзит, Δ цены: 37.93%',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 31.96%; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 42.11%; Продажа нескольких объектов в комплексе',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 27.45%; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 30.85%; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 33.08%; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 23.53%; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 47.62%; Продажа нескольких объектов в комплексе',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 34.07%; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью; Продажа с аукциона',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Комплекс; Транзит, Δ цены: 60.00%',\n",
       "       'Комплекс; Транзит, Δ цены: 25.00%',\n",
       "       'Комплекс; Транзит, Δ цены: 17.50%',\n",
       "       'Комплекс; Транзит, Δ цены: 157.27%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 90.00%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 30.74%',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 1.61%; Продажа доли в праве собственности; Продажа нескольких объектов в комплексе',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 2.50%; Продажа нескольких объектов в комплексе',\n",
       "       'Комплекс; Продавец Банк; Транзит, Δ цены: 0.95%',\n",
       "       'Комплекс; Транзит, Δ цены: 1.60%',\n",
       "       'Комплекс; Транзит, Δ цены: 373.68%',\n",
       "       'Аукцион; Комплекс; Проверяется дата ввода; Продавец Государство',\n",
       "       'Продажа в течении года после ввода в эксплуатацию; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 62.50%; Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Комплекс; Нет даты ввода; Проверяется этаж; Продавец Банк',\n",
       "       'Комплекс; Транзит, Δ цены: 2.34%',\n",
       "       'Нерепрезентативная сделка; Отсутствует цена договора; Продажа доли в праве собственности; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Продажа доли в праве собственности; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Нерепрезентативная сделка; Отсутствует валюта договора; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Доля; Комплекс; Продавец Государство',\n",
       "       'Комплекс; Транзит, Δ цены: 174.51%',\n",
       "       'Комплекс; Нет даты ввода; Транзит, Δ цены: 174.51%',\n",
       "       'Комплекс; Нет даты ввода; Смена назначения; Транзит, Δ цены: 0.00%',\n",
       "       'Комплекс; Транзит, Δ цены: 1922.00%',\n",
       "       'Комплекс; Недостоверная дата сделки; Нет даты ввода; Продавец Государство',\n",
       "       'Комплекс; Транзит, Δ цены: 66.55%',\n",
       "       'Нерепрезентативная сделка; Отсутствует цена договора; Продажа доли в праве собственности; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Комплекс; Транзит, Δ цены: 450.28%',\n",
       "       'Доля; Комплекс; Проверяется дата ввода; Продавец Государство',\n",
       "       'Комплекс; Транзит, Δ цены: 4.89%',\n",
       "       'Нерепрезентативная сделка; Отсутствует цена договора; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Нерепрезентативная сделка; Отсутствует цена договора; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа «под снос»',\n",
       "       'Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью; Продажа «под снос»',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе; Продажа «под снос»',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Отсутствует цена договора; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Нерепрезентативная сделка; Отсутствует цена договора; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе; Продажа объекта в период нестабильной финансово-экономической ситуации; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Нерепрезентативная сделка; Продажа нескольких объектов в комплексе; Продажа объекта в период нестабильной финансово-экономической ситуации; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа нескольких объектов в комплексе; Продажа объекта в период нестабильной финансово-экономической ситуации; Продажа объекта нетипичной для данного рынка площадью; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Количество комнат в квартире >9; Нерепрезентативная сделка; Продажа нескольких объектов в комплексе',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Отсутствует цена договора; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Отсутствует цена договора; Продажа нескольких объектов в комплексе',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Отсутствует цена договора; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Нерепрезентативная сделка; Отсутствует дата ввода; Продажа доли в праве собственности; Продажа нескольких объектов в комплексе; Продажа объекта с составными частями и принадлежностями',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 37.50%; Продажа нескольких объектов в комплексе',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 150.00%; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 90.00%; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 96.67%; Продажа нескольких объектов в комплексе; Продажа объекта нетипичной для данного рынка площадью',\n",
       "       'Вторая и последующие сделки с объектом, совершенные в течении года (транзит), Δ цены: 95.83%; Продажа нескольких объектов в комплексе',\n",
       "       'Продажа в течении года после ввода в эксплуатацию; Продажа нескольких объектов в комплексе',\n",
       "       'Комплекс; Транзит, Δ цены: 68.86%',\n",
       "       'Комплекс; Транзит, Δ цены: 48.74%'], dtype=object)"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "filtered_df.loc[idx_complex, \"Маркеры\"].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "066aa649",
   "metadata": {},
   "source": [
    "Переходящая доля\n",
    "for word in filtered_df['Переходящая доля'].unique():\n",
    "print(word)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "id": "3f5dd548",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1/1, 1/1\n",
      "1/1\n",
      "1/10, 1/10\n",
      "1/2, 1/2\n",
      "3/5, 3/5\n",
      "99/200, 99/200\n",
      "1/2, 1/2, 1/2, 1/2\n",
      "7/8, 1/8, 7/8, 1/8\n",
      "1/2, 1/2, 1/2\n",
      "1/2\n",
      "5/8, 5/8\n",
      "7/20, 7/20\n",
      "1/3, 1/3, 1/3, 1/3, 1/3, 1/3\n",
      "1/1, 1/1, 1/1\n",
      "99/100, 99/100\n",
      "161/500, 161/500\n",
      "4/8, 4/8, 1/2, 1/2\n",
      "1/4, 3/4\n",
      "1/3, 2/3\n",
      "1/8\n",
      "1339/2234\n",
      "2/3, 1/3\n",
      "1/4, 1/4\n",
      "317/840\n",
      "1/12, 1/12, 1/12\n",
      "2/15\n",
      "1/15\n",
      "1/3\n",
      "1/10\n",
      "339/500\n",
      "13/40\n",
      "1/30\n",
      "4922/10000\n",
      "5/23\n",
      "1/10, 9/20, 9/20\n",
      "74/100\n",
      "290/10000\n",
      "683/10000\n",
      "1/4\n",
      "9/20\n",
      "7/8, 1/8\n",
      "33/50, 17/50\n",
      "10/100\n",
      "15/28\n",
      "1/3, 1/3, 1/3\n",
      "33/2000, 233/10000, 17/2000\n",
      "33/2000, 17/2000, 233/10000\n",
      "30/100\n",
      "5/100, 40/100, 15/100\n",
      "9517/10000\n",
      "7/20\n",
      "13/20\n",
      "9191/10000\n",
      "5452/10000\n",
      "99/400\n",
      "3/10, 3/10, 4/10\n",
      "3/4, 1/4\n",
      "9/125\n",
      "1/4, 1/4, 1/2\n",
      "1/6, 1/6\n",
      "1/20\n",
      "2/5\n",
      "3/5\n",
      "1/5, 3/5, 1/5\n",
      "41/50\n",
      "333/500\n",
      "49/100\n",
      "2236/10000\n",
      "53/100\n",
      "nan\n",
      "7/50, 7/50\n",
      "1/8, 1/8, 1/8, 1/8\n",
      "1/3, 1/3\n",
      "7/10, 3/10, 7/10, 3/10\n",
      "9/50\n",
      "61/125\n",
      "4/6, 1/6, 1/6\n",
      "11/50\n",
      "1/12, 1/24\n",
      "39/250\n",
      "1/5, 1/5, 2/5, 1/5\n",
      "1/5, 2/5, 1/5, 1/5\n",
      "147/2000\n",
      "6/10\n",
      "87/200\n",
      "2/3\n",
      "47/100\n",
      "1/5\n",
      "3/25\n",
      "1/6\n",
      "3/32, 3/32\n",
      "21/50, 29/50\n",
      "300/500\n",
      "7/25\n",
      "3/4\n",
      "1/30, 8/30, 1/30\n",
      "8/100\n",
      "7342/10000\n",
      "19/50\n",
      "8/25\n",
      "2/6\n",
      "33/100, 34/100, 33/100\n",
      "9383/100000\n",
      "7524/100000\n",
      "7980/100000\n",
      "1/2, 1/4\n",
      "1/15, 9/10, 1/30\n",
      "7/100\n",
      "15303/100000\n",
      "31/50\n",
      "4971/500000\n",
      "9/10\n",
      "11/100\n",
      "31/100\n",
      "6/10, 4/10\n",
      "1/10, 7/10, 1/10, 1/10\n",
      "1/10, 1/10, 7/10, 1/10\n",
      "48245/100000\n",
      "12/25, 12/25\n",
      "19/20, 1/20\n",
      "36/100\n",
      "6/100\n",
      "2543/5000\n",
      "1/8, 7/8\n",
      "1/12\n",
      "527/1250, 723/1250\n",
      "7/25, 7/25\n",
      "13/1000, 13/1000\n",
      "1/2, 1/2, 1/2, 1/2, 1/2, 1/2\n",
      "1/100, 1/100\n",
      "1/100\n",
      "5/6\n",
      "68594/76329\n",
      "2/5, 3/10, 3/10\n",
      "3/10\n",
      "1/100, 1/100, 1/100, 1/100, 1/100, 1/100, 1/100, 1/100, 85/100, 1/100, 1/100, 1/100, 1/100, 1/100, 1/100, 1/100\n",
      "4/6\n",
      "2359/10000\n",
      "1/3, 1/3, 1/3, 1/3\n",
      "2078/3000\n",
      "922/3000\n",
      "10/20, 7/20, 3/20\n",
      "13/25\n",
      "1/20, 1/20, 1/20, 1/20\n",
      "1304/3000\n",
      "1/5, 1/5, 1/5, 1/5, 1/5\n",
      "6/50\n",
      "1/2, 1/4, 1/4\n",
      "33/1000, 33/1000\n",
      "54405/100000\n",
      "571/598\n",
      "2788/10000, 2788/10000\n",
      "11/40\n",
      "121/203\n",
      "1/4, 1/2, 1/4\n",
      "35/100, 15/100\n",
      "3/20, 3/20\n",
      "7/1000\n",
      "13/1000\n",
      "567/20000\n",
      "1/6, 1/6, 1/6, 1/6\n",
      "617/2000, 617/2000\n",
      "1/30, 1/15\n",
      "1/4, 1/4, 1/4, 1/4, 1/4, 1/4, 1/4, 1/4\n",
      "33/125, 33/125, 33/125\n",
      "9/25, 9/25\n",
      "1/20, 1/20\n",
      "2/3, 2/3\n",
      "1/50, 1/100, 1/100\n",
      "1/4, 1/4, 1/4\n",
      "1/348, 9/870, 1/348\n",
      "29/720\n",
      "7918/17807\n",
      "9889/17807\n",
      "3/10, 7/10, 3/10, 7/10\n",
      "24/25\n",
      "1/2, 1/2, 1/1\n",
      "2/8, 1/4\n",
      "1/10, 1/10, 1/10\n",
      "15/41\n",
      "14/25\n"
     ]
    }
   ],
   "source": [
    "for word in filtered_df[\"Переходящая доля\"].unique():\n",
    "    print(word)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "id": "992e9ca3",
   "metadata": {},
   "outputs": [],
   "source": [
    "not_allowed_fractions = [\"1/1\", \"1/1, 1/1\", \"1/1, 1/1, 1/1\", pd.NA]\n",
    "idx_without_1_1 = filtered_df[\n",
    "    (~filtered_df[\"Переходящая доля\"].isin(not_allowed_fractions))\n",
    "    & (filtered_df[\"Переходящая доля\"].notna())\n",
    "].index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dbd8415c",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "id": "187c0e85",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OK → ./data/выгрузка_6_листов_4_задача_v2.xlsx\n"
     ]
    }
   ],
   "source": [
    "# Собираем в список в нужном порядке\n",
    "idx_list = [\n",
    "    idx_dolya_AU,  # 1) столбец AU (маркеры) - доля\n",
    "    idx_without_1_1,  # 2) столбец AC (переходящая доля) — все, кроме 1/1; 1/1,1/1; 1/1,1/1,1/1 и пустых\n",
    "    idx_with_two_and_more,  # 3) столбец R (кол-во объектов) >= 2\n",
    "    idx_complex,  # 4) столбец AU (маркеры) - комплекс\n",
    "    idx_dolya_U,  # 5) столбец U (описание цены включает \"доля/долей/доли …\")\n",
    "    idx_price_starts,  # 6) столбец U (\"Цена указана за ... объектов\")\n",
    "]\n",
    "\n",
    "sheet_names = [\n",
    "    \"AU маркеры — доля\",\n",
    "    \"AC переходящая — исключ.\",\n",
    "    \"R кол-во ≥ 2\",\n",
    "    \"AU маркеры — комплекс\",\n",
    "    \"U описание — доля\",\n",
    "    \"U описание — цена указана\",\n",
    "]\n",
    "\n",
    "\n",
    "# ====== ПОМОЩНИК: безопасно получить ДФ по списку индексов ======\n",
    "def df_from_idx(df: pd.DataFrame, idxs) -> pd.DataFrame:\n",
    "    \"\"\"\n",
    "    Возвращает срез df по меткам индекса из idxs.\n",
    "    - Тихо игнорирует отсутствующие метки (пересечение с df.index).\n",
    "    - Сбрасывает индекс (без колонки индекса).\n",
    "    \"\"\"\n",
    "    if idxs is None:\n",
    "        return df.head(0).copy()\n",
    "    keep = df.index.intersection(pd.Index(idxs))\n",
    "    return df.loc[keep].reset_index(drop=True)\n",
    "\n",
    "\n",
    "# Собираем датафреймы для каждого листа\n",
    "dfs_per_sheet = [df_from_idx(filtered_df, x) for x in idx_list]\n",
    "\n",
    "# ====== ЗАПИСЬ В EXCEL ======\n",
    "out_path = \"./data/выгрузка_6_листов_4_задача_v2.xlsx\"\n",
    "with pd.ExcelWriter(out_path, engine=\"xlsxwriter\") as writer:\n",
    "    for sheet_df, name in zip(dfs_per_sheet, sheet_names):\n",
    "        safe_name = name[:31]\n",
    "        sheet_df.to_excel(writer, index=False, sheet_name=safe_name)\n",
    "\n",
    "print(f\"OK → {out_path}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "75ceec36",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "filtered_df: (7224, 89) => combined (OR): (7224, 89)\n"
     ]
    }
   ],
   "source": [
    "mask_any = pd.Series(False, index=filtered_df.index)\n",
    "\n",
    "for idx in idx_list:\n",
    "    if isinstance(idx, (pd.Series, np.ndarray)) and (\n",
    "        (isinstance(idx, pd.Series) and idx.dtype == bool)\n",
    "        or (isinstance(idx, np.ndarray) and idx.dtype == bool)\n",
    "    ):\n",
    "        cur = pd.Series(\n",
    "            idx,\n",
    "            index=(\n",
    "                filtered_df.index\n",
    "                if not isinstance(idx, pd.Series)\n",
    "                else idx.index\n",
    "            ),\n",
    "        )\n",
    "        cur = cur.reindex(filtered_df.index, fill_value=False).astype(bool)\n",
    "        mask_any |= cur\n",
    "\n",
    "    # Иначе считаем, что это индекс-подмножество строк (метки или позиции)\n",
    "    else:\n",
    "        cur = filtered_df.index.isin(pd.Index(idx))\n",
    "        mask_any |= cur\n",
    "\n",
    "# Единый датасет по правилу \"хотя бы одно условие истинно\"\n",
    "filtered_df = filtered_df.loc[mask_any].copy()\n",
    "\n",
    "print(\"filtered_df:\", filtered_df.shape, \"=> combined (OR):\", filtered_df.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c221ff01",
   "metadata": {},
   "source": [
    "## 5. В грязном датасете распределить доли:\n",
    "\n",
    "Правило:\n",
    "столбец D (Инвентарный номер) должны совпадать, столбец АС (Переходящая доля) не равна 1/1; 1/1, 1/1; 1/1, 1/1, 1/1 и не пустая, то применяются следующие правила.\n",
    "\n",
    "5.1 Стоимость не приводится к доле 1, если в описании цены написано \"стоимость за весь объект, за все помещение, здание и т.д.\"\n",
    "Например,столбец АС Переходящая доля 3/4, 1/4, 3/4, 1/4, столбец D (Инвентарный номер) совпадает и в описании цены указано общая стоимость, значит стоимость не подлежит распределению.\n",
    "Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например, 1.\n",
    "\n",
    "5.2 Стоимость приводится к 1, если в описании цены указано стоимость X/X доли.\n",
    "Например, столбец АС Переходящая доля 3/5, 3/5, столбец D (Инвентарный номер) совпадает и в столбец U (Описание цены) указано \"стоимость X/X долей........\" проводим увеличение стоимости до полной доли.\n",
    "Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,2.\n",
    "\n",
    "5.3 Стоимость долей объединяется, если описание цены пустое, столбец D (Инвентарный номер) совпадает, столбец S (Цена в бел. руб.) разные, Переходящая доля равна в сумме 1. После объединения стоимости в бел руб, стоимость необходимо перевести в 3 валюты.\n",
    "Например, столбец АС Переходящая доля 1/4, 3/4, столбец D (Инвентарный номер) 500/D-7110374.\n",
    "Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,3.\n",
    "\n",
    "5.4 Стоимость долей не приводится, если столбец D (Инвентарный номер) совпадает, в столбец U (Описание цены) ничего не написано, столбец S (Цена в бел. руб.) одинаковые.\n",
    "Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,4.\n",
    "\n",
    "Эти правила должны закрыть большую часть.\n",
    "После разбора по этим правилам, то что останется я изучу и смогу сказать есть ли еще правила.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "id": "13b9db99",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df_merged = pd.read_excel(\"./data/total_df_with_curr.xlsx\")\n",
    "total_df = total_df_merged.copy()\n",
    "total_df = total_df[\n",
    "    (~total_df[\"Переходящая доля\"].isin(not_allowed_fractions))\n",
    "    & (\n",
    "        total_df[\"Переходящая доля\"].notna()\n",
    "        & (total_df[\"Количество объектов в сделке\"] > 1)\n",
    "    )\n",
    "]\n",
    "# берем инв номера > 1\n",
    "total_df = total_df[total_df.duplicated(\"Инвентарный номер\", keep=False)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "id": "d2cd3797",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(27, 89)"
      ]
     },
     "execution_count": 133,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "1451d483",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Колонки\n",
    "# =========================\n",
    "COL_INV = \"Инвентарный номер\"  # D\n",
    "COL_SHARE = \"Переходящая доля\"  # AC\n",
    "COL_PRICE_BYN = \"Цена в бел. руб.\"  # S\n",
    "COL_DESC = \"Описание цены\"  # U\n",
    "COL_RULE = \"RULE_ID\"  # результат\n",
    "\n",
    "WRITE_MASK = [\n",
    "    COL_INV,\n",
    "    COL_SHARE,\n",
    "    COL_PRICE_BYN,\n",
    "    COL_DESC,\n",
    "    COL_RULE,\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "id": "b74bdbd2",
   "metadata": {},
   "outputs": [],
   "source": [
    "def _normalize_text(x: str) -> str:\n",
    "    \"\"\"\n",
    "    Нормализация текста: to str, lower, замена NBSP/узких пробелов,\n",
    "    схлопывание whitespace до одного пробела, trim.\n",
    "    \"\"\"\n",
    "    s = \"\" if x is None else str(x)\n",
    "    s = s.replace(\"\\u00a0\", \" \").replace(\"\\u2009\", \" \").replace(\"\\u202f\", \" \")\n",
    "    s = s.lower()\n",
    "    s = re.sub(r\"\\s+\", \" \", s).strip()\n",
    "    return s\n",
    "\n",
    "\n",
    "def _ensure_rule_col(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    \"\"\"\n",
    "    Гарантирует наличие столбца RULE_ID (строки). Не мутирует исходный df.\n",
    "    \"\"\"\n",
    "    out = df.copy()\n",
    "    if COL_RULE not in out.columns:\n",
    "        out[COL_RULE] = \"\"\n",
    "    else:\n",
    "        out[COL_RULE] = out[COL_RULE].astype(str).fillna(\"\")\n",
    "    return out\n",
    "\n",
    "\n",
    "def _assign_group_rule(\n",
    "    out: pd.DataFrame, mask_condition: pd.Series, rule_id: str\n",
    "):\n",
    "    \"\"\"\n",
    "    Назначает RULE_ID=rule_id всем строкам тех инв. групп,\n",
    "    где внутри группы есть хотя бы одна строка с mask_condition=True,\n",
    "    но только если им ещё не присвоено более приоритетное правило (COL_RULE==\"\").\n",
    "    \"\"\"\n",
    "    group_has = mask_condition.groupby(out[COL_INV]).transform(\"any\")\n",
    "    out.loc[(out[COL_RULE] == \"\") & group_has, COL_RULE] = rule_id\n",
    "\n",
    "\n",
    "def _to_number_series(x: pd.Series) -> pd.Series:\n",
    "    \"\"\"\n",
    "    Приводит столбец к числовому виду (float), понимая BYN в строках с пробелами/запятыми.\n",
    "    \"\"\"\n",
    "    if np.issubdtype(x.dtype, np.number):\n",
    "        return x.astype(float)\n",
    "    return (\n",
    "        x.astype(str)\n",
    "        .str.replace(\"\\u00a0\", \"\", regex=False)\n",
    "        .str.replace(\" \", \"\", regex=False)\n",
    "        .str.replace(\",\", \".\", regex=False)\n",
    "    ).pipe(pd.to_numeric, errors=\"coerce\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "64a3fb18",
   "metadata": {},
   "outputs": [],
   "source": [
    "PAT_SHARE_IN_DESC = re.compile(\n",
    "    r\"(?:\\b\\d+\\s*/\\s*\\d+\\b)|\\bдол(?:я|и|ей|ю|ях|ями|е|ам|\\.?)\\b\",\n",
    "    flags=re.IGNORECASE,\n",
    ")\n",
    "\n",
    "# 5.1: «за весь объект / за целое …» (расширенный шаблон + ваши фразы)\n",
    "PAT_WHOLE = re.compile(\n",
    "    r\"(?:\"\n",
    "    r\"\\bобщая\\s*стоимость\\b|\"  # общая стоимость\n",
    "    r\"(?:\\bцена|\\bстоимость)\\s*за\\s*(?:весь|всё|все)\\s*объект\\w*|\"  # цена/стоимость за весь объект\n",
    "    r\"(?:\\bцена|\\bстоимость)\\s*за\\s*(?:весь|всё|все)\\s*\"\n",
    "    r\"(?:помещени\\w*|здани\\w*|комплекс\\w*|имуществ\\w*)|\"  # за всё помещение/здание/...\n",
    "    r\"(?:\\bцена|\\bстоимость)\\s*указан[ао]?\\s*за\\s*цел\\w*\"\n",
    "    r\"(?:\\s*(?:объект\\w*|помещени\\w*|здани\\w*|комплекс\\w*|имуществ\\w*))?|\"  # цена указана за целое ...\n",
    "    r\"\\bуказан[ао]?\\s*цена\\s*за\\s*(?:весь|всё|все)\\s*объект\\w*|\"  # указана цена за весь объект\n",
    "    r\"стоимость\\s*(?:за\\s*)?(?:весь|всё|все)\\s*\"\n",
    "    r\"(?:объект|объекты|помещение|помещения|здание|здания|\"\n",
    "    r\"комплекс|имущество|капитал\\w*\\s*строен\\w*|строен\\w*|сооружен\\w*)|\"  # капитальное строение/сооружение\n",
    "    r\"стоимость\\s*(?:всего|за\\s*весь)\\s*(?:объекта|помещения|здания|комплекса|имущества)|\"\n",
    "    r\"(?:\\bсумма|\\bцена)\\s*за\\s*(?:всё|все)\\b|\"\n",
    "    r\"\\bуказан[ао]?\\s*общая\\s*сумма\\b|\"\n",
    "    r\"(?:\\bцена|\\bстоимость)\\s*указан[ао]?\\s*за\\s*\\d+\"\n",
    "    r\"(?:\\s*(?:объект(?:ов|а)?|помещени\\w*|здани\\w*|\"\n",
    "    r\"капитал\\w*\\s*(?:строен\\w*|сооружен\\w*)|комплекс\\w*|единиц\\w*))?|\"  # цена указана за N объектов/единиц\n",
    "    # добавленные формулировки (ваши списки)\n",
    "    r\"\\bуказан[ао]?\\s*стоимость\\s*целого\\s*капитал\\w*\\s*строен\\w*\\b|\"  # Указана стоимость целого капитального строения\n",
    "    r\"\\bстоимость\\s*указан[ао]?\\s*за\\s*в(?:сё|се)\\s*помещени\\w*\\b|\"  # Стоимость указана за всё помещение\n",
    "    r\"\\bстоимость\\s*целого\\s*(?:изолированн\\w*\\s*)?помещени\\w*\\b|\"  # стоимость целого (изолированного) помещения\n",
    "    r\"\\bцена\\s*указан[ао]?\\s*в\\s*отношени[ие]\\s*всего\\s*объект\\w*\\b|\"  # цена указана в отношении всего объекта\n",
    "    r\"\\bцена\\s*указан[ао]?\\s*за\\s*помещени\\w*\\b|\"  # цена указана за помещение\n",
    "    r\"\\bцена\\s*помещени\\w*\\s*по\\s*договору\\b|\"  # цена помещения по договору\n",
    "    r\"\\bцена\\s*за\\s*помещени\\w*\\s*в\\s*целом\\b|\"  # цена за помещение в целом\n",
    "    r\"\\bуказан[ао]?\\s*общая\\s*цена\\s*за\\s*капитал\\w*\\b|\"  # Указана общая цена за капитальные …\n",
    "    r\"\\bцена\\s*за\\s*целое\\s*помещени\\w*\\s*указан[ао]?\\s*согласно\\b|\"  # цена за целое помещение указана согласно\n",
    "    r\"\\bобщая\\s*сумма\\s*по\\s*договору\\s*(?:купли-?продажи)?\\b|\"  # общая сумма по договору (купли-продажи)\n",
    "    r\"\\bцена\\s*за\\s*целое\\s*(?:изолированн\\w*\\s*)?помещени\\w*\\b|\"  # цена за целое изолированное помещение\n",
    "    r\"\\bцена\\s*за\\s*целы[йе]\\s*объект\\b|\"  # цена за целый объект\n",
    "    r\"\\bуказан[ао]?\\s*цена\\s*за\\s*целое\\s*капитал\\w*\\s*строен\\w*\\b\"  # Указана цена за целое капитальное строение\n",
    "    r\")\",\n",
    "    flags=re.IGNORECASE,\n",
    ")\n",
    "\n",
    "# Фракция a/b (для 5.2, 5.3)\n",
    "_FRACTION_RE = re.compile(r\"\\b(\\d+)\\s*/\\s*(\\d+)\\b\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "761b77e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "def apply_rule_5_1(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    out = _ensure_rule_col(df)\n",
    "    desc_norm = out[COL_DESC].fillna(\"\").map(_normalize_text)\n",
    "    mask_whole = desc_norm.str.contains(\n",
    "        PAT_WHOLE\n",
    "    )  # упоминание \"за весь объект\"\n",
    "    mask_has_share = desc_norm.str.contains(\n",
    "        PAT_SHARE_IN_DESC\n",
    "    )  # есть явные упоминания доли\n",
    "    mask_rule_row = mask_whole & ~mask_has_share  # цена за целое и нет доли\n",
    "    _assign_group_rule(out, mask_rule_row, \"1\")  # приоритет по группе\n",
    "    return out\n",
    "\n",
    "\n",
    "def _extract_first_fraction_not_1(desc: str):\n",
    "    # берём первую дробь != 1/1; если нет — None\n",
    "    for m in _FRACTION_RE.finditer(desc or \"\"):\n",
    "        num = int(m.group(1))\n",
    "        den = int(m.group(2))\n",
    "        if den == 0 or num == den:\n",
    "            continue\n",
    "        return num, den, f\"{num}/{den}\"\n",
    "    return None\n",
    "\n",
    "\n",
    "def _extract_fraction_from_cost_phrase(\n",
    "    desc: str, near_limit: int = 20, max_den: int = 100000\n",
    "):\n",
    "    import re\n",
    "\n",
    "    s = (desc or \"\").lower()\n",
    "\n",
    "    # 1) Точный шаблон: \"цена указана в отношении X/X доли в праве собственности\"\n",
    "    m = re.search(\n",
    "        r\"\\bцена\\s+указана\\s+в\\s+отношени\\w*\\s+(\\d+)\\s*/\\s*(\\d+)\\s+дол[яеи]\\s+в\\s+праве\\s+собственности\\b\",\n",
    "        s,\n",
    "        flags=0,\n",
    "    )\n",
    "    if m:\n",
    "        num, den = int(m.group(1)), int(m.group(2))\n",
    "        if den != 0 and num != den and num < den and den <= max_den:\n",
    "            return num, den, f\"{num}/{den}\"\n",
    "\n",
    "    # 2) Остальные допускаемые формулировки (как раньше)\n",
    "    patterns = [\n",
    "        re.compile(\n",
    "            r\"стоимост\\w*.{0,%d}?(\\d+)\\s*/\\s*(\\d+).{0,10}?(дол[а-я]*)\"\n",
    "            % near_limit\n",
    "        ),\n",
    "        re.compile(\n",
    "            r\"стоимост\\w*.{0,%d}?(дол[а-я]*).{0,10}?(\\d+)\\s*/\\s*(\\d+)\"\n",
    "            % near_limit\n",
    "        ),\n",
    "        re.compile(\n",
    "            r\"цен\\w*.{0,10}?за.{0,%d}?(\\d+)\\s*/\\s*(\\d+)(?:.{0,10}?(дол[а-я]*))?\"\n",
    "            % near_limit\n",
    "        ),\n",
    "        re.compile(\n",
    "            r\"цен\\w*.{0,%d}?(\\d+)\\s*/\\s*(\\d+).{0,10}?(дол[а-я]*)\" % near_limit\n",
    "        ),\n",
    "        re.compile(\n",
    "            r\"\\bза.{0,%d}?(\\d+)\\s*/\\s*(\\d+).{0,10}?(дол[а-я]*)\" % near_limit\n",
    "        ),\n",
    "        re.compile(\n",
    "            r\"указан\\w*.{0,%d}?цен\\w*.{0,%d}?(\\d+)\\s*/\\s*(\\d+)(?:.{0,10}?(дол[а-я]*))?\"\n",
    "            % (near_limit, near_limit)\n",
    "        ),\n",
    "        re.compile(\n",
    "            r\"цен\\w*.{0,%d}?указан\\w*.{0,%d}?в\\s*отношени\\w*.{0,%d}?(\\d+)\\s*/\\s*(\\d+)(?:.{0,10}?(дол[а-я]*))?\"\n",
    "            % (near_limit, near_limit, near_limit)\n",
    "        ),\n",
    "    ]\n",
    "\n",
    "    def _looks_like_year_pair(a: int, b: int) -> bool:\n",
    "        return (1900 <= a <= 2099) and (1900 <= b <= 2099)\n",
    "\n",
    "    for pat in patterns:\n",
    "        m = pat.search(s)\n",
    "        if not m:\n",
    "            continue\n",
    "        nums = [int(g) for g in m.groups() if g and g.isdigit()]\n",
    "        if len(nums) < 2:\n",
    "            continue\n",
    "        num, den = nums[0], nums[1]\n",
    "        if (\n",
    "            den == 0\n",
    "            or num == den\n",
    "            or num > den\n",
    "            or den > max_den\n",
    "            or _looks_like_year_pair(num, den)\n",
    "        ):\n",
    "            continue\n",
    "        return num, den, f\"{num}/{den}\"\n",
    "\n",
    "    return None\n",
    "\n",
    "\n",
    "def apply_rule_5_2(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    out = _ensure_rule_col(df).copy()\n",
    "\n",
    "    price_col = COL_PRICE_BYN\n",
    "    price_new_col = f\"{price_col}_new\"  # новая цена, приведённая к 1 доле\n",
    "    if price_new_col not in out.columns:\n",
    "        out[price_new_col] = np.nan\n",
    "\n",
    "    desc_norm = (\n",
    "        out[COL_DESC].fillna(\"\").map(_normalize_text)\n",
    "    )  # нормализация к нижнему регистру\n",
    "    price = _to_number_series(out[price_col])\n",
    "\n",
    "    # если есть \"общая стоимость\" — 5.2 НЕ применяем к этой строке\n",
    "    mask_forbid = desc_norm.str.contains(r\"\\bобщая стоимость\\b\")\n",
    "\n",
    "    has_fraction_row, new_prices = [], []\n",
    "    for s, p, forbid in zip(\n",
    "        desc_norm.tolist(), price.tolist(), mask_forbid.tolist()\n",
    "    ):\n",
    "        if forbid:\n",
    "            has_fraction_row.append(False)  # помечаем как \"не подходит для 5.2\"\n",
    "            new_prices.append(np.nan)  # новую цену не считаем\n",
    "            continue\n",
    "\n",
    "        fx = _extract_fraction_from_cost_phrase(\n",
    "            s\n",
    "        )  # ловит \"стоимость/цена ... X/X (доли)\"\n",
    "        if fx is None or pd.isna(p):\n",
    "            has_fraction_row.append(False)\n",
    "            new_prices.append(np.nan)\n",
    "        else:\n",
    "            num, den, _ = fx\n",
    "            new_prices.append(\n",
    "                p * (den / num) if num != 0 else np.nan\n",
    "            )  # приводим к полной доле\n",
    "            has_fraction_row.append(True)\n",
    "\n",
    "    out[price_new_col] = new_prices\n",
    "\n",
    "    _assign_group_rule(\n",
    "        out, pd.Series(has_fraction_row, index=out.index), \"2\"\n",
    "    )  # метка по группе (как у тебя сейчас)\n",
    "\n",
    "    return out\n",
    "\n",
    "\n",
    "def apply_rule_5_3(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    out = _ensure_rule_col(df).copy()\n",
    "\n",
    "    desc_norm = out[COL_DESC].fillna(\"\").map(_normalize_text)\n",
    "    desc_empty = desc_norm.eq(\"\")  # все описания пустые\n",
    "    price = _to_number_series(out[COL_PRICE_BYN])\n",
    "\n",
    "    def _sum_fractions(s: str):\n",
    "        # суммируем все дроби в ячейке вида \"1/2, 1/2\"; если нет валидных — NaN\n",
    "        if s is None:\n",
    "            return np.nan\n",
    "        text = str(s)\n",
    "        found = list(_FRACTION_RE.finditer(text))\n",
    "        if not found:\n",
    "            return np.nan\n",
    "        total = 0.0\n",
    "        for m in found:\n",
    "            num = int(m.group(1))\n",
    "            den = int(m.group(2))\n",
    "            if den == 0:\n",
    "                return np.nan\n",
    "            total += num / den\n",
    "        return total\n",
    "\n",
    "    share_sum_row = out[COL_SHARE].map(_sum_fractions)  # сумма долей в строке\n",
    "    parsed_ok_row = share_sum_row.notna()\n",
    "\n",
    "    grp = out.groupby(COL_INV)\n",
    "    group_size = grp[COL_INV].transform(\"size\")\n",
    "    mask_group_mult = group_size >= 2  # группа >= 2 строк\n",
    "\n",
    "    all_desc_empty = desc_empty.groupby(out[COL_INV]).transform(\"all\")\n",
    "    price_nunique = price.groupby(out[COL_INV]).transform(\n",
    "        lambda s: s.nunique(dropna=False)\n",
    "    )\n",
    "    diff_prices = price_nunique >= 2  # в группе >=2 уникальных цен\n",
    "\n",
    "    sum_share_group = share_sum_row.groupby(out[COL_INV]).transform(\n",
    "        \"sum\"\n",
    "    )  # сумма долей по группе\n",
    "    all_rows_parsed = parsed_ok_row.groupby(out[COL_INV]).transform(\n",
    "        \"all\"\n",
    "    )  # все строки распарсились\n",
    "    sum_is_one = (\n",
    "        sum_share_group - 1.0\n",
    "    ).abs() <= 1e-6  # сумма долей == 1 (с допуском)\n",
    "\n",
    "    mask_rule_row = (\n",
    "        mask_group_mult\n",
    "        & all_desc_empty\n",
    "        & diff_prices\n",
    "        & all_rows_parsed\n",
    "        & sum_is_one\n",
    "    )\n",
    "\n",
    "    _assign_group_rule(\n",
    "        out, mask_rule_row, \"3\"\n",
    "    )  # только метка; строки не трогаем\n",
    "    return out\n",
    "\n",
    "\n",
    "def apply_rule_5_4(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    out = _ensure_rule_col(df)\n",
    "\n",
    "    desc_norm = out[COL_DESC].fillna(\"\").map(_normalize_text)\n",
    "    mask_desc_empty = desc_norm.eq(\"\")\n",
    "\n",
    "    price = _to_number_series(out[COL_PRICE_BYN])\n",
    "\n",
    "    group_size = out.groupby(COL_INV)[COL_INV].transform(\"size\")\n",
    "    mask_group_mult = group_size >= 2\n",
    "\n",
    "    all_desc_empty = mask_desc_empty.groupby(out[COL_INV]).transform(\"all\")\n",
    "    price_nunique = price.groupby(out[COL_INV]).transform(\n",
    "        lambda s: s.nunique(dropna=False)\n",
    "    )\n",
    "    mask_price_equal = price_nunique.eq(1)  # во всей группе одна и та же цена\n",
    "\n",
    "    mask_rule_row = mask_group_mult & all_desc_empty & mask_price_equal\n",
    "    _assign_group_rule(out, mask_rule_row, \"4\")\n",
    "    return out\n",
    "\n",
    "\n",
    "def finalize_rules_set_zero(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    out = _ensure_rule_col(df).copy()\n",
    "    out[COL_RULE] = out[COL_RULE].fillna(\n",
    "        \"0\"\n",
    "    )  # для всех остальных RULE_ID = '0'\n",
    "    return out\n",
    "\n",
    "\n",
    "def apply_all_rules(df: pd.DataFrame) -> pd.DataFrame:\n",
    "    out = df.copy()\n",
    "    out = apply_rule_5_1(out)  # 1\n",
    "    out = apply_rule_5_2(out)  # 2\n",
    "    out = apply_rule_5_3(out)  # 3\n",
    "    out = apply_rule_5_4(out)  # 4\n",
    "    out = finalize_rules_set_zero(out)\n",
    "    return out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "d48b7f28",
   "metadata": {},
   "outputs": [],
   "source": [
    "WRITE_MASK = [\n",
    "    COL_INV,\n",
    "    \"Дата сделки\",\n",
    "    COL_SHARE,\n",
    "    COL_PRICE_BYN,\n",
    "    COL_DESC,\n",
    "    COL_RULE,\n",
    "]\n",
    "\n",
    "\n",
    "result = apply_all_rules(total_df)\n",
    "result[WRITE_MASK].to_excel(\"rules.xlsx\", index=False)\n",
    "# либо сохранить весь df с метками:\n",
    "# result.to_excel(\"rules_all.xlsx\", index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "id": "1256acfa",
   "metadata": {},
   "outputs": [],
   "source": [
    "mask3 = result[COL_RULE].eq(\"3\")\n",
    "\n",
    "# сумма по цене внутри каждой группы ИНВ, но считаем только по строкам с RULE_ID=3\n",
    "sum_by_inv_for_rule3 = result.loc[mask3].groupby(COL_INV)[COL_PRICE_BYN].sum()\n",
    "\n",
    "# если RULE_ID=3 — подставляем групповую сумму, иначе 0\n",
    "result[f\"{COL_PRICE_BYN}_new\"] = np.where(\n",
    "    mask3,\n",
    "    result[COL_INV].map(sum_by_inv_for_rule3).fillna(0),\n",
    "    result[f\"{COL_PRICE_BYN}_new\"],\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "id": "e31de7dc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб._new</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [Цена в бел. руб., Цена в бел. руб._new]\n",
       "Index: []"
      ]
     },
     "execution_count": 140,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result[result[\"RULE_ID\"] == \"3\"][[COL_PRICE_BYN, f\"{COL_PRICE_BYN}_new\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "id": "26476447",
   "metadata": {},
   "outputs": [],
   "source": [
    "result[COL_PRICE_BYN] = np.where(\n",
    "    result[f\"{COL_PRICE_BYN}_new\"].notna()\n",
    "    & (result[f\"{COL_PRICE_BYN}_new\"] != 0),\n",
    "    result[f\"{COL_PRICE_BYN}_new\"],\n",
    "    result[COL_PRICE_BYN],\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "id": "b6a35ba4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб._new</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>3.259726e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>487</th>\n",
       "      <td>8.000000e+04</td>\n",
       "      <td>79999.999776</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>522</th>\n",
       "      <td>4.000000e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1784</th>\n",
       "      <td>7.183200e+05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2481</th>\n",
       "      <td>5.200003e+04</td>\n",
       "      <td>52000.030992</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2618</th>\n",
       "      <td>3.887760e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2619</th>\n",
       "      <td>3.887760e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2686</th>\n",
       "      <td>4.400000e+05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2687</th>\n",
       "      <td>4.400000e+05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3805</th>\n",
       "      <td>2.748000e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3807</th>\n",
       "      <td>1.272000e+05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3808</th>\n",
       "      <td>1.908000e+05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8152</th>\n",
       "      <td>1.542720e+06</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8155</th>\n",
       "      <td>1.763112e+06</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9977</th>\n",
       "      <td>4.887838e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9978</th>\n",
       "      <td>4.887838e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12398</th>\n",
       "      <td>5.200000e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12964</th>\n",
       "      <td>4.950000e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12965</th>\n",
       "      <td>4.950000e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12966</th>\n",
       "      <td>8.249995e+03</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12967</th>\n",
       "      <td>8.249995e+03</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13012</th>\n",
       "      <td>5.000000e+03</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13013</th>\n",
       "      <td>5.000000e+03</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13018</th>\n",
       "      <td>1.500000e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13019</th>\n",
       "      <td>1.500000e+04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15624</th>\n",
       "      <td>1.396842e+05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15625</th>\n",
       "      <td>1.396842e+05</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Цена в бел. руб.  Цена в бел. руб._new\n",
       "108        3.259726e+04                   NaN\n",
       "487        8.000000e+04          79999.999776\n",
       "522        4.000000e+04                   NaN\n",
       "1784       7.183200e+05                   NaN\n",
       "2481       5.200003e+04          52000.030992\n",
       "2618       3.887760e+04                   NaN\n",
       "2619       3.887760e+04                   NaN\n",
       "2686       4.400000e+05                   NaN\n",
       "2687       4.400000e+05                   NaN\n",
       "3805       2.748000e+04                   NaN\n",
       "3807       1.272000e+05                   NaN\n",
       "3808       1.908000e+05                   NaN\n",
       "8152       1.542720e+06                   NaN\n",
       "8155       1.763112e+06                   NaN\n",
       "9977       4.887838e+04                   NaN\n",
       "9978       4.887838e+04                   NaN\n",
       "12398      5.200000e+04                   NaN\n",
       "12964      4.950000e+04                   NaN\n",
       "12965      4.950000e+04                   NaN\n",
       "12966      8.249995e+03                   NaN\n",
       "12967      8.249995e+03                   NaN\n",
       "13012      5.000000e+03                   NaN\n",
       "13013      5.000000e+03                   NaN\n",
       "13018      1.500000e+04                   NaN\n",
       "13019      1.500000e+04                   NaN\n",
       "15624      1.396842e+05                   NaN\n",
       "15625      1.396842e+05                   NaN"
      ]
     },
     "execution_count": 142,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result[[COL_PRICE_BYN, f\"{COL_PRICE_BYN}_new\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "f069758b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Тип недвижимого имущества', 'Инвентарный номер', 'Адрес', 'Назначение',\n",
       "       'Описание назначения', 'Наименование', 'Общая площадь, кв.м',\n",
       "       'Жилая площадь, кв.м', 'Материал стен', 'Дата ввода',\n",
       "       'Дата консервации',\n",
       "       'Дата реконструкции (реставрации, капитального ремонта)', 'Дата сделки',\n",
       "       'Дата регистрации договора', 'Идентификатор сделки',\n",
       "       'Количество объектов в сделке', 'Цена в бел. руб.',\n",
       "       'Цена в бел. руб. за кв.м', 'Описание цены', 'Цена в долларах США',\n",
       "       'Цена в долларах США за кв.м', 'Цена в евро', 'Цена в евро за кв.м',\n",
       "       'Тип цены', 'Цена по договору', 'Валюта по договору',\n",
       "       'Переходящая доля', 'Количество комнат ИП', 'Этаж расположения ИП',\n",
       "       'Инвентарный номер КС', 'Общая площадь КС, кв.м',\n",
       "       'Жилая площадь КС, кв.м', 'Назначение КС', 'Описание назначения КС',\n",
       "       'Наименование КС', 'Процент готовности КС',\n",
       "       'Количество надземных этажей, шт.', 'Количество подземных этажей, шт.',\n",
       "       'Составные элементы и принадлежности', 'Кадастровый номер ЗУ',\n",
       "       'Назначение ЗУ', 'Описание назначения ЗУ', 'Площадь ЗУ, кв.м',\n",
       "       'Уникальный номер АТЕ', 'Маркеры',\n",
       "       'Дата проведения обследования КС / РХ', 'Объем КС, куб.м / РХ',\n",
       "       'Общая площадь жилых помещений КС, кв.м / РХ',\n",
       "       'Общая площадь нежилых помещений КС, кв.м / РХ',\n",
       "       'Количество изолированных помещений (квартир) КС / РХ',\n",
       "       'Физический износ на дату обследования КС, % / РХ',\n",
       "       'Наличие холодного водоснабжения КС / РХ',\n",
       "       'Наличие горячего водоснабжения КС / РХ', 'Наличие канализации КС / РХ',\n",
       "       'Наличие отопления КС / РХ', 'Наличие газоснабжения КС / РХ',\n",
       "       'Наличие электроснабжения КС / РХ', 'Наличие ванн (душей) КС / РХ',\n",
       "       'Наличие напольных электроплит КС / РХ',\n",
       "       'Материал  крыши (кровли) КС / РХ', 'Материал фундамента КС / РХ',\n",
       "       'Материал перекрытий КС / РХ', 'Стоимости КС / РХ', 'sheet_source',\n",
       "       'search_param', 'Распределение долей до сделки',\n",
       "       'Распределение долей после сделки', 'Исходная цена', 'Исходная валюта',\n",
       "       'п/п', 'floor', 'category', 'for_clusters_gr', 'Name NP', 'Name region',\n",
       "       'Name oblast', 'cluster_score', 'cluster', 'Дата', '1 Евро (EUR)',\n",
       "       '1 Российский рубль (RUB)', '1 Доллар США (USD)', 'USD', 'EUR', 'BYN',\n",
       "       'Логика извлечения', 'Форма_USD', 'Форма_EUR', 'Форма_BYN', 'RULE_ID',\n",
       "       'Цена в бел. руб._new'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 143,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "id": "72ac7546",
   "metadata": {},
   "outputs": [],
   "source": [
    "result.drop(\n",
    "    columns=[\"Цена в бел. руб._new\", \"Форма_USD\", \"Форма_EUR\", \"Форма_BYN\"]\n",
    ").to_excel(\"5.xlsx\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8abf0666",
   "metadata": {},
   "source": [
    "## 6. В грязном датасете распределить стоимость комплексов\n",
    "\n",
    "(AU (маркеры) - комплекс), столбец АС (Переходящая доля) равна 1/1; 1/1, 1/1; 1/1, 1/1, 1/1 и пустая.\n",
    "Удаляем строки с полным совпадением.\n",
    "\n",
    "6.1. Столбец Q Идентификатор сделки совпадает, столбец S (Цена в бел. руб.) одинаковый, в столбец U (Описание цены) написано, что это стоимость общая за все объекты или стоимость и перечислены капитальные строения и т.д., то проводится распределение стоимости пропорционально площади объектов в сделке.\n",
    "Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,5.\n",
    "\n",
    "6.2. Столбец Q Идентификатор сделки совпадает, столбец S (Цена в бел. руб.) стоимость разная и в столбце столбец U (Описание цены) ничего не указано, стоимость не распределяется.\n",
    "Найти такие объекты и проставить отличительный знак для них для того чтобы включить в чистый дата сет. Например,6.\n",
    "\n",
    "---\n",
    "\n",
    "Давайте я поясню, доля 1/1; 1/1, 1/1; 1/1, 1/1,1/1 и пустых ячеек говорит о том, что объект продавался целиком. А маркер комплекс говорит о том, что кроме этого объекта в доле 1/1; 1/1, 1/1; 1/1, 1/1,1/1 и пустых ячеек могли продаваться еще другие изолированные помещения/капитальные строения и стоимость у них могла быть общей. В зависимости от этих факторов есть два правила.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "4e98613a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(21996, 89)"
      ]
     },
     "execution_count": 145,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df_merged = pd.read_excel(\"./data/total_df_with_curr.xlsx\")\n",
    "total_df = total_df_merged.copy()\n",
    "total_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "id": "be0cea79",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Start (21996, 89)\n",
      "After complex (6051, 89)\n",
      "After AC (5872, 89)\n"
     ]
    }
   ],
   "source": [
    "print(\"Start\", total_df.shape)\n",
    "total_df = total_df.loc[idx_complex]\n",
    "print(\"After complex\", total_df.shape)\n",
    "# или в 1/1 или пустое\n",
    "total_df = total_df[\n",
    "    (total_df[\"Переходящая доля\"].isin(not_allowed_fractions))\n",
    "    | (total_df[\"Переходящая доля\"].isna())\n",
    "    & (total_df[\"Количество объектов в сделке\"] > 1)\n",
    "]\n",
    "print(\"After AC\", total_df.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "120d64e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['1/1', '1/1, 1/1', '1/1, 1/1, 1/1', nan], dtype=object)"
      ]
     },
     "execution_count": 147,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[\"Переходящая доля\"].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "4eaf0f41",
   "metadata": {},
   "outputs": [],
   "source": [
    "COL_ID = \"Идентификатор сделки\"\n",
    "COL_BYN = \"Цена в бел. руб.\"\n",
    "COL_DESC = \"Описание цены\"\n",
    "COL_AREA = \"Общая площадь, кв.м\"\n",
    "total_df = total_df[\n",
    "    (total_df[COL_ID].duplicated(keep=False))\n",
    "    & (total_df[\"Количество объектов в сделке\"] > 1)\n",
    "]\n",
    "# Столбец для метки правил\n",
    "if \"rules_6\" not in total_df.columns:\n",
    "    total_df[\"rules_6\"] = 0\n",
    "else:\n",
    "    total_df[\"rules_6\"] = total_df[\"rules_6\"].fillna(0).astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "cf8dd5af",
   "metadata": {},
   "outputs": [],
   "source": [
    "PHRASES_RULE1_R = [\n",
    "    # базовые «общая ...»\n",
    "    r\"\\b(?:указан[ао]?\\s*)?(?:общая|итоговая|суммарная)\\s+цена\\b(?:\\s*(?:по\\s+договору(?:\\s+купли-?продажи)?|по\\s+сделке|сделк[ае]))?\",\n",
    "    r\"\\b(?:указан[ао]?\\s*)?(?:общая|итоговая|суммарная)\\s+сумма\\b(?:\\s*(?:по\\s+договору(?:\\s+купли-?продажи)?|по\\s+сделке|сделк[ае]))?\",\n",
    "    r\"\\b(?:указан[ао]?\\s*)?(?:общая|итоговая|суммарная)\\s+стоимость\\b(?:\\s*(?:по\\s+договору(?:\\s+купли-?продажи)?|по\\s+сделке|сделк[ае]))?\",\n",
    "    # явные короткие варианты\n",
    "    r\"\\bуказан[ао]?\\s*общая\\s*сумма\\b\",\n",
    "    r\"\\bуказан[ао]?\\s*общая\\s*стоимость\\b\",\n",
    "    r\"\\bуказан[ао]?\\s*общая\\s*цена\\b\",\n",
    "    r\"\\bОбщая\\s+сумма\\b\",  # строгое соответствие \"Общая сумма\"\n",
    "    # «общая цена объектов/капитальных строений»\n",
    "    r\"\\bобщая\\s+цена\\s+(?:объект\\w*|капиталь\\w+\\s+строени\\w*)\\b\",\n",
    "    # запрошенные дополнительные фразы\n",
    "    r\"\\bцена\\s+капитального\\s+строения\\s+с\\s+ндс\\b\",\n",
    "    r\"\\bцена\\s+продажи\\s+указана\\s+в\\s+отношении\\s+\\d+\\-\",\n",
    "    r\"\\bуказан[ао]?\\s*цена\\s+объект\\w*\\s+с\\s+инвентарн\\w+\\s+номер\\w*\\b\",\n",
    "    r\"\\bсумма\\s+указана\\s+за\\s+капитальные\\s+строения\\s+с\\s+инвентарн\\w+\\s+номер\\w*\\b\",\n",
    "    r\"\\bцена\\s+указана\\s+за\\s+\\d+\\b\",\n",
    "    r\"\\bсумма\\s+указана\\s+за\\s+все\\s+объекты\\s+недвижимости\\b\",\n",
    "    r\"\\bуказана\\s+общая\\s+стоимость\\s+объетов\\b\",\n",
    "    r\"\\bуказана\\s+общая\\s+стоимость\\s+объектов\\b\",\n",
    "    r\"\\bстоимость\\s+за\\s+\\d+\\b\",\n",
    "    r\"\\bсумма\\s+за\\s+отчуждение\\s+капитальных\\s+строений\\s+с\\s+инвентарными\\s+номерами\\b\",\n",
    "    r\"\\bцена\\s+продажи\\s+за\\s+изолированные\\s+помещения\\s+с\\s+инвентарными\\s+номерами\\b\",\n",
    "    r\"\\bцена\\s+продажи\\s+капитального\\s+строения\\b\",\n",
    "    r\"\\bцена\\s+(?:(?:пять|пяти|шесть|шести|семь|семи)|\\d+(?:\\s*[-–—]?\\s*(?:ти|и))?)\\s+капитальных\\s+строений\\b\",\n",
    "    r\"\\bцена\\s+продажи\\s+указана\\s+в\\s+отношении\\s+(?:(?:пять|пяти|шесть|шести|семь|семи)|\\d+(?:\\s*[-–—]?\\s*(?:ти|и))?)\\s+следующ(?:их|его)\\s+объект(?:ов|а)\\b\",\n",
    "    r\"\\bцена\\s+указана\\s+с\\s+уч[её]том\\s+стоимости\\s+(?:(?:\\d+(?:\\s*[-–—]?\\s*(?:ти|и))?)|одно(?:го)?|двух|тр(?:е|ё)х|четыр(?:е|ё)х|пяти|шести|семи|восьми|девяти|десяти|одиннадцати|двенадцати|тринадцати|четырнадцати|пятнадцати|шестнадцати|семнадцати|восемнадцати|девятнадцати|двадцати|тридцати|сорока|пятидесяти|шестидесяти|семидесяти|восьмидесяти|девяноста|(?:двадцати|тридцати|сорока|пятидесяти|шестидесяти|семидесяти|восьмидесяти|девяноста)\\s+(?:одного|двух|тр(?:е|ё)х|четыр(?:е|ё)х|пяти|шести|семи|восьми|девяти))\\s+капитальных\\s+строений\\s+с\\s+инвентарными\\s+номерами\\b\",\n",
    "    r\"\\b(?:цена|стоимость)\\s+указана\\s+с\\s+уч[её]том\\s+стоимости\\s+(?:(?:\\d+(?:\\s*[-–—]?\\s*(?:ти|и))?)|одно(?:го)?|двух|тр(?:е|ё)х|четыр(?:е|ё)х|пяти|шести|семи|восьми|девяти|десяти|одиннадцати|двенадцати|тринадцати|четырнадцати|пятнадцати|шестнадцати|семнадцати|восемнадцати|девятнадцати|двадцати|тридцати|сорока|пятидесяти|шестидесяти|семидесяти|восьмидесяти|девяноста|(?:двадцати|тридцати|сорока|пятидесяти|шестидесяти|семидесяти|восьмидесяти|девяноста)\\s+(?:одного|двух|тр(?:е|ё)х|четыр(?:е|ё)х|пяти|шести|семи|восьми|девяти))\\s+капитальных\\s+строений\\s+с\\s+инвентарными\\s+номерами\\b\",\n",
    "]\n",
    "\n",
    "# --- единый паттерн только из этого списка ---\n",
    "PAT_RULE1_ONLY = re.compile(\n",
    "    \"|\".join(f\"(?:{p})\" for p in PHRASES_RULE1_R),\n",
    "    flags=re.IGNORECASE | re.UNICODE,\n",
    ")\n",
    "\n",
    "\n",
    "def _is_empty_desc(x) -> bool:\n",
    "    return (pd.isna(x)) or (str(x).strip() == \"\")\n",
    "\n",
    "\n",
    "def mask_rule1(series: pd.Series) -> pd.Series:\n",
    "    \"\"\"True там, где описание содержит нужные формулировки.\"\"\"\n",
    "    return (\n",
    "        series.fillna(\"\").astype(str).str.contains(PAT_RULE1_ONLY, regex=True)\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "0f7283c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_col = f\"{COL_BYN}_new\"\n",
    "if new_col not in total_df.columns:\n",
    "    total_df[new_col] = pd.NA  # подготовим столбец\n",
    "\n",
    "for deal_id in total_df[COL_ID].unique():\n",
    "    seg_idx = total_df.index[total_df[COL_ID] == deal_id]\n",
    "    seg = total_df.loc[seg_idx]\n",
    "\n",
    "    prices_nunique = seg[COL_BYN].nunique(dropna=False)\n",
    "    same_price = prices_nunique == 1\n",
    "    prices_vary = prices_nunique > 1\n",
    "\n",
    "    # проверка по списку r\"\" фраз\n",
    "    any_phrase_mask = mask_rule1(seg[COL_DESC])\n",
    "\n",
    "    all_desc_empty = seg[COL_DESC].map(_is_empty_desc).all()\n",
    "    any_desc_has_phrase = any_phrase_mask.any()\n",
    "\n",
    "    # 6.1: одна цена по сделке + найдены целевые формулировки\n",
    "    if same_price and any_desc_has_phrase:\n",
    "        prices = seg[COL_BYN]\n",
    "        total_price = float(prices.iloc[0])\n",
    "\n",
    "        areas = seg[COL_AREA].values\n",
    "        area_sum = areas.sum()\n",
    "\n",
    "        alloc = (areas / area_sum) * total_price\n",
    "        total_df.loc[seg_idx, new_col] = alloc.round(2)\n",
    "        total_df.loc[seg_idx, \"rules_6\"] = 1\n",
    "\n",
    "    # 6.2: цены различаются, описания пустые — переносим исходную цену\n",
    "    elif prices_vary and all_desc_empty:\n",
    "        total_df.loc[seg_idx, new_col] = seg[COL_BYN].values\n",
    "        total_df.loc[seg_idx, \"rules_6\"] = 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "2cd48168",
   "metadata": {},
   "outputs": [],
   "source": [
    "# wanted_cols = [COL_ID, COL_BYN, COL_DESC, COL_AREA, new_col, \"rules_6\"]\n",
    "# export_df = total_df[wanted_cols].sort_values(\n",
    "#     [COL_ID, \"rules_6\"], ascending=[True, False]\n",
    "# )\n",
    "\n",
    "# # путь и сохранение\n",
    "# out_path = \"rules6_result.xlsx\"\n",
    "# with pd.ExcelWriter(out_path, engine=\"openpyxl\") as writer:\n",
    "#     export_df.to_excel(writer, index=False, sheet_name=\"rules6\")\n",
    "\n",
    "# print(f\"Готово: {out_path}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "0d4ac7b5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "rules_6\n",
       "0    3046\n",
       "2    1948\n",
       "1     353\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 152,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[\"rules_6\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "4b3930a4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Цена в бел. руб._new</th>\n",
       "      <th>Описание цены</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>19843</th>\n",
       "      <td>60655494-комплекс</td>\n",
       "      <td>134204.001</td>\n",
       "      <td>76.2</td>\n",
       "      <td>10664.66</td>\n",
       "      <td>(стоимость за 12 (двенадцать) капитальных стро...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19844</th>\n",
       "      <td>60655494-комплекс</td>\n",
       "      <td>134204.001</td>\n",
       "      <td>77.1</td>\n",
       "      <td>10790.62</td>\n",
       "      <td>стоимость за 12 (двенадцать) капитальных строе...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19845</th>\n",
       "      <td>60655494-комплекс</td>\n",
       "      <td>134204.001</td>\n",
       "      <td>79.3</td>\n",
       "      <td>11098.53</td>\n",
       "      <td>стоимость за 12 (двенадцать) капитальных строе...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19846</th>\n",
       "      <td>60655494-комплекс</td>\n",
       "      <td>134204.001</td>\n",
       "      <td>273.8</td>\n",
       "      <td>38320.01</td>\n",
       "      <td>стоимость за 12 (двенадцать) капитальных строе...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19847</th>\n",
       "      <td>60655494-комплекс</td>\n",
       "      <td>134204.001</td>\n",
       "      <td>155.1</td>\n",
       "      <td>21707.21</td>\n",
       "      <td>(стоимость за 12 (двенадцать) капитальных стро...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19848</th>\n",
       "      <td>60655494-комплекс</td>\n",
       "      <td>134204.001</td>\n",
       "      <td>297.4</td>\n",
       "      <td>41622.97</td>\n",
       "      <td>стоимость за 12 (двенадцать) капитальных строе...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Идентификатор сделки  Цена в бел. руб.  Общая площадь, кв.м  \\\n",
       "19843    60655494-комплекс        134204.001                 76.2   \n",
       "19844    60655494-комплекс        134204.001                 77.1   \n",
       "19845    60655494-комплекс        134204.001                 79.3   \n",
       "19846    60655494-комплекс        134204.001                273.8   \n",
       "19847    60655494-комплекс        134204.001                155.1   \n",
       "19848    60655494-комплекс        134204.001                297.4   \n",
       "\n",
       "      Цена в бел. руб._new                                      Описание цены  \n",
       "19843             10664.66  (стоимость за 12 (двенадцать) капитальных стро...  \n",
       "19844             10790.62  стоимость за 12 (двенадцать) капитальных строе...  \n",
       "19845             11098.53  стоимость за 12 (двенадцать) капитальных строе...  \n",
       "19846             38320.01  стоимость за 12 (двенадцать) капитальных строе...  \n",
       "19847             21707.21  (стоимость за 12 (двенадцать) капитальных стро...  \n",
       "19848             41622.97  стоимость за 12 (двенадцать) капитальных строе...  "
      ]
     },
     "execution_count": 153,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[total_df[COL_ID] == \"60655494-комплекс\"][\n",
    "    [COL_ID, COL_BYN, COL_AREA, new_col, COL_DESC]\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "28bdd656",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "9897f096",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df.drop(\n",
    "    columns=[new_col, \"Форма_USD\", \"Форма_EUR\", \"Форма_BYN\"]\n",
    ").to_excel(\"6.xlsx\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c5789407",
   "metadata": {},
   "source": [
    "## НДС и объединение\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "5533fb6e",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df = pd.read_excel(\"./data/total_df_with_curr.xlsx\")\n",
    "df_5 = pd.read_excel(\"./5.xlsx\", index_col=0).rename(\n",
    "    {\"RULE_ID\": \"rules_5\"}, axis=1\n",
    ")\n",
    "df_6 = pd.read_excel(\"./6.xlsx\", index_col=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "75c488f5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'rules_5'} (27, 87)\n",
      "{'rules_6'} (5347, 87)\n"
     ]
    }
   ],
   "source": [
    "print(set(df_5) - set(total_df.columns), df_5.shape)\n",
    "print(set(df_6) - set(total_df.columns), df_6.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "d5737e51",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df[\"rules_5\"] = \"-\"\n",
    "total_df[\"rules_6\"] = \"-\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "84d92a43",
   "metadata": {},
   "outputs": [],
   "source": [
    "for src, rule_col in ([df_5, \"rules_5\"], [df_6, \"rules_6\"]):\n",
    "    idx = total_df.index.intersection(src.index)\n",
    "    total_df.loc[idx, COL_BYN] = src.loc[idx, COL_BYN]\n",
    "    total_df.loc[idx, rule_col] = src.loc[idx, rule_col].fillna(0).astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "06d03ce1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "rules_6\n",
       "-    16649\n",
       "0     3046\n",
       "2     1948\n",
       "1      353\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 159,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[\"rules_6\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "id": "4c3979c1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Тип недвижимого имущества</th>\n",
       "      <th>Инвентарный номер</th>\n",
       "      <th>Адрес</th>\n",
       "      <th>Назначение</th>\n",
       "      <th>Описание назначения</th>\n",
       "      <th>Наименование</th>\n",
       "      <th>Общая площадь, кв.м</th>\n",
       "      <th>Жилая площадь, кв.м</th>\n",
       "      <th>Материал стен</th>\n",
       "      <th>Дата ввода</th>\n",
       "      <th>Дата консервации</th>\n",
       "      <th>Дата реконструкции (реставрации, капитального ремонта)</th>\n",
       "      <th>Дата сделки</th>\n",
       "      <th>Дата регистрации договора</th>\n",
       "      <th>Идентификатор сделки</th>\n",
       "      <th>Количество объектов в сделке</th>\n",
       "      <th>Цена в бел. руб.</th>\n",
       "      <th>Цена в бел. руб. за кв.м</th>\n",
       "      <th>Описание цены</th>\n",
       "      <th>Цена в долларах США</th>\n",
       "      <th>Цена в долларах США за кв.м</th>\n",
       "      <th>Цена в евро</th>\n",
       "      <th>Цена в евро за кв.м</th>\n",
       "      <th>Тип цены</th>\n",
       "      <th>Цена по договору</th>\n",
       "      <th>Валюта по договору</th>\n",
       "      <th>Переходящая доля</th>\n",
       "      <th>Количество комнат ИП</th>\n",
       "      <th>Этаж расположения ИП</th>\n",
       "      <th>Инвентарный номер КС</th>\n",
       "      <th>Общая площадь КС, кв.м</th>\n",
       "      <th>Жилая площадь КС, кв.м</th>\n",
       "      <th>Назначение КС</th>\n",
       "      <th>Описание назначения КС</th>\n",
       "      <th>Наименование КС</th>\n",
       "      <th>Процент готовности КС</th>\n",
       "      <th>Количество надземных этажей, шт.</th>\n",
       "      <th>Количество подземных этажей, шт.</th>\n",
       "      <th>Составные элементы и принадлежности</th>\n",
       "      <th>Кадастровый номер ЗУ</th>\n",
       "      <th>Назначение ЗУ</th>\n",
       "      <th>Описание назначения ЗУ</th>\n",
       "      <th>Площадь ЗУ, кв.м</th>\n",
       "      <th>Уникальный номер АТЕ</th>\n",
       "      <th>Маркеры</th>\n",
       "      <th>Дата проведения обследования КС / РХ</th>\n",
       "      <th>Объем КС, куб.м / РХ</th>\n",
       "      <th>Общая площадь жилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Общая площадь нежилых помещений КС, кв.м / РХ</th>\n",
       "      <th>Количество изолированных помещений (квартир) КС / РХ</th>\n",
       "      <th>Физический износ на дату обследования КС, % / РХ</th>\n",
       "      <th>Наличие холодного водоснабжения КС / РХ</th>\n",
       "      <th>Наличие горячего водоснабжения КС / РХ</th>\n",
       "      <th>Наличие канализации КС / РХ</th>\n",
       "      <th>Наличие отопления КС / РХ</th>\n",
       "      <th>Наличие газоснабжения КС / РХ</th>\n",
       "      <th>Наличие электроснабжения КС / РХ</th>\n",
       "      <th>Наличие ванн (душей) КС / РХ</th>\n",
       "      <th>Наличие напольных электроплит КС / РХ</th>\n",
       "      <th>Материал  крыши (кровли) КС / РХ</th>\n",
       "      <th>Материал фундамента КС / РХ</th>\n",
       "      <th>Материал перекрытий КС / РХ</th>\n",
       "      <th>Стоимости КС / РХ</th>\n",
       "      <th>sheet_source</th>\n",
       "      <th>search_param</th>\n",
       "      <th>Распределение долей до сделки</th>\n",
       "      <th>Распределение долей после сделки</th>\n",
       "      <th>Исходная цена</th>\n",
       "      <th>Исходная валюта</th>\n",
       "      <th>п/п</th>\n",
       "      <th>floor</th>\n",
       "      <th>category</th>\n",
       "      <th>for_clusters_gr</th>\n",
       "      <th>Name NP</th>\n",
       "      <th>Name region</th>\n",
       "      <th>Name oblast</th>\n",
       "      <th>cluster_score</th>\n",
       "      <th>cluster</th>\n",
       "      <th>Дата</th>\n",
       "      <th>1 Евро (EUR)</th>\n",
       "      <th>1 Российский рубль (RUB)</th>\n",
       "      <th>1 Доллар США (USD)</th>\n",
       "      <th>USD</th>\n",
       "      <th>EUR</th>\n",
       "      <th>BYN</th>\n",
       "      <th>Логика извлечения</th>\n",
       "      <th>Форма_USD</th>\n",
       "      <th>Форма_EUR</th>\n",
       "      <th>Форма_BYN</th>\n",
       "      <th>rules_5</th>\n",
       "      <th>rules_6</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>133/D-3962</td>\n",
       "      <td>Брестская обл., Лунинецкий р-н, г. Лунинец, ул...</td>\n",
       "      <td>Административно-торговое помещение</td>\n",
       "      <td>Помещение неустановленного назначения</td>\n",
       "      <td>Административно- торговое помещение</td>\n",
       "      <td>63.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1981-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>16.02.2022</td>\n",
       "      <td>2022-05-10</td>\n",
       "      <td>10.05.2022</td>\n",
       "      <td>57856671</td>\n",
       "      <td>1</td>\n",
       "      <td>119817.100000</td>\n",
       "      <td>1895.840000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>47000.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>44681.197792</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>119817.10</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>133/C-130</td>\n",
       "      <td>2763.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>многоквартирный жилой дом</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>124750100001000547</td>\n",
       "      <td>Земельный участок для размещения объектов мног...</td>\n",
       "      <td>Земельный участок для строительства и обслужив...</td>\n",
       "      <td>1447.0</td>\n",
       "      <td>1547.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>лунинец</td>\n",
       "      <td>лунинецкий</td>\n",
       "      <td>брестская</td>\n",
       "      <td>198.0</td>\n",
       "      <td>D</td>\n",
       "      <td>2022-05-10</td>\n",
       "      <td>2.6816</td>\n",
       "      <td>0.038389</td>\n",
       "      <td>2.5493</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>исходное значение: не строка</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>400/D-188539</td>\n",
       "      <td>Гродненская обл., г. Гродно, ул. Свердлова, 12-36</td>\n",
       "      <td>Административно-торговое помещение</td>\n",
       "      <td>Административно-торговое помещение</td>\n",
       "      <td>административно-торговое помещение</td>\n",
       "      <td>324.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Блоки стеновые</td>\n",
       "      <td>2018-02-28 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-05-10</td>\n",
       "      <td>10.05.2022</td>\n",
       "      <td>57854188</td>\n",
       "      <td>1</td>\n",
       "      <td>280000.000000</td>\n",
       "      <td>862.870000</td>\n",
       "      <td>цена указана согласно п. 2.1 договора купли-пр...</td>\n",
       "      <td>109834.072098</td>\n",
       "      <td>NaN</td>\n",
       "      <td>104415.274463</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>280000.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>400/C-120217</td>\n",
       "      <td>2529.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>жилой дом с торгово-административными помещениями</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>подвал (А5/бл)</td>\n",
       "      <td>440100000002000645</td>\n",
       "      <td>Земельный участок для размещения объектов мног...</td>\n",
       "      <td>для строительства и обслуживания многоквартирн...</td>\n",
       "      <td>2345.0</td>\n",
       "      <td>17025.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>гродно</td>\n",
       "      <td>-1</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>511.0</td>\n",
       "      <td>B</td>\n",
       "      <td>2022-05-10</td>\n",
       "      <td>2.6816</td>\n",
       "      <td>0.038389</td>\n",
       "      <td>2.5493</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>USD: не найдено | EUR: не найдено | BYN: не на...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-708127336</td>\n",
       "      <td>г. Минск, ул. Сурганова,  43-36</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>31.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Блоки стеновые</td>\n",
       "      <td>2013-06-28 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-05-05</td>\n",
       "      <td>05.05.2022</td>\n",
       "      <td>57796061</td>\n",
       "      <td>1</td>\n",
       "      <td>80000.000000</td>\n",
       "      <td>2515.720000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>30692.499520</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29157.706746</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>80000.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8-й</td>\n",
       "      <td>500/C-56989</td>\n",
       "      <td>12756.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание многофункциональное</td>\n",
       "      <td>Здание многофункциональное</td>\n",
       "      <td>Административное здание с помещением многофунк...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000008004338</td>\n",
       "      <td>Земельный участок для размещения объектов иног...</td>\n",
       "      <td>Земельный участок для эксплуатации и обслужива...</td>\n",
       "      <td>3418.0</td>\n",
       "      <td>17030.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8.0</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>1027.0</td>\n",
       "      <td>A</td>\n",
       "      <td>2022-05-05</td>\n",
       "      <td>2.7437</td>\n",
       "      <td>0.037306</td>\n",
       "      <td>2.6065</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>исходное значение: не строка</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>400/D-155832</td>\n",
       "      <td>Гродненская обл., г. Гродно, ул. Свердлова, 16-34</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>офисное помещение</td>\n",
       "      <td>36.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1958-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-05-05</td>\n",
       "      <td>05.05.2022</td>\n",
       "      <td>57810498</td>\n",
       "      <td>1</td>\n",
       "      <td>67000.000000</td>\n",
       "      <td>1830.600000</td>\n",
       "      <td>согласно договора купли-продажи</td>\n",
       "      <td>25704.968348</td>\n",
       "      <td>NaN</td>\n",
       "      <td>24419.579400</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>67000.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Подвальный</td>\n",
       "      <td>400/C-2176</td>\n",
       "      <td>3296.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>жилой дом</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>подвал</td>\n",
       "      <td>440100000002008590</td>\n",
       "      <td>Земельный участок для размещения объектов мног...</td>\n",
       "      <td>Земельный участок для обслуживания многокварти...</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>17025.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>гродно</td>\n",
       "      <td>-1</td>\n",
       "      <td>гродненская</td>\n",
       "      <td>511.0</td>\n",
       "      <td>B</td>\n",
       "      <td>2022-05-05</td>\n",
       "      <td>2.7437</td>\n",
       "      <td>0.037306</td>\n",
       "      <td>2.6065</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>USD: не найдено | EUR: не найдено | BYN: не на...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-798198694</td>\n",
       "      <td>г. Минск, ул. Панфилова,  2-50г</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>23.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Блоки стеновые</td>\n",
       "      <td>2016-12-29 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-05-04</td>\n",
       "      <td>04.05.2022</td>\n",
       "      <td>57775937</td>\n",
       "      <td>1</td>\n",
       "      <td>86849.400000</td>\n",
       "      <td>3680.060000</td>\n",
       "      <td>расчет в белорусских рублях по курсу НБРБ</td>\n",
       "      <td>33000.000000</td>\n",
       "      <td>1398.310000</td>\n",
       "      <td>31220.576605</td>\n",
       "      <td>1322.910000</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>33000.00</td>\n",
       "      <td>USD</td>\n",
       "      <td>1/1, 1/1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Цокольный</td>\n",
       "      <td>500/C-63996</td>\n",
       "      <td>4659.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000007006836</td>\n",
       "      <td>Земельный участок для размещения объектов мног...</td>\n",
       "      <td>для строительства и обслуживания жилого дома №...</td>\n",
       "      <td>1567.0</td>\n",
       "      <td>17030.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>Здание административно-хозяйственное; \\nАдмини...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-0.5</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>1027.0</td>\n",
       "      <td>A</td>\n",
       "      <td>2022-05-04</td>\n",
       "      <td>2.7818</td>\n",
       "      <td>0.036903</td>\n",
       "      <td>2.6318</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>USD: не найдено | EUR: не найдено | BYN: не на...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21991</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-7110374</td>\n",
       "      <td>г. Минск, ул. Павла Шпилевского, 57-11н</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение 11Н</td>\n",
       "      <td>56.9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2007-12-29 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-10-11</td>\n",
       "      <td>11.10.2022</td>\n",
       "      <td>60265428</td>\n",
       "      <td>1</td>\n",
       "      <td>228185.526030</td>\n",
       "      <td>3898.945518</td>\n",
       "      <td>NaN</td>\n",
       "      <td>89484.520012</td>\n",
       "      <td>1572.662918</td>\n",
       "      <td>92039.983071</td>\n",
       "      <td>1528.998243</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>166387.50</td>\n",
       "      <td>BYN</td>\n",
       "      <td>1/4, 3/4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>500/C-47629</td>\n",
       "      <td>12914.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Жилой дом</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000003003392</td>\n",
       "      <td>Земельный участок для размещения объектов мног...</td>\n",
       "      <td>Земельный участок для эксплуатации и обслужива...</td>\n",
       "      <td>6094.0</td>\n",
       "      <td>17030.0</td>\n",
       "      <td>Доля</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>171.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>1027.0</td>\n",
       "      <td>A</td>\n",
       "      <td>2022-10-11</td>\n",
       "      <td>2.4792</td>\n",
       "      <td>0.041009</td>\n",
       "      <td>2.5500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>исходное значение: не строка</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21992</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>710/D-2031</td>\n",
       "      <td>Могилевская обл., г. Бобруйск, ул. Дзержинског...</td>\n",
       "      <td>Торговое помещение</td>\n",
       "      <td>Торговое помещение</td>\n",
       "      <td>Торговый объект</td>\n",
       "      <td>61.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1930-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-10-05</td>\n",
       "      <td>05.10.2022</td>\n",
       "      <td>60189468</td>\n",
       "      <td>1</td>\n",
       "      <td>21864.981397</td>\n",
       "      <td>338.133657</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8795.245936</td>\n",
       "      <td>142.317895</td>\n",
       "      <td>9202.820572</td>\n",
       "      <td>136.015202</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>16753.32</td>\n",
       "      <td>BYN</td>\n",
       "      <td>4/6, 1/6, 1/6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>710/C-2163</td>\n",
       "      <td>251.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание блокированного жилого дома</td>\n",
       "      <td>Здание блокированного жилого дома</td>\n",
       "      <td>Блокированный жилой дом</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>пристройка, веранда, сарай</td>\n",
       "      <td>741000000006000640</td>\n",
       "      <td>Земельный участок для размещения объектов усад...</td>\n",
       "      <td>Земельный участок для размещения объектов усад...</td>\n",
       "      <td>742.0</td>\n",
       "      <td>26103.0</td>\n",
       "      <td>Доля</td>\n",
       "      <td>13.11.2017</td>\n",
       "      <td>934.0</td>\n",
       "      <td>46.8</td>\n",
       "      <td>201.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Автономная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Центральное</td>\n",
       "      <td>Автономная система</td>\n",
       "      <td>Централизованная система</td>\n",
       "      <td>Ванна</td>\n",
       "      <td>Нет</td>\n",
       "      <td>Асбестоцементный волнистый лист</td>\n",
       "      <td>Кирпичи</td>\n",
       "      <td>Дерево</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ торговое NEW</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>258.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>бобруйск</td>\n",
       "      <td>-1</td>\n",
       "      <td>могилевская</td>\n",
       "      <td>362.0</td>\n",
       "      <td>C</td>\n",
       "      <td>2022-10-05</td>\n",
       "      <td>2.3759</td>\n",
       "      <td>0.042415</td>\n",
       "      <td>2.4860</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>исходное значение: не строка</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21993</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>350/D-297592</td>\n",
       "      <td>Гомельская обл., г. Гомель, ул. Крестьянская, ...</td>\n",
       "      <td>Торговое помещение</td>\n",
       "      <td>Торговое помещение</td>\n",
       "      <td>Торговое помещение</td>\n",
       "      <td>41.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Блоки стеновые</td>\n",
       "      <td>2014-06-16 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-09-07</td>\n",
       "      <td>07.09.2022</td>\n",
       "      <td>59760055</td>\n",
       "      <td>1</td>\n",
       "      <td>14661.521148</td>\n",
       "      <td>360.576923</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5698.220423</td>\n",
       "      <td>136.976452</td>\n",
       "      <td>5721.792518</td>\n",
       "      <td>140.138582</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>5000.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>7/10, 3/10, 7/10, 3/10</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1-й</td>\n",
       "      <td>350/C-166112</td>\n",
       "      <td>241.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное розничной торговли</td>\n",
       "      <td>Здание специализированное розничной торговли</td>\n",
       "      <td>Здание специализированное розничной торговли</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>340100000001005376</td>\n",
       "      <td>Земельный участок для размещения объектов розн...</td>\n",
       "      <td>Земельный учаток для эксплуатации и обслуживан...</td>\n",
       "      <td>376.0</td>\n",
       "      <td>12370.0</td>\n",
       "      <td>Доля</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ торговое NEW</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>105.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>торговля</td>\n",
       "      <td>1</td>\n",
       "      <td>гомель</td>\n",
       "      <td>-1</td>\n",
       "      <td>гомельская</td>\n",
       "      <td>558.0</td>\n",
       "      <td>B</td>\n",
       "      <td>2022-09-07</td>\n",
       "      <td>2.5624</td>\n",
       "      <td>0.042284</td>\n",
       "      <td>2.5730</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>исходное значение: не строка</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21994</th>\n",
       "      <td>Капитальное строение</td>\n",
       "      <td>200/C-63838</td>\n",
       "      <td>Витебская обл., г. Витебск, ул. Академика Павл...</td>\n",
       "      <td>Здание специализированное складов, торговых ба...</td>\n",
       "      <td>Здание специализированное складов, торговых ба...</td>\n",
       "      <td>производственное здание \"Склад готовой продукц...</td>\n",
       "      <td>2437.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>1950-01-01 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-06-15</td>\n",
       "      <td>21.06.2022</td>\n",
       "      <td>58531164</td>\n",
       "      <td>1</td>\n",
       "      <td>38701.448211</td>\n",
       "      <td>143.301350</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15125.434092</td>\n",
       "      <td>64.500785</td>\n",
       "      <td>14521.574504</td>\n",
       "      <td>56.074346</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>40325.00</td>\n",
       "      <td>BYN</td>\n",
       "      <td>527/1250, 723/1250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>200/C-63838</td>\n",
       "      <td>2437.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание специализированное складов, торговых ба...</td>\n",
       "      <td>Здание специализированное складов, торговых ба...</td>\n",
       "      <td>производственное здание \"Склад готовой продукц...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>подвал, четыре пристройки, четыре рампы, проез...</td>\n",
       "      <td>240100000003004192</td>\n",
       "      <td>Земельный участок для размещения объектов неус...</td>\n",
       "      <td>Земельный участок для содержания и обслуживани...</td>\n",
       "      <td>3835.0</td>\n",
       "      <td>9387.0</td>\n",
       "      <td>Доля</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ Склад NEW</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>склад</td>\n",
       "      <td>0</td>\n",
       "      <td>витебск</td>\n",
       "      <td>г. витебск</td>\n",
       "      <td>витебская</td>\n",
       "      <td>96.0</td>\n",
       "      <td>B</td>\n",
       "      <td>2022-06-15</td>\n",
       "      <td>2.6651</td>\n",
       "      <td>0.044334</td>\n",
       "      <td>2.5587</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>исходное значение: не строка</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21995</th>\n",
       "      <td>Изолированное помещение</td>\n",
       "      <td>500/D-7022734</td>\n",
       "      <td>г. Минск, ул. Стариновская, 7-2н</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>Административное помещение</td>\n",
       "      <td>46.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2002-08-09 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2022-04-07</td>\n",
       "      <td>07.04.2022</td>\n",
       "      <td>57414021</td>\n",
       "      <td>1</td>\n",
       "      <td>104604.335500</td>\n",
       "      <td>2239.920771</td>\n",
       "      <td>2.55556</td>\n",
       "      <td>35500.012048</td>\n",
       "      <td>760.171564</td>\n",
       "      <td>32500.958676</td>\n",
       "      <td>695.953932</td>\n",
       "      <td>Цена объекта</td>\n",
       "      <td>13075.54</td>\n",
       "      <td>BYN</td>\n",
       "      <td>7/8, 1/8, 7/8, 1/8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Подвальный</td>\n",
       "      <td>500/C-34270</td>\n",
       "      <td>4687.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>Здание многоквартирного жилого дома</td>\n",
       "      <td>А 5/К Здание многоквартирного жилого дома</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>500000000009004672</td>\n",
       "      <td>Земельный участок для размещения объектов мног...</td>\n",
       "      <td>Для эксплуатации и обслуживания зданий многокв...</td>\n",
       "      <td>1497.0</td>\n",
       "      <td>17030.0</td>\n",
       "      <td>Доля</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>РБ админ NEW</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>104.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>офис</td>\n",
       "      <td>1</td>\n",
       "      <td>минск</td>\n",
       "      <td>-1</td>\n",
       "      <td>-1</td>\n",
       "      <td>1027.0</td>\n",
       "      <td>A</td>\n",
       "      <td>2022-04-07</td>\n",
       "      <td>3.2185</td>\n",
       "      <td>0.035404</td>\n",
       "      <td>2.9466</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>исходное значение: не строка</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>21969 rows × 91 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Тип недвижимого имущества Инвентарный номер  \\\n",
       "0       Изолированное помещение        133/D-3962   \n",
       "1       Изолированное помещение      400/D-188539   \n",
       "2       Изолированное помещение   500/D-708127336   \n",
       "3       Изолированное помещение      400/D-155832   \n",
       "4       Изолированное помещение   500/D-798198694   \n",
       "...                         ...               ...   \n",
       "21991   Изолированное помещение     500/D-7110374   \n",
       "21992   Изолированное помещение        710/D-2031   \n",
       "21993   Изолированное помещение      350/D-297592   \n",
       "21994      Капитальное строение       200/C-63838   \n",
       "21995   Изолированное помещение     500/D-7022734   \n",
       "\n",
       "                                                   Адрес  \\\n",
       "0      Брестская обл., Лунинецкий р-н, г. Лунинец, ул...   \n",
       "1      Гродненская обл., г. Гродно, ул. Свердлова, 12-36   \n",
       "2                        г. Минск, ул. Сурганова,  43-36   \n",
       "3      Гродненская обл., г. Гродно, ул. Свердлова, 16-34   \n",
       "4                        г. Минск, ул. Панфилова,  2-50г   \n",
       "...                                                  ...   \n",
       "21991            г. Минск, ул. Павла Шпилевского, 57-11н   \n",
       "21992  Могилевская обл., г. Бобруйск, ул. Дзержинског...   \n",
       "21993  Гомельская обл., г. Гомель, ул. Крестьянская, ...   \n",
       "21994  Витебская обл., г. Витебск, ул. Академика Павл...   \n",
       "21995                   г. Минск, ул. Стариновская, 7-2н   \n",
       "\n",
       "                                              Назначение  \\\n",
       "0                     Административно-торговое помещение   \n",
       "1                     Административно-торговое помещение   \n",
       "2                             Административное помещение   \n",
       "3                             Административное помещение   \n",
       "4                             Административное помещение   \n",
       "...                                                  ...   \n",
       "21991                         Административное помещение   \n",
       "21992                                 Торговое помещение   \n",
       "21993                                 Торговое помещение   \n",
       "21994  Здание специализированное складов, торговых ба...   \n",
       "21995                         Административное помещение   \n",
       "\n",
       "                                     Описание назначения  \\\n",
       "0                  Помещение неустановленного назначения   \n",
       "1                     Административно-торговое помещение   \n",
       "2                             Административное помещение   \n",
       "3                             Административное помещение   \n",
       "4                             Административное помещение   \n",
       "...                                                  ...   \n",
       "21991                         Административное помещение   \n",
       "21992                                 Торговое помещение   \n",
       "21993                                 Торговое помещение   \n",
       "21994  Здание специализированное складов, торговых ба...   \n",
       "21995                         Административное помещение   \n",
       "\n",
       "                                            Наименование  Общая площадь, кв.м  \\\n",
       "0                    Административно- торговое помещение                 63.2   \n",
       "1                     административно-торговое помещение                324.5   \n",
       "2                             Административное помещение                 31.8   \n",
       "3                                      офисное помещение                 36.6   \n",
       "4                             Административное помещение                 23.6   \n",
       "...                                                  ...                  ...   \n",
       "21991                     Административное помещение 11Н                 56.9   \n",
       "21992                                    Торговый объект                 61.8   \n",
       "21993                                 Торговое помещение                 41.6   \n",
       "21994  производственное здание \"Склад готовой продукц...               2437.2   \n",
       "21995                         Административное помещение                 46.7   \n",
       "\n",
       "       Жилая площадь, кв.м   Материал стен           Дата ввода  \\\n",
       "0                      NaN          Кирпич  1981-01-01 00:00:00   \n",
       "1                      NaN  Блоки стеновые  2018-02-28 00:00:00   \n",
       "2                      NaN  Блоки стеновые  2013-06-28 00:00:00   \n",
       "3                      NaN          Кирпич  1958-01-01 00:00:00   \n",
       "4                      NaN  Блоки стеновые  2016-12-29 00:00:00   \n",
       "...                    ...             ...                  ...   \n",
       "21991                  NaN          Кирпич  2007-12-29 00:00:00   \n",
       "21992                  NaN          Кирпич  1930-01-01 00:00:00   \n",
       "21993                  NaN  Блоки стеновые  2014-06-16 00:00:00   \n",
       "21994                  NaN          Кирпич  1950-01-01 00:00:00   \n",
       "21995                  NaN          Кирпич  2002-08-09 00:00:00   \n",
       "\n",
       "      Дата консервации Дата реконструкции (реставрации, капитального ремонта)  \\\n",
       "0                  NaN                                         16.02.2022       \n",
       "1                  NaN                                                NaN       \n",
       "2                  NaN                                                NaN       \n",
       "3                  NaN                                                NaN       \n",
       "4                  NaN                                                NaN       \n",
       "...                ...                                                ...       \n",
       "21991              NaN                                                NaN       \n",
       "21992              NaN                                                NaN       \n",
       "21993              NaN                                                NaN       \n",
       "21994              NaN                                                NaN       \n",
       "21995              NaN                                                NaN       \n",
       "\n",
       "      Дата сделки Дата регистрации договора Идентификатор сделки  \\\n",
       "0      2022-05-10                10.05.2022             57856671   \n",
       "1      2022-05-10                10.05.2022             57854188   \n",
       "2      2022-05-05                05.05.2022             57796061   \n",
       "3      2022-05-05                05.05.2022             57810498   \n",
       "4      2022-05-04                04.05.2022             57775937   \n",
       "...           ...                       ...                  ...   \n",
       "21991  2022-10-11                11.10.2022             60265428   \n",
       "21992  2022-10-05                05.10.2022             60189468   \n",
       "21993  2022-09-07                07.09.2022             59760055   \n",
       "21994  2022-06-15                21.06.2022             58531164   \n",
       "21995  2022-04-07                07.04.2022             57414021   \n",
       "\n",
       "       Количество объектов в сделке  Цена в бел. руб.  \\\n",
       "0                                 1     119817.100000   \n",
       "1                                 1     280000.000000   \n",
       "2                                 1      80000.000000   \n",
       "3                                 1      67000.000000   \n",
       "4                                 1      86849.400000   \n",
       "...                             ...               ...   \n",
       "21991                             1     228185.526030   \n",
       "21992                             1      21864.981397   \n",
       "21993                             1      14661.521148   \n",
       "21994                             1      38701.448211   \n",
       "21995                             1     104604.335500   \n",
       "\n",
       "       Цена в бел. руб. за кв.м  \\\n",
       "0                   1895.840000   \n",
       "1                    862.870000   \n",
       "2                   2515.720000   \n",
       "3                   1830.600000   \n",
       "4                   3680.060000   \n",
       "...                         ...   \n",
       "21991               3898.945518   \n",
       "21992                338.133657   \n",
       "21993                360.576923   \n",
       "21994                143.301350   \n",
       "21995               2239.920771   \n",
       "\n",
       "                                           Описание цены  Цена в долларах США  \\\n",
       "0                                                    NaN         47000.000000   \n",
       "1      цена указана согласно п. 2.1 договора купли-пр...        109834.072098   \n",
       "2                                                    NaN         30692.499520   \n",
       "3                        согласно договора купли-продажи         25704.968348   \n",
       "4              расчет в белорусских рублях по курсу НБРБ         33000.000000   \n",
       "...                                                  ...                  ...   \n",
       "21991                                                NaN         89484.520012   \n",
       "21992                                                NaN          8795.245936   \n",
       "21993                                                NaN          5698.220423   \n",
       "21994                                                NaN         15125.434092   \n",
       "21995                                            2.55556         35500.012048   \n",
       "\n",
       "       Цена в долларах США за кв.м    Цена в евро  Цена в евро за кв.м  \\\n",
       "0                              NaN   44681.197792                  NaN   \n",
       "1                              NaN  104415.274463                  NaN   \n",
       "2                              NaN   29157.706746                  NaN   \n",
       "3                              NaN   24419.579400                  NaN   \n",
       "4                      1398.310000   31220.576605          1322.910000   \n",
       "...                            ...            ...                  ...   \n",
       "21991                  1572.662918   92039.983071          1528.998243   \n",
       "21992                   142.317895    9202.820572           136.015202   \n",
       "21993                   136.976452    5721.792518           140.138582   \n",
       "21994                    64.500785   14521.574504            56.074346   \n",
       "21995                   760.171564   32500.958676           695.953932   \n",
       "\n",
       "           Тип цены  Цена по договору Валюта по договору  \\\n",
       "0      Цена объекта         119817.10                BYN   \n",
       "1      Цена объекта         280000.00                BYN   \n",
       "2      Цена объекта          80000.00                BYN   \n",
       "3      Цена объекта          67000.00                BYN   \n",
       "4      Цена объекта          33000.00                USD   \n",
       "...             ...               ...                ...   \n",
       "21991  Цена объекта         166387.50                BYN   \n",
       "21992  Цена объекта          16753.32                BYN   \n",
       "21993  Цена объекта           5000.00                BYN   \n",
       "21994  Цена объекта          40325.00                BYN   \n",
       "21995  Цена объекта          13075.54                BYN   \n",
       "\n",
       "             Переходящая доля  Количество комнат ИП Этаж расположения ИП  \\\n",
       "0                    1/1, 1/1                   NaN                  1-й   \n",
       "1                    1/1, 1/1                   NaN                  1-й   \n",
       "2                    1/1, 1/1                   NaN                  8-й   \n",
       "3                    1/1, 1/1                   NaN           Подвальный   \n",
       "4                    1/1, 1/1                   NaN            Цокольный   \n",
       "...                       ...                   ...                  ...   \n",
       "21991                1/4, 3/4                   NaN                  1-й   \n",
       "21992           4/6, 1/6, 1/6                   NaN                  1-й   \n",
       "21993  7/10, 3/10, 7/10, 3/10                   NaN                  1-й   \n",
       "21994      527/1250, 723/1250                   NaN                  NaN   \n",
       "21995      7/8, 1/8, 7/8, 1/8                   NaN           Подвальный   \n",
       "\n",
       "      Инвентарный номер КС  Общая площадь КС, кв.м  Жилая площадь КС, кв.м  \\\n",
       "0                133/C-130                  2763.3                     NaN   \n",
       "1             400/C-120217                  2529.0                     NaN   \n",
       "2              500/C-56989                 12756.1                     NaN   \n",
       "3               400/C-2176                  3296.6                     NaN   \n",
       "4              500/C-63996                  4659.6                     NaN   \n",
       "...                    ...                     ...                     ...   \n",
       "21991          500/C-47629                 12914.3                     NaN   \n",
       "21992           710/C-2163                   251.0                     NaN   \n",
       "21993         350/C-166112                   241.4                     NaN   \n",
       "21994          200/C-63838                  2437.2                     NaN   \n",
       "21995          500/C-34270                  4687.0                     NaN   \n",
       "\n",
       "                                           Назначение КС  \\\n",
       "0                    Здание многоквартирного жилого дома   \n",
       "1                    Здание многоквартирного жилого дома   \n",
       "2                             Здание многофункциональное   \n",
       "3                    Здание многоквартирного жилого дома   \n",
       "4                    Здание многоквартирного жилого дома   \n",
       "...                                                  ...   \n",
       "21991                Здание многоквартирного жилого дома   \n",
       "21992                  Здание блокированного жилого дома   \n",
       "21993       Здание специализированное розничной торговли   \n",
       "21994  Здание специализированное складов, торговых ба...   \n",
       "21995                Здание многоквартирного жилого дома   \n",
       "\n",
       "                                  Описание назначения КС  \\\n",
       "0                    Здание многоквартирного жилого дома   \n",
       "1                    Здание многоквартирного жилого дома   \n",
       "2                             Здание многофункциональное   \n",
       "3                    Здание многоквартирного жилого дома   \n",
       "4                    Здание многоквартирного жилого дома   \n",
       "...                                                  ...   \n",
       "21991                Здание многоквартирного жилого дома   \n",
       "21992                  Здание блокированного жилого дома   \n",
       "21993       Здание специализированное розничной торговли   \n",
       "21994  Здание специализированное складов, торговых ба...   \n",
       "21995                Здание многоквартирного жилого дома   \n",
       "\n",
       "                                         Наименование КС  \\\n",
       "0                              многоквартирный жилой дом   \n",
       "1      жилой дом с торгово-административными помещениями   \n",
       "2      Административное здание с помещением многофунк...   \n",
       "3                                              жилой дом   \n",
       "4                    Здание многоквартирного жилого дома   \n",
       "...                                                  ...   \n",
       "21991                                          Жилой дом   \n",
       "21992                            Блокированный жилой дом   \n",
       "21993       Здание специализированное розничной торговли   \n",
       "21994  производственное здание \"Склад готовой продукц...   \n",
       "21995          А 5/К Здание многоквартирного жилого дома   \n",
       "\n",
       "       Процент готовности КС  Количество надземных этажей, шт.  \\\n",
       "0                        NaN                               5.0   \n",
       "1                        NaN                               5.0   \n",
       "2                        NaN                               9.0   \n",
       "3                        NaN                               4.0   \n",
       "4                        NaN                               6.0   \n",
       "...                      ...                               ...   \n",
       "21991                    NaN                              17.0   \n",
       "21992                    NaN                               1.0   \n",
       "21993                    NaN                               1.0   \n",
       "21994                    NaN                               1.0   \n",
       "21995                    NaN                               5.0   \n",
       "\n",
       "       Количество подземных этажей, шт.  \\\n",
       "0                                   1.0   \n",
       "1                                   1.0   \n",
       "2                                   1.0   \n",
       "3                                   1.0   \n",
       "4                                   1.0   \n",
       "...                                 ...   \n",
       "21991                               1.0   \n",
       "21992                               NaN   \n",
       "21993                               NaN   \n",
       "21994                               NaN   \n",
       "21995                               1.0   \n",
       "\n",
       "                     Составные элементы и принадлежности Кадастровый номер ЗУ  \\\n",
       "0                                                    NaN  124750100001000547    \n",
       "1                                         подвал (А5/бл)  440100000002000645    \n",
       "2                                                    NaN  500000000008004338    \n",
       "3                                                 подвал  440100000002008590    \n",
       "4                                                    NaN  500000000007006836    \n",
       "...                                                  ...                  ...   \n",
       "21991                                                NaN   500000000003003392   \n",
       "21992                         пристройка, веранда, сарай   741000000006000640   \n",
       "21993                                                NaN   340100000001005376   \n",
       "21994  подвал, четыре пристройки, четыре рампы, проез...   240100000003004192   \n",
       "21995                                                NaN   500000000009004672   \n",
       "\n",
       "                                           Назначение ЗУ  \\\n",
       "0      Земельный участок для размещения объектов мног...   \n",
       "1      Земельный участок для размещения объектов мног...   \n",
       "2      Земельный участок для размещения объектов иног...   \n",
       "3      Земельный участок для размещения объектов мног...   \n",
       "4      Земельный участок для размещения объектов мног...   \n",
       "...                                                  ...   \n",
       "21991  Земельный участок для размещения объектов мног...   \n",
       "21992  Земельный участок для размещения объектов усад...   \n",
       "21993  Земельный участок для размещения объектов розн...   \n",
       "21994  Земельный участок для размещения объектов неус...   \n",
       "21995  Земельный участок для размещения объектов мног...   \n",
       "\n",
       "                                  Описание назначения ЗУ  Площадь ЗУ, кв.м  \\\n",
       "0      Земельный участок для строительства и обслужив...            1447.0   \n",
       "1      для строительства и обслуживания многоквартирн...            2345.0   \n",
       "2      Земельный участок для эксплуатации и обслужива...            3418.0   \n",
       "3      Земельный участок для обслуживания многокварти...            1991.0   \n",
       "4      для строительства и обслуживания жилого дома №...            1567.0   \n",
       "...                                                  ...               ...   \n",
       "21991  Земельный участок для эксплуатации и обслужива...            6094.0   \n",
       "21992  Земельный участок для размещения объектов усад...             742.0   \n",
       "21993  Земельный учаток для эксплуатации и обслуживан...             376.0   \n",
       "21994  Земельный участок для содержания и обслуживани...            3835.0   \n",
       "21995  Для эксплуатации и обслуживания зданий многокв...            1497.0   \n",
       "\n",
       "       Уникальный номер АТЕ Маркеры Дата проведения обследования КС / РХ  \\\n",
       "0                    1547.0     NaN                                  NaN   \n",
       "1                   17025.0     NaN                                  NaN   \n",
       "2                   17030.0     NaN                                  NaN   \n",
       "3                   17025.0     NaN                                  NaN   \n",
       "4                   17030.0     NaN                                  NaN   \n",
       "...                     ...     ...                                  ...   \n",
       "21991               17030.0    Доля                                  NaN   \n",
       "21992               26103.0    Доля                           13.11.2017   \n",
       "21993               12370.0    Доля                                  NaN   \n",
       "21994                9387.0    Доля                                  NaN   \n",
       "21995               17030.0    Доля                                  NaN   \n",
       "\n",
       "       Объем КС, куб.м / РХ  Общая площадь жилых помещений КС, кв.м / РХ  \\\n",
       "0                       NaN                                          NaN   \n",
       "1                       NaN                                          NaN   \n",
       "2                       NaN                                          NaN   \n",
       "3                       NaN                                          NaN   \n",
       "4                       NaN                                          NaN   \n",
       "...                     ...                                          ...   \n",
       "21991                   NaN                                          NaN   \n",
       "21992                 934.0                                         46.8   \n",
       "21993                   NaN                                          NaN   \n",
       "21994                   NaN                                          NaN   \n",
       "21995                   NaN                                          NaN   \n",
       "\n",
       "       Общая площадь нежилых помещений КС, кв.м / РХ  \\\n",
       "0                                                NaN   \n",
       "1                                                NaN   \n",
       "2                                                NaN   \n",
       "3                                                NaN   \n",
       "4                                                NaN   \n",
       "...                                              ...   \n",
       "21991                                            NaN   \n",
       "21992                                          201.0   \n",
       "21993                                            NaN   \n",
       "21994                                            NaN   \n",
       "21995                                            NaN   \n",
       "\n",
       "       Количество изолированных помещений (квартир) КС / РХ  \\\n",
       "0                                                    NaN      \n",
       "1                                                    NaN      \n",
       "2                                                    NaN      \n",
       "3                                                    NaN      \n",
       "4                                                    NaN      \n",
       "...                                                  ...      \n",
       "21991                                                NaN      \n",
       "21992                                                1.0      \n",
       "21993                                                NaN      \n",
       "21994                                                NaN      \n",
       "21995                                                NaN      \n",
       "\n",
       "       Физический износ на дату обследования КС, % / РХ  \\\n",
       "0                                                   NaN   \n",
       "1                                                   NaN   \n",
       "2                                                   NaN   \n",
       "3                                                   NaN   \n",
       "4                                                   NaN   \n",
       "...                                                 ...   \n",
       "21991                                               NaN   \n",
       "21992                                               NaN   \n",
       "21993                                               NaN   \n",
       "21994                                               NaN   \n",
       "21995                                               NaN   \n",
       "\n",
       "      Наличие холодного водоснабжения КС / РХ  \\\n",
       "0                                         NaN   \n",
       "1                                         NaN   \n",
       "2                                         NaN   \n",
       "3                                         NaN   \n",
       "4                                         NaN   \n",
       "...                                       ...   \n",
       "21991                                     NaN   \n",
       "21992                Централизованная система   \n",
       "21993                                     NaN   \n",
       "21994                                     NaN   \n",
       "21995                                     NaN   \n",
       "\n",
       "      Наличие горячего водоснабжения КС / РХ Наличие канализации КС / РХ  \\\n",
       "0                                        NaN                         NaN   \n",
       "1                                        NaN                         NaN   \n",
       "2                                        NaN                         NaN   \n",
       "3                                        NaN                         NaN   \n",
       "4                                        NaN                         NaN   \n",
       "...                                      ...                         ...   \n",
       "21991                                    NaN                         NaN   \n",
       "21992                     Автономная система    Централизованная система   \n",
       "21993                                    NaN                         NaN   \n",
       "21994                                    NaN                         NaN   \n",
       "21995                                    NaN                         NaN   \n",
       "\n",
       "      Наличие отопления КС / РХ Наличие газоснабжения КС / РХ  \\\n",
       "0                           NaN                           NaN   \n",
       "1                           NaN                           NaN   \n",
       "2                           NaN                           NaN   \n",
       "3                           NaN                           NaN   \n",
       "4                           NaN                           NaN   \n",
       "...                         ...                           ...   \n",
       "21991                       NaN                           NaN   \n",
       "21992               Центральное            Автономная система   \n",
       "21993                       NaN                           NaN   \n",
       "21994                       NaN                           NaN   \n",
       "21995                       NaN                           NaN   \n",
       "\n",
       "      Наличие электроснабжения КС / РХ Наличие ванн (душей) КС / РХ  \\\n",
       "0                                  NaN                          NaN   \n",
       "1                                  NaN                          NaN   \n",
       "2                                  NaN                          NaN   \n",
       "3                                  NaN                          NaN   \n",
       "4                                  NaN                          NaN   \n",
       "...                                ...                          ...   \n",
       "21991                              NaN                          NaN   \n",
       "21992         Централизованная система                        Ванна   \n",
       "21993                              NaN                          NaN   \n",
       "21994                              NaN                          NaN   \n",
       "21995                              NaN                          NaN   \n",
       "\n",
       "      Наличие напольных электроплит КС / РХ Материал  крыши (кровли) КС / РХ  \\\n",
       "0                                       NaN                              NaN   \n",
       "1                                       NaN                              NaN   \n",
       "2                                       NaN                              NaN   \n",
       "3                                       NaN                              NaN   \n",
       "4                                       NaN                              NaN   \n",
       "...                                     ...                              ...   \n",
       "21991                                   NaN                              NaN   \n",
       "21992                                   Нет  Асбестоцементный волнистый лист   \n",
       "21993                                   NaN                              NaN   \n",
       "21994                                   NaN                              NaN   \n",
       "21995                                   NaN                              NaN   \n",
       "\n",
       "      Материал фундамента КС / РХ Материал перекрытий КС / РХ  \\\n",
       "0                             NaN                         NaN   \n",
       "1                             NaN                         NaN   \n",
       "2                             NaN                         NaN   \n",
       "3                             NaN                         NaN   \n",
       "4                             NaN                         NaN   \n",
       "...                           ...                         ...   \n",
       "21991                         NaN                         NaN   \n",
       "21992                     Кирпичи                      Дерево   \n",
       "21993                         NaN                         NaN   \n",
       "21994                         NaN                         NaN   \n",
       "21995                         NaN                         NaN   \n",
       "\n",
       "      Стоимости КС / РХ     sheet_source  \\\n",
       "0                   NaN     РБ админ NEW   \n",
       "1                   NaN     РБ админ NEW   \n",
       "2                   NaN     РБ админ NEW   \n",
       "3                   NaN     РБ админ NEW   \n",
       "4                   NaN     РБ админ NEW   \n",
       "...                 ...              ...   \n",
       "21991               NaN     РБ админ NEW   \n",
       "21992               NaN  РБ торговое NEW   \n",
       "21993               NaN  РБ торговое NEW   \n",
       "21994               NaN     РБ Склад NEW   \n",
       "21995               NaN     РБ админ NEW   \n",
       "\n",
       "                                            search_param  \\\n",
       "0      Здание административно-хозяйственное; \\nАдмини...   \n",
       "1      Здание административно-хозяйственное; \\nАдмини...   \n",
       "2      Здание административно-хозяйственное; \\nАдмини...   \n",
       "3      Здание административно-хозяйственное; \\nАдмини...   \n",
       "4      Здание административно-хозяйственное; \\nАдмини...   \n",
       "...                                                  ...   \n",
       "21991                                                NaN   \n",
       "21992                                                NaN   \n",
       "21993                                                NaN   \n",
       "21994                                                NaN   \n",
       "21995                                                NaN   \n",
       "\n",
       "      Распределение долей до сделки Распределение долей после сделки  \\\n",
       "0                               NaN                              NaN   \n",
       "1                               NaN                              NaN   \n",
       "2                               NaN                              NaN   \n",
       "3                               NaN                              NaN   \n",
       "4                               NaN                              NaN   \n",
       "...                             ...                              ...   \n",
       "21991                           NaN                              NaN   \n",
       "21992                           NaN                              NaN   \n",
       "21993                           NaN                              NaN   \n",
       "21994                           NaN                              NaN   \n",
       "21995                           NaN                              NaN   \n",
       "\n",
       "       Исходная цена Исходная валюта    п/п  floor  category  for_clusters_gr  \\\n",
       "0                NaN             NaN    NaN    1.0  торговля                1   \n",
       "1                NaN             NaN    NaN    1.0  торговля                1   \n",
       "2                NaN             NaN    NaN    8.0      офис                1   \n",
       "3                NaN             NaN    NaN   -1.0      офис                1   \n",
       "4                NaN             NaN    NaN   -0.5      офис                1   \n",
       "...              ...             ...    ...    ...       ...              ...   \n",
       "21991            NaN             NaN  171.0    1.0      офис                1   \n",
       "21992            NaN             NaN  258.0    1.0  торговля                1   \n",
       "21993            NaN             NaN  105.0    1.0  торговля                1   \n",
       "21994            NaN             NaN   51.0    NaN     склад                0   \n",
       "21995            NaN             NaN  104.0   -1.0      офис                1   \n",
       "\n",
       "        Name NP Name region  Name oblast  cluster_score cluster       Дата  \\\n",
       "0       лунинец  лунинецкий    брестская          198.0       D 2022-05-10   \n",
       "1        гродно          -1  гродненская          511.0       B 2022-05-10   \n",
       "2         минск          -1           -1         1027.0       A 2022-05-05   \n",
       "3        гродно          -1  гродненская          511.0       B 2022-05-05   \n",
       "4         минск          -1           -1         1027.0       A 2022-05-04   \n",
       "...         ...         ...          ...            ...     ...        ...   \n",
       "21991     минск          -1           -1         1027.0       A 2022-10-11   \n",
       "21992  бобруйск          -1  могилевская          362.0       C 2022-10-05   \n",
       "21993    гомель          -1   гомельская          558.0       B 2022-09-07   \n",
       "21994   витебск  г. витебск    витебская           96.0       B 2022-06-15   \n",
       "21995     минск          -1           -1         1027.0       A 2022-04-07   \n",
       "\n",
       "       1 Евро (EUR)  1 Российский рубль (RUB)  1 Доллар США (USD)  USD  EUR  \\\n",
       "0            2.6816                  0.038389              2.5493  NaN  NaN   \n",
       "1            2.6816                  0.038389              2.5493  NaN  NaN   \n",
       "2            2.7437                  0.037306              2.6065  NaN  NaN   \n",
       "3            2.7437                  0.037306              2.6065  NaN  NaN   \n",
       "4            2.7818                  0.036903              2.6318  NaN  NaN   \n",
       "...             ...                       ...                 ...  ...  ...   \n",
       "21991        2.4792                  0.041009              2.5500  NaN  NaN   \n",
       "21992        2.3759                  0.042415              2.4860  NaN  NaN   \n",
       "21993        2.5624                  0.042284              2.5730  NaN  NaN   \n",
       "21994        2.6651                  0.044334              2.5587  NaN  NaN   \n",
       "21995        3.2185                  0.035404              2.9466  NaN  NaN   \n",
       "\n",
       "       BYN                                  Логика извлечения Форма_USD  \\\n",
       "0      NaN                       исходное значение: не строка       NaN   \n",
       "1      NaN  USD: не найдено | EUR: не найдено | BYN: не на...       NaN   \n",
       "2      NaN                       исходное значение: не строка       NaN   \n",
       "3      NaN  USD: не найдено | EUR: не найдено | BYN: не на...       NaN   \n",
       "4      NaN  USD: не найдено | EUR: не найдено | BYN: не на...       NaN   \n",
       "...    ...                                                ...       ...   \n",
       "21991  NaN                       исходное значение: не строка       NaN   \n",
       "21992  NaN                       исходное значение: не строка       NaN   \n",
       "21993  NaN                       исходное значение: не строка       NaN   \n",
       "21994  NaN                       исходное значение: не строка       NaN   \n",
       "21995  NaN                       исходное значение: не строка       NaN   \n",
       "\n",
       "      Форма_EUR Форма_BYN rules_5 rules_6  \n",
       "0           NaN       NaN       -       -  \n",
       "1           NaN       NaN       -       -  \n",
       "2           NaN       NaN       -       -  \n",
       "3           NaN       NaN       -       -  \n",
       "4           NaN       NaN       -       -  \n",
       "...         ...       ...     ...     ...  \n",
       "21991       NaN       NaN       -       -  \n",
       "21992       NaN       NaN       -       -  \n",
       "21993       NaN       NaN       -       -  \n",
       "21994       NaN       NaN       -       -  \n",
       "21995       NaN       NaN       -       -  \n",
       "\n",
       "[21969 rows x 91 columns]"
      ]
     },
     "execution_count": 160,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_df[total_df[\"rules_5\"] == \"-\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "id": "5eab1aa2",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df[\"Цена в долларах США\"] = (\n",
    "    total_df[\"Цена в бел. руб.\"] / total_df[\"1 Доллар США (USD)\"]\n",
    ")\n",
    "total_df[\"Цена в евро\"] = (\n",
    "    total_df[\"Цена в бел. руб.\"] / total_df[\"1 Евро (EUR)\"]\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "id": "645fd8b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "def NDS_conv(\n",
    "    df: pd.DataFrame, desc_col: str, price_cols: list[str]\n",
    ") -> pd.DataFrame:\n",
    "    # приводим описание к нижнему регистру\n",
    "    desc = df[desc_col].fillna(\"\").astype(str).str.lower()\n",
    "\n",
    "    # фразы-исключения (значит, цена уже без НДС/НДС не применяется)\n",
    "    exclude_phrases = [\n",
    "        \"без ндс\",\n",
    "        \"без учета ндс\",\n",
    "        \"без учёта ндс\",\n",
    "        \"ндс не применялся\",\n",
    "        \"ндс не применяется\",\n",
    "        \"не включает ндс\",\n",
    "    ]\n",
    "\n",
    "    # где встречается любое исключение\n",
    "    mask_excl = pd.Series(False, index=df.index)\n",
    "    for ph in exclude_phrases:\n",
    "        mask_excl |= desc.str.contains(re.escape(ph))\n",
    "\n",
    "    # где явно упоминается НДС\n",
    "    mask_nds = desc.str.contains(r\"\\bндс\\b\")\n",
    "\n",
    "    # применять конверсию только если есть НДС и нет исключений\n",
    "    mask_apply = mask_nds & ~mask_excl\n",
    "\n",
    "    # обновляем указанные ценовые столбцы\n",
    "    for col in price_cols:\n",
    "        if col not in df.columns:\n",
    "            continue\n",
    "        df[col] = pd.to_numeric(df[col], errors=\"coerce\")\n",
    "        df.loc[mask_apply & df[col].notna(), col] = (\n",
    "            df.loc[mask_apply, col] * 0.8\n",
    "        ).round(2)\n",
    "\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "id": "2ee750a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df = NDS_conv(\n",
    "    total_df,\n",
    "    \"Описание цены\",\n",
    "    [\"Цена в бел. руб.\", \"Цена в долларах США\", \"Цена в евро\"],\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "id": "82eb6cb2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Цена за площадь\n",
    "total_df[\"Цена в бел. руб. за кв.м\"] = (\n",
    "    total_df[\"Цена в бел. руб.\"] / total_df[\"Общая площадь КС, кв.м\"]\n",
    ")\n",
    "total_df[\"Цена в долларах США за кв.м\"] = (\n",
    "    total_df[\"Цена в долларах США\"] / total_df[\"Общая площадь КС, кв.м\"]\n",
    ")\n",
    "total_df[\"Цена в евро за кв.м\"] = (\n",
    "    total_df[\"Цена в евро\"] / total_df[\"Общая площадь КС, кв.м\"]\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "id": "925804b1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(21996, 91)\n",
      "(21253, 91)\n"
     ]
    }
   ],
   "source": [
    "print(total_df.shape)\n",
    "total_df = total_df[\n",
    "    (total_df[\"Переходящая доля\"].isin(not_allowed_fractions))\n",
    "    | (total_df[\"Переходящая доля\"].isna())\n",
    "]\n",
    "print(total_df.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "id": "cecff1aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df.to_excel(\"./data/clean_df.xlsx\", index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "id": "5b15db25",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_df.to_csv(\"./data/clean_full_df.csv\", index=False)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
